{"version":3,"file":"chunks/js/report_page.js","mappings":"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","sources":["webpack://SequenceServer/./public/js/circosjs.js","webpack://SequenceServer/./public/js/components/report/loading_blast.js","webpack://SequenceServer/./public/js/components/report/warning_blast.js","webpack://SequenceServer/./public/js/services/fetchResults.js","webpack://SequenceServer/./public/js/exporter.js","webpack://SequenceServer/./public/js/svgExporter.js","webpack://SequenceServer/./public/js/collapse_preferences.js","webpack://SequenceServer/./public/js/grapher.js","webpack://SequenceServer/./public/js/null_plugins/grapher/histogram.js","webpack://SequenceServer/./public/js/null_plugins/report_plugins.js","webpack://SequenceServer/./public/js/components/report/report_header.js","webpack://SequenceServer/./public/js/components/report/run_summary.js","webpack://SequenceServer/./public/js/visualisation_helpers.js","webpack://SequenceServer/./public/js/utils.js","webpack://SequenceServer/./public/js/circos.js","webpack://SequenceServer/./public/js/components/report/graphical_overview.js","webpack://SequenceServer/./public/js/hits_overview.js","webpack://SequenceServer/./public/js/length_distribution.js","webpack://SequenceServer/./public/js/query.js","webpack://SequenceServer/./public/js/kablammo.js","webpack://SequenceServer/./public/js/download_fasta.js","webpack://SequenceServer/./public/js/alignment_exporter.js","webpack://SequenceServer/./public/js/null_plugins/hit_buttons.js","webpack://SequenceServer/./public/js/hit.js","webpack://SequenceServer/./public/js/hsp.js","webpack://SequenceServer/./public/js/hits.js","webpack://SequenceServer/./public/js/components/report/alignment_results.js","webpack://SequenceServer/./public/js/mailto.js","webpack://SequenceServer/./public/js/share_url.js","webpack://SequenceServer/./public/js/cloud_share_modal.js","webpack://SequenceServer/./public/js/null_plugins/download_links.js","webpack://SequenceServer/./public/js/components/report/sidebar.js","webpack://SequenceServer/./public/js/utils/report.utils.js","webpack://SequenceServer/./public/js/components/report.js","webpack://SequenceServer/./public/js/jquery_world.js"],"sourcesContent":["const d3 = require('d3');\n\n// ribbon function from d3 version 3\nvar  = Math.PI, half =  / 2;\nfunction d3_functor(v) {\n    return typeof v === \"function\" ? v : function() {\n        return v;\n    };\n}\n\nfunction d3_source(d) {\n  return d.source;\n}\n\nfunction d3_target(d) {\n  return d.target;\n}\n\nfunction d3_svg_chordRadius(d) {\n  return d.radius;\n}\n\nfunction d3_svg_arcStartAngle(d) {\n  return d.startAngle;\n}\n\nfunction d3_svg_arcEndAngle(d) {\n  return d.endAngle;\n}\n\nvar ribbonV3 = function() {\n    var source = d3_source, target = d3_target, radius = d3_svg_chordRadius, startAngle = d3_svg_arcStartAngle, endAngle = d3_svg_arcEndAngle;\n    function chord(d, i) {\n        var s = subgroup(this, source, d, i), t = subgroup(this, target, d, i);\n        result = \"M\" + s.p0 + arc(s.r, s.p1, s.a1 - s.a0) + (equals(s, t) ? curve(s.p0) : curve(t.p0) + arc(t.r, t.p1, t.a1 - t.a0) + curve(s.p0)) + \"Z\";\n        return result;\n    }\n    function subgroup(self, f, d, i) {\n        var subgroup = f.call(self, d, i), r = radius.call(self, subgroup, i), a0 = startAngle.call(self, subgroup, i) - half, a1 = endAngle.call(self, subgroup, i) - half;\n        return {\n            r: r,\n            a0: a0,\n            a1: a1,\n            p0: [ r * Math.cos(a0), r * Math.sin(a0) ],\n            p1: [ r * Math.cos(a1), r * Math.sin(a1) ]\n        };\n    }\n    function equals(a, b) {\n        return a.a0 == b.a0 && a.a1 == b.a1;\n    }\n    function arc(r, p, a) {\n        return \"A\" + r + \",\" + r + \" 0 \" + +(a > ) + \",1 \" + p;\n    }\n    function curve(p1) {\n        return \"Q 0,0 \" + p1;\n    }\n    chord.radius = function(v) {\n        if (!arguments.length) return radius;\n        radius = d3_functor(v);\n        return chord;\n    };\n    chord.source = function(v) {\n        if (!arguments.length) return source;\n        source = d3_functor(v);\n        return chord;\n    };\n    chord.target = function(v) {\n        if (!arguments.length) return target;\n        target = d3_functor(v);\n        return chord;\n    };\n    chord.startAngle = function(v) {\n        if (!arguments.length) return startAngle;\n        startAngle = d3_functor(v);\n        return chord;\n    };\n    chord.endAngle = function(v) {\n        if (!arguments.length) return endAngle;\n        endAngle = d3_functor(v);\n        return chord;\n    };\n    return chord;\n};\n// end of ribbon function from d3 version 3\n\n\n// Bellow code extracted from circosjs https://github.com/nicgirault/circosJS and d3 version upgraded to use version 7.9\n\nvar circosJS,\n    indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nif (typeof Object.assign !== 'function') {\n    Object.assign = function(target) {\n        'use strict';\n        var index, key, source;\n        if (target === null) {\n            throw new TypeError('Cannot convert undefined or null to object');\n        }\n        target = Object(target);\n        index = 1;\n        while (index < arguments.length) {\n            source = arguments[index];\n            if (source !== null) {\n                for (key in source) {\n                    if (Object.prototype.hasOwnProperty.call(source, key)) {\n                        target[key] = source[key];\n                    }\n                }\n            }\n            index++;\n        }\n        return target;\n    };\n}\n\ncircosJS = function(conf) {\n    var instance;\n    instance = new circosJS.Core(conf);\n    return instance;\n};\n\ncircosJS.Core = function(conf) {\n    this.tracks = {\n        heatmaps: {},\n        histograms: {},\n        chords: {},\n        scatters: {},\n        lines: {},\n        stacks: {},\n        highlights: {},\n        texts: {}\n    };\n    this.conf = circosJS.mixConf(conf, this.defaultConf);\n    return this;\n};\n\ncircosJS.Core.prototype.removeTracks = function(trackIds) {\n    var id, l, len, ref, store, svg, trackId, type;\n    svg = d3.select(this.conf.container);\n    ref = this.tracks;\n    for (type in ref) {\n        store = ref[type];\n        if (typeof trackIds === 'object') {\n            for (l = 0, len = trackIds.length; l < len; l++) {\n                id = trackIds[l];\n                if (id in store) {\n                    svg.select('.' + id).remove();\n                    delete store[id];\n                }\n            }\n        } else if (typeof trackIds === 'string') {\n            if (trackIds in store) {\n                svg.select('.' + trackIds).remove();\n                delete store[trackIds];\n            }\n        } else if (typeof trackIds === 'undefined') {\n            for (trackId in store) {\n                svg.select('.' + trackId).remove();\n                delete store[trackId];\n            }\n        }\n    }\n    return this;\n};\n\ncircosJS.Core.prototype.layout = function(conf, data) {\n    this._layout = new circosJS.Layout(conf, data);\n    return this;\n};\n\ncircosJS.log = function(level, code, message, data) {\n    var levels;\n    levels = ['Permanent log', 'Error', 'Warning', 'Info'];\n    console.log('CircosJS: ', levels[level] + ' [' + code + '] ', message, data);\n};\n\ncircosJS.mixConf = function(conf, defaultConf) {\n    var key, newConf, value;\n    newConf = {};\n    for (key in defaultConf) {\n        value = defaultConf[key];\n        if (key in conf) {\n            if (Object.prototype.toString.call(value) === '[object Array]') {\n                newConf[key] = conf[key];\n            } else if (typeof value === 'object' && (value != null)) {\n                if ((value != null) && Object.keys(value).length === 0) {\n                    newConf[key] = conf[key];\n                } else {\n                    newConf[key] = circosJS.mixConf(conf[key], value);\n                }\n            } else {\n                newConf[key] = conf[key];\n            }\n        } else {\n            newConf[key] = value;\n        }\n    }\n    return newConf;\n};\n\ncircosJS.Core.prototype.smartBorders = function() {\n    var border, borders, currentBorder, l, layout, len, ref, store, track, trackId, trackType, width;\n    width = this.conf.defaultTrackWidth;\n    layout = {\n        'in': this._layout.conf.innerRadius,\n        out: this._layout.conf.outerRadius\n    };\n    borders = [];\n    ref = this.tracks;\n    for (trackType in ref) {\n        store = ref[trackType];\n        for (trackId in store) {\n            track = store[trackId];\n            if (track.conf.innerRadius) {\n                borders.push({\n                    'in': track.conf.innerRadius,\n                    out: track.conf.outerRadius\n                });\n            }\n        }\n    }\n    borders = borders.sort(function(a, b) {\n        if (a.out > b.out) {\n            1;\n        }\n        if (a.out < b.out) {\n            -1;\n        }\n        return 0;\n    });\n    currentBorder = layout;\n    for (l = 0, len = borders.length; l < len; l++) {\n        border = borders[l];\n        if (border.out < currentBorder['in'] - width) {\n            return {\n                'in': currentBorder['in'] - width,\n                out: currentBorder['in']\n            };\n        }\n        currentBorder = border;\n    }\n    if (currentBorder['in'] > width) {\n        return {\n            'in': currentBorder['in'] - width,\n            out: currentBorder['in']\n        };\n    } else {\n        return {\n            'in': borders[0].out,\n            out: borders[0].out + width\n        };\n    }\n};\n\nif (typeof module !== 'undefined' && module !== null) {\n    module.exports = circosJS;\n}\n\ncircosJS.checkParent = function(key, index, layoutSummary, header) {\n    if (!(key in layoutSummary)) {\n        circosJS.log(1, 'datum', 'unknown parent id', {\n            line: index + 1,\n            value: key,\n            header: header,\n            layoutSummary: layoutSummary\n        });\n        return false;\n    }\n    return true;\n};\n\ncircosJS.checkNumber = function(keys, index) {\n    var header, value;\n    for (header in keys) {\n        value = keys[header];\n        if (isNaN(value)) {\n            circosJS.log(1, 'datum', 'not a number', {\n                line: index + 1,\n                value: value,\n                header: header\n            });\n            return false;\n        }\n    }\n    return true;\n};\n\ncircosJS.parseChordData = function(data, layoutSummary) {\n    var sample;\n    sample = data[0];\n    if ('source_id' in sample && 'source_start' in sample && 'source_end' && 'target_id' in sample && 'target_start' in sample && 'target_end' in sample) {\n        data = data.map(function(datum) {\n            var elts;\n            elts = [datum.source_id, datum.source_start, datum.source_end, datum.target_id, datum.target_start, datum.target_end];\n            if (datum.value != null) {\n                elts.push(datum.value);\n            }\n            return elts;\n        });\n    }\n    data = data.filter(function(datum, index) {\n        return circosJS.checkParent(datum[0], index, layoutSummary, 'source_id');\n    }).filter(function(datum, index) {\n        return circosJS.checkParent(datum[3], index, layoutSummary, 'target_id');\n    }).filter(function(datum, index) {\n        return circosJS.checkNumber({\n            source_start: datum[1],\n            source_end: datum[2],\n            target_start: datum[4],\n            target_end: datum[5],\n            value: datum[6] || 1\n        }, index);\n    }).map(function(datum) {\n        return {\n            source: {\n                id: datum[0],\n                start: Math.max(0, parseFloat(datum[1])),\n                end: Math.min(layoutSummary[datum[0]], parseFloat(datum[2]))\n            },\n            target: {\n                id: datum[3],\n                start: Math.max(0, parseFloat(datum[4])),\n                end: Math.min(layoutSummary[datum[3]], parseFloat(datum[5]))\n            },\n            value: parseFloat(datum[6]),\n            hsp: datum[7]\n        };\n    });\n    return {\n        data: data,\n        meta: {\n            min: d3.min(data, function(d) {\n                return d.value;\n            }),\n            max: d3.max(data, function(d) {\n                return d.value;\n            })\n        }\n    };\n};\n\ncircosJS.Layout = function(conf, data) {\n    var block_nb, gap, k, offset, ref, ref1, size, v;\n    if (data == null) {\n        circosJS.log(2, 'no layout data', '');\n    }\n    this.conf = circosJS.mixConf(conf, JSON.parse(JSON.stringify(this.defaultConf)));\n    this.data = data;\n    this.blocks = {};\n    this.size = 0;\n    offset = 0;\n    ref = this.data;\n    for (k in ref) {\n        v = ref[k];\n        this.blocks[v.id] = {\n            label: v.label,\n            len: v.len,\n            color: v.color,\n            offset: offset\n        };\n        v.offset = offset;\n        offset += v.len;\n    }\n    this.size = offset;\n    gap = this.conf.gap;\n    size = this.size;\n    block_nb = this.data.length;\n    ref1 = this.data;\n    for (k in ref1) {\n        v = ref1[k];\n        this.blocks[v.id].start = v.offset / size * (2 * Math.PI - block_nb * gap) + k * gap;\n        this.blocks[v.id].end = (v.offset + v.len) / size * (2 * Math.PI - block_nb * gap) + k * gap;\n        v.start = v.offset / size * (2 * Math.PI - block_nb * gap) + k * gap;\n        v.end = (v.offset + v.len) / size * (2 * Math.PI - block_nb * gap) + k * gap;\n    }\n    this.getAngle = function(blockId, unit) {\n        var block;\n        block = this.blocks[blockId].start / this._size;\n        if (unit === 'deg') {\n            return block * 360;\n        } else if (unit === 'rad') {\n            return block * 2 * Math.PI;\n        } else {\n            return null;\n        }\n    };\n    this.summary = function() {\n        var d, l, layoutSummary, len, ref2;\n        layoutSummary = {};\n        ref2 = this._data;\n        for (l = 0, len = ref2.length; l < len; l++) {\n            d = ref2[l];\n            layoutSummary[d.id] = d.len;\n        }\n        return layoutSummary;\n    };\n    return this;\n};\n\ncircosJS.Core.prototype.chord = function(id, conf, data) {\n    var track;\n    track = new circosJS.Chord();\n    track.build(this, conf, data);\n    this.tracks.chords[id] = track;\n    return this;\n};\n\ncircosJS.Chord = function() {\n    circosJS.Track.call(this);\n    this.parseData = circosJS.parseChordData;\n    this.applyRules = function(rules, data) {\n        var datum, l, len, results, rule;\n        rules = rules || [];\n        results = [];\n        for (l = 0, len = data.length; l < len; l++) {\n            datum = data[l];\n            results.push((function() {\n                var len1, m, results1;\n                results1 = [];\n                for (m = 0, len1 = rules.length; m < len1; m++) {\n                    rule = rules[m];\n                    if (rule.condition(datum)) {\n                        results1.push(datum[rule.parameter] = rule.value);\n                    } else {\n                        results1.push(void 0);\n                    }\n                }\n                return results1;\n            })());\n        }\n        return results;\n    };\n    this.getSource = (function(_this) {\n        return function(d, layout) {\n            var block, endAngle, result, startAngle;\n            d = d.source;\n            block = layout.blocks[d.id];\n            startAngle = block.start + d.start / block.len * (block.end - block.start);\n            endAngle = block.start + d.end / block.len * (block.end - block.start);\n            result = {\n                radius: layout.conf.innerRadius,\n                startAngle: startAngle,\n                endAngle: endAngle\n            };\n            return result;\n        };\n    })(this);\n    this.getTarget = (function(_this) {\n        return function(d, layout) {\n            var block, endAngle, result, startAngle;\n            d = d.target;\n            block = layout.blocks[d.id];\n            startAngle = block.start + d.start / block.len * (block.end - block.start);\n            endAngle = block.start + d.end / block.len * (block.end - block.start);\n            result = {\n                radius: layout.conf.innerRadius,\n                startAngle: startAngle,\n                endAngle: endAngle\n            };\n            return result;\n        };\n    })(this);\n    this.dimChords = function (parentElement, d, conf, index) {\n        parentElement.selectAll('path').style('opacity', function (p, i) {\n            if (d === p) {\n                return 1;\n            }\n            return 0;\n        });\n    };\n    this.resetChords = function (parentElement,conf) {\n        parentElement.selectAll('path').style('opacity',conf.opacity);\n    };\n    this.renderChords = function(parentElement, name, conf, data, layout, ratio, getSource, getTarget) {\n        var link, track;\n        track = parentElement.append('g').attr('class', conf.colorPalette);\n        link = track\n            .selectAll('.chord')\n            .data(data)\n            .enter()\n            .append('path')\n            .attr('class', 'chord')\n            .attr('d', ribbonV3()\n                .source(function(d) {\n                    return getSource(d, layout);\n                })\n                .target(function(d) {\n                    return getTarget(d, layout);\n                })\n            )\n            .attr('opacity', function(_d) {\n                return conf.opacity;\n            })\n            .attr('id', function(d) {\n                return d.source.id + '_' + d.target.id;\n            })\n            .on('mouseover', (function(_this) {\n                return function(event, d) {\n                    _this.dimChords(track, d, conf);\n                    return _this.dispatch.call('mouseover', event, d);\n                };\n            })(this))\n            .on('mouseout', (function(_this) {\n                return function(event, d) {\n                    _this.resetChords(track, conf);\n                    return _this.dispatch.call('mouseout', event, d);\n                };\n            })(this));\n\n        if (conf.usePalette) {\n            link.attr('class', function(d) {\n                return 'q' + ratio(d.value, conf.cmin, conf.cmax, conf.colorPaletteSize, conf.colorPaletteReverse, conf.logScale) + '-' + conf.colorPaletteSize;\n            });\n        } else {\n            link.attr('fill', function(d) {\n                return d.color || conf.color;\n            });\n        }\n        return link;\n    };\n    this.render = (function(_this) {\n        return function(instance, parentElement, name) {\n            var selection, track;\n            parentElement.select('.' + name).remove();\n            track = parentElement.append('g').attr('class', name).attr('z-index', _this.conf.zIndex);\n            selection = _this.renderChords(track, name, _this.conf, _this.data, instance._layout, _this.ratio, _this.getSource, _this.getTarget);\n            if (_this.conf.tooltipContent != null) {\n                return circosJS.registerTooltip(instance, _this, selection, _this.conf);\n            }\n        };\n    })(this);\n    return this;\n};\n\ncircosJS.Track = function() {\n    this.build = function(instance, conf, data) {\n        this.dispatch = d3.dispatch('mouseover', 'mouseout');\n        this.loadData(data, instance);\n        this.conf = this.processConf(conf, this.defaultConf, this.meta, instance, this);\n        return this.applyRules(conf.rules, this.data);\n    };\n    this.loadData = function(data, instance) {\n        var d, l, layoutSummary, len, ref, result;\n        layoutSummary = {};\n        ref = instance._layout.data;\n        for (l = 0, len = ref.length; l < len; l++) {\n            d = ref[l];\n            layoutSummary[d.id] = d.len;\n        }\n        result = this.parseData(data, layoutSummary);\n        this.data = result.data;\n        return this.meta = result.meta;\n    };\n    this.processConf = function(conf, defaultConf, meta, instance, utils) {\n        var smartBorders;\n        conf = circosJS.mixConf(conf, Object.assign({}, defaultConf));\n        conf = utils.computeMinMax(conf, meta);\n        if (conf.innerRadius === 0 && conf.outerRadius === 0) {\n            smartBorders = instance.smartBorders();\n            conf.innerRadius = smartBorders['in'];\n            conf.outerRadius = smartBorders.out;\n        }\n        return conf;\n    };\n    this.applyRules = function(rules, data) {\n        var datum, i, k, results, rule, v;\n        rules = rules || [];\n        results = [];\n        for (k in data) {\n            v = data[k];\n            results.push((function() {\n                var ref, results1;\n                ref = v.values;\n                results1 = [];\n                for (i in ref) {\n                    datum = ref[i];\n                    results1.push((function() {\n                        var l, len, results2;\n                        results2 = [];\n                        for (l = 0, len = rules.length; l < len; l++) {\n                            rule = rules[l];\n                            if (rule.condition(v.key, datum, i)) {\n                                results2.push(datum[rule.parameter] = rule.value);\n                            } else {\n                                results2.push(void 0);\n                            }\n                        }\n                        return results2;\n                    })());\n                }\n                return results1;\n            })());\n        }\n        return results;\n    };\n    this.computeMinMax = function(conf, meta) {\n        conf.cmin = conf.min === 'smart' ? meta.min : conf.min;\n        conf.cmax = conf.max === 'smart' ? meta.max : conf.max;\n        return conf;\n    };\n    this.ratio = function(value, min, max, scope, reverse, logScale) {\n        var fraction, scaleLogBase, x;\n        scaleLogBase = logScale ? 2.3 : 1;\n        if (min === max || (value === min && !reverse) || (value === max && reverse)) {\n            return 0;\n        }\n        if (value === max || (value === min && reverse)) {\n            return scope - 1;\n        }\n        fraction = (value - min) / (max - min);\n        x = Math.exp(1 / scaleLogBase * Math.log(fraction));\n        if (reverse) {\n            x = 1 - x;\n        }\n        return Math.floor(scope * x);\n    };\n    this.render = (function(_this) {\n        return function(instance, parentElement, name) {\n            var datumContainer, ref, selection, track;\n            parentElement.select('.' + name).remove();\n            track = parentElement.append('g').attr('class', name).attr('z-index', _this.conf.zIndex);\n            datumContainer = _this.renderDatumContainer(instance, track, name, _this.data, _this.conf);\n            if ((ref = _this.conf.axes) != null ? ref.display : void 0) {\n                _this.renderAxes(datumContainer, _this.conf, instance._layout, _this.data);\n            }\n            selection = _this.renderDatum(datumContainer, _this.conf, instance._layout, _this);\n            if (_this.conf.tooltipContent != null) {\n                circosJS.registerTooltip(instance, _this, selection, _this.conf);\n            }\n            selection.on('mouseover', function(d, i, j) {\n                return _this.dispatch.mouseover(d, i, j);\n            });\n            return selection.on('mouseout', function(d, i, j) {\n                return _this.dispatch.mouseout(d, i, j);\n            });\n        };\n    })(this);\n    this.renderBlock = function(parentElement, data, layout, conf) {\n        var block, scope;\n        scope = conf.outerRadius - conf.innerRadius;\n        block = parentElement.selectAll('.block').data(data).enter().append('g').attr('class', 'block').attr('transform', function(d) {\n            return 'rotate(' + layout.blocks[d.key].start * 360 / (2 * Math.PI) + ')';\n        });\n        if (conf.backgrounds) {\n            block.selectAll('.background').data(conf.backgrounds).enter().append('path').attr('class', 'background').attr('fill', function(background) {\n                return background.color;\n            }).attr('opacity', function(background) {\n                return background.opacity || 1;\n            }).attr('d', d3.arc().innerRadius(function(background) {\n                if (conf.direction === 'in') {\n                    return conf.outerRadius - scope * background.start;\n                } else {\n                    return conf.innerRadius + scope * background.start;\n                }\n            }).outerRadius(function(background) {\n                if (conf.direction === 'in') {\n                    return conf.outerRadius - scope * background.end;\n                } else {\n                    return conf.innerRadius + scope * background.end;\n                }\n            }).startAngle(function(d, i, j) {\n                return 0;\n            }).endAngle(function(d, i, j) {\n                return layout.blocks[data[j].key].end - layout.blocks[data[j].key].start;\n            }));\n        }\n        return block;\n    };\n    this.renderAxes = function(parentElement, conf, layout, data) {\n        var axes, axis, x;\n        if (conf.axes.minor.spacingType === 'pixel') {\n            axes = (function() {\n                var l, ref, ref1, ref2, results;\n                results = [];\n                for (x = l = ref = conf.innerRadius, ref1 = conf.outerRadius, ref2 = conf.axes.minor.spacing; ref2 > 0 ? l <= ref1 : l >= ref1; x = l += ref2) {\n                    results.push(x);\n                }\n                return results;\n            })();\n        }\n        axis = d3.arc().innerRadius(function(d) {\n            return d;\n        }).outerRadius(function(d) {\n            return d;\n        }).startAngle(0).endAngle(function(d, i, j) {\n            var block;\n            block = layout.blocks[data[j].key];\n            return block.end - block.start;\n        });\n        console.log('axis', axis);\n        return parentElement.selectAll('.axis').data(axes).enter().append('path').attr('opacity', conf.opacity).attr('class', 'axis').attr('d', axis).attr('stroke-width', function(d, i) {\n            if (i % conf.axes.major.spacing === 0) {\n                return conf.axes.major.thickness;\n            } else {\n                return conf.axes.minor.thickness;\n            }\n        }).attr('stroke', function(d, i) {\n            if (i % conf.axes.major.spacing === 0) {\n                return conf.axes.major.color;\n            } else {\n                return conf.axes.minor.color;\n            }\n        });\n    };\n    this.theta = function(position, block) {\n        return position / block.len * (block.end - block.start);\n    };\n    this.x = (function(_this) {\n        return function(d, layout, conf) {\n            var angle, height, r;\n            height = _this.ratio(d.value, conf.cmin, conf.cmax, conf.outerRadius - conf.innerRadius, false, conf.logscale);\n            if (conf.direction === 'in') {\n                r = conf.outerRadius - height;\n            } else {\n                r = conf.innerRadius + height;\n            }\n            angle = _this.theta(d.position, layout.blocks[d.block_id]) - Math.PI / 2;\n            return r * Math.cos(angle);\n        };\n    })(this);\n    this.y = (function(_this) {\n        return function(d, layout, conf) {\n            var angle, height, r;\n            height = _this.ratio(d.value, conf.cmin, conf.cmax, conf.outerRadius - conf.innerRadius, false, conf.logscale);\n            if (conf.direction === 'in') {\n                r = conf.outerRadius - height;\n            } else {\n                r = conf.innerRadius + height;\n            }\n            angle = _this.theta(d.position, layout.blocks[d.block_id]) - Math.PI / 2;\n            return r * Math.sin(angle);\n        };\n    })(this);\n    this.ratio = function(value, min, max, scope, reverse, logScale) {\n        var fraction, scaleLogBase, x;\n        scaleLogBase = logScale ? 2.3 : 1;\n        if (min === max || (value === min && !reverse) || (value === max && reverse)) {\n            return 0;\n        }\n        if (value === max || (value === min && reverse)) {\n            return scope - 1;\n        }\n        fraction = (value - min) / (max - min);\n        x = Math.exp(1 / scaleLogBase * Math.log(fraction));\n        if (reverse) {\n            x = 1 - x;\n        }\n        return Math.floor(scope * x);\n    };\n    return this;\n};\n\ncircosJS.renderLayout = function(d3, parentElement, instance) {\n    var block, conf, entry, layout;\n    conf = instance._layout.conf;\n    parentElement.select('.cs-layout').remove();\n    layout = parentElement.append('g').attr('class', 'cs-layout').attr('z-index', conf.zIndex).on('click', conf.onClick);\n    block = layout.selectAll('g').data(instance._layout.data).enter().append('g').attr('class', function(d) {\n        return d.id;\n    }).attr('opacity', conf.opacity);\n    entry = d3.arc().innerRadius(conf.innerRadius).outerRadius(conf.outerRadius).cornerRadius(conf.cornerRadius).startAngle(function(d) {\n        return d.start;\n    }).endAngle(function(d) {\n        return d.end;\n    });\n    block.append('path').attr('d', entry).attr('fill', function(d) {\n        return d.color;\n    }).attr('id', function(d) {\n        return d.id;\n    });\n    if (conf.labels.display) {\n        circosJS.renderLayoutLabels(conf, d3, block);\n    }\n    if (conf.ticks.display) {\n        return circosJS.renderLayoutTicks(conf, layout, d3, instance);\n    }\n};\n\ncircosJS.renderLayoutLabels = function(conf, d3, block) {\n    var label, labelArc, r;\n    r = conf.innerRadius + conf.labels.radialOffset;\n    labelArc = d3.arc().innerRadius(r).outerRadius(r).startAngle(function(d, i) {\n        return d.start;\n    }).endAngle(function(d, i) {\n        return d.end;\n    });\n    block.append('path').attr('fill', 'none').attr('stroke', 'none').attr('d', labelArc).attr('id', function(d) {\n        return 'arc-label' + d.id;\n    });\n    label = block.append('text').attr('font-size', conf.labels.size).attr('text-anchor', 'middle');\n    return label.append('textPath').attr('startOffset', '25%').attr('xlink:href', function(d) {\n        return '#arc-label' + d.id;\n    }).style('fill', conf.labels.color).text(function(d) {\n        var arc_len = d.end - d.start;\n        return d.label.slice(0, Math.floor(21 * arc_len)) + '..';\n    });\n};\n\ncircosJS.renderLayoutTicks = function(conf, layout, d3, instance) {\n    var blockTicks, displayLabel, ticks;\n    blockTicks = function(d) {\n        var k,space;\n        k = (d.end - d.start) / d.len;\n        if ((d.end - d.start) > 1.57) {\n            space = 8;\n        } else if ((d.end - d.start) > 0.785) {\n            space = 4;\n        } else if ((d.end - d.start) > 0.3925) {\n            space = 2;\n        } else if ((d.end - d.start) > 0) {\n            space = 0;\n        }\n        var arr = [];\n        var item = {angle: 0 * k + d.start, label: 0};\n        arr.push(item);\n        var temp_scale = d3.scaleLinear()\n            .domain([1, d.len])\n            .range([d.start, d.end]);\n        var len = temp_scale.ticks(space).length;\n        temp_scale.ticks(space).map(function (v,i) {\n            var init = v * k + d.start;\n            var final = d.len * k +d.start;\n            if ((final - init) > 0.5) {\n            }\n            var item = {\n                angle: v * k + d.start,\n                label: v / conf.ticks.labelDenominator + conf.ticks.labelSuffix\n            };\n            arr.push(item);\n        });\n        arr.splice(len, 1);\n        var item = {\n            angle: (d.len * k + d.start) - 0.006,\n            label: d.len / conf.ticks.labelDenominator + conf.ticks.labelSuffix\n        };\n        arr.push(item);\n        return arr;\n    };\n    displayLabel = function(v, i) {\n        if (conf.ticks.labels === false) {\n            return null;\n        } else if (conf.ticks.labelDisplay0 === false && i === 0) {\n            return null;\n        } else if (i % conf.ticks.labelSpacing) {\n            return null;\n        } else if (i === 0) {\n            return v / conf.ticks.labelDenominator; // added support for 0 without suffix.\n        }\n        else {\n            return v / conf.ticks.labelDenominator + conf.ticks.labelSuffix;\n        }\n    };\n    ticks = layout.append('g').selectAll('g').data(instance._layout.data).enter().append('g').selectAll('g').data(blockTicks).enter().append('g').attr('transform', function(d) {\n        return 'rotate(' + (d.angle * 180 / Math.PI - 90) + ')' + 'translate(' + conf.outerRadius + ',0)';\n    });\n    ticks.append('line').attr('x1', 0).attr('y1', 1).attr('x2', function(d, i) {\n        return conf.ticks.size.major;\n    }).attr('y2', 1).style('stroke', conf.ticks.color);\n    return ticks.append('text').attr('x', 8).attr('dy', '.35em').attr('transform', function(d) {\n        if (d.angle > Math.PI) {\n            return 'rotate(180)translate(-16)';\n        } else {\n            return null;\n        }\n    }).attr('text-anchor', function(d) {\n        if (d.angle > Math.PI) {\n            return 'end';\n        } else {\n            return null;\n        }\n    }).attr('font-size', conf.ticks.labelSize).style('fill', conf.ticks.labelColor).text(function(d) {\n        return d.label;\n    });\n};\n\ncircosJS.Core.prototype.render = function(ids, removeTracks) {\n    var name, ref, ref1, renderAll, svg, track, trackStore, trackType, tracks, translated;\n    if (typeof ids === 'undefined') {\n        renderAll = true;\n        ids = [];\n    }\n    if (removeTracks) {\n        ref = this.tracks;\n        for (trackType in ref) {\n            trackStore = ref[trackType];\n            for (name in trackStore) {\n                track = trackStore[name];\n                svg.select('.' + name).remove();\n            }\n        }\n    }\n    svg = d3.select(this.conf.container);\n    translated = svg.select('.all');\n    if (translated.empty()) {\n        translated = svg.append('svg')\n              .attr('width', this.conf.width)\n              .attr('height', this.conf.height)\n\n        translated = translated.append('g').attr('class', 'all').attr('transform', 'translate(' + parseInt(this.conf.width / 2) + ',' + parseInt(this.conf.height / 2) + ')');\n    }\n    ref1 = this.tracks;\n    for (trackType in ref1) {\n        trackStore = ref1[trackType];\n        for (name in trackStore) {\n            track = trackStore[name];\n            if (renderAll || indexOf.call(ids, name) >= 0) {\n                track.render(this, translated, name);\n            }\n        }\n    }\n    if (renderAll || indexOf.call(ids, 'layout') >= 0) {\n        circosJS.renderLayout(d3, translated, this);\n    }\n\n    // tracks = svg.selectAll('.all > g').nodes();\n    // svg.selectAll('.all > g').remove();\n\n    // tracks.sort(function(a, b) {\n    //     if (parseInt(a.getAttribute('z-index')) < parseInt(b.getAttribute('z-index'))) {\n    //         return -1;\n    //     } else if (parseInt(a.getAttribute('z-index')) > parseInt(b.getAttribute('z-index'))) {\n    //         return 1;\n    //     } else {\n    //         return 0;\n    //     }\n    // });\n\n    // svg.select('.all').selectAll('g').data(tracks).enter().append(function(d) {\n    //     return d;\n    // });\n    // return this;\n};\n\ncircosJS.Core.prototype.defaultConf = {\n    width: 700,\n    height: 700,\n    container: 'circos',\n    defaultTrackWidth: 10\n};\n\ncircosJS.Layout.prototype.defaultConf = {\n    innerRadius: 250,\n    outerRadius: 300,\n    cornerRadius: 5,\n    gap: 0.04,\n    opacity: 1,\n    labels: {\n        position: 'center',\n        display: true,\n        size: 14,\n        color: '#000',\n        radialOffset: 20\n    },\n    ticks: {\n        display: true,\n        color: 'grey',\n        spacing: 10000000,\n        labels: true,\n        labelSpacing: 10,\n        labelSuffix: 'Mb',\n        labelDenominator: 1000000,\n        labelDisplay0: true,\n        labelSize: 10,\n        labelColor: '#000',\n        labelFont: 'default',\n        majorSpacing: 5,\n        size: {\n            minor: 2,\n            major: 5\n        }\n    },\n    onClick: null,\n    onMouseOver: null,\n    zIndex: 100\n};\n\ncircosJS.axes = {\n    display: false,\n    minor: {\n        spacing: 5,\n        spacingType: 'pixel',\n        color: '#d3d3d3',\n        thickness: 2\n    },\n    major: {\n        spacing: 5,\n        color: '#000000',\n        thickness: 2\n    }\n};\n\ncircosJS.Chord.prototype.defaultConf = {\n    colorPaletteSize: 9,\n    colorPalette: 'PuBuGn',\n    usePalette: true,\n    colorPaletteReverse: false,\n    color: '#fd6a62',\n    opacity: 0.7,\n    min: 'smart',\n    max: 'smart',\n    logScale: false,\n    rules: [],\n    backgrounds: [],\n    zIndex: 1,\n    tooltipContent: null\n};\n\ncircosJS.registerTooltip = function(instance, track, element, trackParams) {\n    track.tip = d3.tip().direction('s').offset([20, 0]).html(trackParams.tooltipContent);\n    element.call(track.tip);\n    track.dispatch.on('mouseover', function(d, i, j) {\n        return track.tip.attr('class', 'd3-tip appear').show(d);\n    });\n    return track.dispatch.on('mouseout', function(d, i, j) {\n        track.tip.attr('class', 'd3-tip').show(d);\n        return track.tip.hide();\n    });\n};\n","import React from 'react';\n\nconst LoadingBlast = () => {\n    const isCloudEnv = process.env.targetEnv === 'cloud';\n\n    return (\n        <div className=\"grid grid-cols-6 gap-4\">\n            <div className=\"col-start-1 col-end-7 text-center pt-3\">\n                <h1 className=\"mb-8 text-4xl\">\n                    <i className=\"fa fa-cog fa-spin\"></i>&nbsp; BLAST-ing\n                </h1>\n                <div className=\"mb-5 w-full\">\n                    <p className=\"m-auto w-full md:w-6/12 text-sm\">\n                        This can take some time depending on the size of your query and database(s). The page will update automatically when BLAST is done.\n                    </p>\n                </div>\n                <p className=\"mb-9 text-sm\">\n                    You can bookmark the page and come back to it later or share the link with someone.\n                </p>\n                <p className=\"text-sm\">\n                    {isCloudEnv && (\n                        <b>\n                            If the job takes more than 10 minutes to complete, we will send you an email upon completion.\n                        </b>\n                    )}\n                </p>\n            </div>\n        </div>\n    );\n};\n\nexport default LoadingBlast;\n","import React from 'react';\n\nconst WarningBlast = ({ downloadLinks = [] }) => {\n    return (\n        <div className=\"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8\">\n            <div className=\"grid grid-cols-6 gap-4\">\n                <div className=\"col-start-1 col-end-7 text-center\">\n                    <h1 className=\"mb-4 text-4xl\">\n                        <i className=\"fa fa-exclamation-triangle\"></i>&nbsp; Warning\n                    </h1>\n                    <p className=\"mb-2\">\n                        The BLAST result might be too large to load in the browser. If you have a powerful machine you can try loading the results anyway. Otherwise, you can download the results and view them locally.\n                    </p>\n                    <p className=\"mb-2 space-x-2\">\n                        {downloadLinks.map((link, index) => (\n                            <a\n                                href={link.url}\n                                className=\"btn btn-secondary\"\n                                key={`download_link_${index}`}\n                            >\n                                {link.name}\n                            </a>\n                        ))}\n                    </p>\n                    <p>\n                        <a\n                            href={location.pathname + '?bypass_file_size_warning=true'}\n                            className=\"py-2 px-3 border border-transparent rounded-md shadow-sm text-white bg-seqblue hover:bg-seqorange focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-seqorange\"\n                        >\n                            View results in browser anyway\n                        </a>\n                    </p>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default WarningBlast;\n","const fetchResults = (callback, errCallback) => {\n    const path = location.pathname + '.json' + location.search;\n    pollPeriodically(path, callback, errCallback);\n};\n\nconst pollPeriodically = (path, callback, errCallback) => {\n    var intervals = [200, 400, 800, 1200, 2000, 3000, 5000];\n    function poll() {\n        fetch(path)\n            .then(response => {\n                // Handle HTTP status codes\n                if (!response.ok) throw response;\n\n                return response.text().then(data => {\n                    if (data) {\n                        data = parseJSON(data);\n                    };\n                    console.log({status: response.status, data});\n                    return { status: response.status, data }\n                });\n            })\n            .then(({ status, data }) => {\n                switch (status) {\n                    case 202:\n                        var interval;\n                        if (intervals.length === 1) {\n                            interval = intervals[0];\n                        } else {\n                            interval = intervals.shift();\n                        }\n                        setTimeout(poll, interval);\n                        break;\n                    case 200:\n                        console.log('.then2', data);\n                        callback(data);\n                        break;\n                }\n            })\n            .catch(error => {\n                if (error.text) {\n                    error.text().then(errData => {\n                        errData = parseJSON(errData);\n                        switch (error.status) {\n                            case 400:\n                            case 422:\n                            case 500:\n                                console.log('.catch', errData, errCallback);\n                                errCallback(errData);\n                                break;\n                            default:\n                                console.error(\"Unhandled error:\", error.status);\n                        }\n                    });\n                } else {\n                    console.error(\"Network error:\", error);\n                }\n            });\n    }\n\n\n    function parseJSON(str) {\n        let parsedJson = str;\n        try {\n            parsedJson = JSON.parse(str);\n        } catch (e) {\n            console.error(\"Error parsing JSON:\", e);\n        }\n\n        return parsedJson;\n    }\n    poll();\n}\n\nexport default fetchResults;\n","var d3 = require('d3');\n\nexport function download_url(url, filename) {\n    var a = d3.select('body').append('a')\n    .attr('download', filename)\n    .style('display', 'none')\n    .attr('href', url);\n\n    a.node().click();\n    setTimeout(function() {\n        a.remove();\n    }, 100);\n}\n\nexport function generate_blob_url(blob) {\n    const url = window.URL.createObjectURL(blob);\n    return url;\n}\n\nexport function download_blob(blob, filename) {\n    if (typeof window.navigator.msSaveOrOpenBlob !== 'undefined') {\n        window.navigator.msSaveOrOpenBlob(blob, filename);\n    }else{\n        download_url(generate_blob_url(blob), filename);\n    }\n}\n\nexport function sanitize_filename(str) {\n    var san = str.replace(/[^a-zA-Z0-9=_\\-]/g, '_');\n    // Replace runs of underscores with single one.\n    san = san.replace(/_{2,}/g, '_');\n    // Remove any leading or trailing underscores.\n    san = san.replace(/^_/, '').replace(/_$/, '');\n    return san;\n}\n","/**\n * svgExporter.js\n *\n * Exports <svg> as .svg or .png.\n *\n * Borrowed and modified from Kablammo which in turn is based on\n * https://github.com/NYTimes/svg-crowbar.\n *\n */\nimport * as Exporter from './exporter';\nimport * as d3 from 'd3';\n\n/**\n * Exports the given <svg> DOM node as a .svg file.\n */\nvar export_as_svg = function (svg, filename) {\n    var blob = new Blob([serialize_svg(svg)], { type: 'text/xml' });\n    filename = Exporter.sanitize_filename(filename) + '.svg';\n    Exporter.download_blob(blob, filename);\n};\n\n/**\n * Exports the given <svg> DOM node as a .png file.\n */\nvar export_as_png = function (svg, filename) {\n    if (typeof window.navigator.msSaveOrOpenBlob !== 'undefined') {\n        alert('Exporting PNG images is not supported in Internet Explorer. Please use Chrome or Firefox.');\n        return;\n    }\n\n    var raster_scale_factor = 5;\n\n    var canvas = document.getElementById('png-exporter');\n    var $svg = $(svg);\n\n    canvas.height = $svg.height() * raster_scale_factor;\n    canvas.width = $svg.width() * raster_scale_factor;\n\n    var img = new Image();\n    img.onload = function() {\n        var context = canvas.getContext('2d');\n        context.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n        filename = Exporter.sanitize_filename(filename) + '.png';\n        Exporter.download_url(canvas.toDataURL('image/png'), filename);\n    };\n\n    var svgString = serialize_svg(svg);\n    var encodedSvg = encodeURIComponent(svgString).replace(/%([0-9A-F]{2})/gi, function(match, p1) {\n        return String.fromCharCode('0x' + p1);\n    });\n    img.src = 'data:image/svg+xml;base64,' + window.btoa(encodedSvg);\n};\n\nvar serialize_svg = function(svg) {\n    // Clone svg first so that none of our changes to affect the actual SVG.\n    svg = svg.cloneNode(true);\n\n    d3.select(svg).attr('version', '1.1')\n        .insert('defs', ':first-child')\n        .append('style')\n        .attr('class', 'exported-css')\n        .attr('type', 'text/css')\n        .node()\n        .textContent = get_styles();\n\n    svg.removeAttribute('xmlns');\n    svg.removeAttribute('xlink');\n    svg.setAttributeNS(d3.namespaces.xmlns, 'xmlns', d3.namespaces.svg);\n    svg.setAttributeNS(d3.namespaces.xmlns, 'xmlns:xlink', d3.namespaces.xlink);\n\n    var source = (new XMLSerializer()).serializeToString(svg);\n    var doctype = '<?xml version=\"1.0\" standalone=\"no\"?><!DOCTYPE svg PUBLIC ' +\n        '\"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">';\n    return doctype + source;\n};\n\nvar get_styles = function () {\n    var styles = '';\n\n    for (var i = 0; i < document.styleSheets.length; i++) {\n        (function process_ss(ss) {\n            // See if we can access ss.cssRules. Note that cssRules respects\n            // same-origin policy, as per\n            // https://code.google.com/p/chromium/issues/detail?id=49001#c10.\n            try {\n                // In IE and Chrome, if stylesheet originates from a different\n                // domain, ss.cssRules simply won't exist. In Firefox, if\n                // stylesheet originates from a different domain, trying\n                // to access ss.cssRules will throw a SecurityError.\n                // Hence, we must use // try/catch to detect this\n                // condition in Firefox.\n                if (!ss.cssRules)\n                    return;\n            } catch (e) {\n                // Rethrow exception if it's not a SecurityError.\n                if (e.name !== 'SecurityError')\n                    throw e;\n                return;\n            }\n\n            // Stylesheet should be included in SVG and has accessible cssRules, so\n            // serialize rules into string.\n            for (var i = 0; i < ss.cssRules.length; i++) {\n                let rule = ss.cssRules[i];\n                if (rule.type === CSSRule.IMPORT_RULE) {\n                    process_ss(rule.styleSheet);\n                } else {\n                    // TODO: Illustrator will crash on descendant selectors. To\n                    // circumvent this, we should ignore such selectors.\n\n                    let selectorText = rule.selectorText;\n                    if (selectorText && selectorText.indexOf('svg') !== -1)\n                        styles += '\\n' + rule.cssText;\n                }\n            }\n        })(document.styleSheets[i]);\n    }\n\n    return styles;\n};\n\nvar handle_click = function (export_callback) {\n    return function () {\n        var $svg = $(this).parents('.grapher').find('svg');\n        export_callback($svg[0], $svg.attr('data-name'));\n        return false;\n    };\n};\n\nvar $body = $('body');\n$body.on('click', '.export-to-svg', handle_click(export_as_svg));\n$body.on('click', '.export-to-png', handle_click(export_as_png));\n","export default class CollapsePreferences {\n    constructor(component, defaultCollapsed = false) {\n        this.component = component;\n        this.defaultCollapsed = defaultCollapsed;\n        this.storageKey = 'sequenceServerCollapseStates';\n        this.collapseStates = JSON.parse(localStorage.getItem(this.storageKey)) || {};\n    }\n\n    toggleCollapse() {\n        let currentlyCollapsed = this.component.state.collapsed;\n        this.component.setState({ collapsed: !currentlyCollapsed });\n\n        this.collapseStates[this.component.name] = !currentlyCollapsed;\n        localStorage.setItem(this.storageKey, JSON.stringify(this.collapseStates));\n    }\n\n    preferenceStoredAsCollapsed() {\n        if (this.component.name in this.collapseStates) {\n            return this.collapseStates[this.component.name];\n        }\n        return this.defaultCollapsed;\n    }\n\n    renderCollapseIcon() {\n        return this.component.state.collapsed ? this.plusIcon() : this.minusIcon();\n    }\n\n    minusIcon() {\n        return <i className=\"print:!hidden fa-regular fa-square-minus\"></i>;\n    }\n\n    plusIcon() {\n        return <i className=\"print:!hidden fa-regular fa-square-plus\"></i>;\n    }\n}\n","import _ from 'underscore';\nimport React, { createRef, useState, useEffect, useCallback } from 'react';\n\nimport './svgExporter'; // create handlers for SVG and PNG download buttons\nimport CollapsePreferences from './collapse_preferences';\nimport useDetectPrint from \"react-detect-print\";\n\n// Grapher is a function that takes a Graph class and returns a React component.\n// This React component provides HTML boilerplate to add heading, to make the\n// graphs collapsible, to redraw graphs when window is resized, and SVG and PNG\n// export buttons and functionality.\nexport default function Grapher(Graph) {\n    return function Component(props) {\n        const alwaysShowName = Graph.alwaysShowName === undefined ? false : Graph.alwaysShowName();\n        const printing = useDetectPrint();\n        const name = Graph.name(props);\n        const [width, setWidth] = useState(window.innerWidth);\n        const [collapsed, setCollapsed] = useState(false);\n        const svgContainerRef = createRef();\n        let graph = null;\n\n        const graphId = () => Graph.graphId(props)\n\n        const graphLinksJSX = () => {\n            return (\n                <div className=\"hit-links float-right text-right text-blue-300 h-4 print:hidden\">\n                    <a href=\"#\" className=\"btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer export-to-svg\">\n                        <i className=\"fa fa-download\" /> SVG\n                    </a>\n                    <span className=\"line px-1\">|</span>\n                    <a href=\"#\" className=\"btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer export-to-png\">\n                        <i className=\"fa fa-download\" /> PNG\n                    </a>\n                </div>\n            );\n        }\n\n        const header = () => {\n            if(Graph.canCollapse()) {\n                return <div className=\"grapher-header pr-px\">\n                    <h4\n                        className=\"inline-block pl-px m-0 caption cursor-pointer text-sm\"\n                        onClick={() => collapsePreferences.toggleCollapse()}\n                    >\n                        {collapsePreferences.renderCollapseIcon()}\n                        <span className=\"print:hidden\">&nbsp;</span>{Graph.name(props)}\n                    </h4>\n                    {!collapsed && graphLinksJSX()}\n                </div>;\n            } else if (alwaysShowName) {\n                return <div className=\"grapher-histogram-header\" style={{ position: 'relative' }}>\n                    <h4 className=\"caption\">&nbsp;{Graph.name(props)}</h4>\n                    <div className=\"pull-right\" style={{ position: 'absolute', top: 0, right: 0 }}>\n                        {!collapsed && graphLinksJSX()}\n                    </div>\n                </div>;\n            } else {\n                return <div className=\"pr-px\">\n                    {!collapsed && graphLinksJSX()}\n                </div>;\n            }\n        }\n\n        const svgContainerJSX = () => {\n            var cssClasses = Graph.className() + ' svg-container hidden';\n            if (!collapsed) cssClasses += ' !block';\n            return (\n                <div\n                    ref={svgContainerRef}\n                    id={graphId()}\n                    className={cssClasses}\n                ></div>\n            );\n        }\n\n        const svgContainer = () => {\n            return $(svgContainerRef.current);\n        }\n\n        const draw = (printing = false) => {\n            let graphWidth = 'auto';\n            if (printing) graphWidth = '900';\n            // Clean slate.\n            svgContainer().empty();\n            graph = null;\n\n            // Draw if uncollapsed.\n            if (collapsed) return;\n\n            svgContainer().width(graphWidth);\n            graph = new Graph(svgContainer(), props);\n            svgContainer()\n                .find('svg')\n                .attr('data-name', Graph.dataName(props));\n        }\n\n        useEffect(() => {\n            // Attach a debounced listener to handle window resize events \n            // Updates the width state with the current window width, throttled to run at most once every 125ms\n            const handleResize = _.debounce(() => setWidth(window.innerWidth), 125);\n            window.addEventListener(\"resize\", handleResize);\n\n            const isCollapsed = collapsePreferences.preferenceStoredAsCollapsed();\n            setCollapsed(Graph.canCollapse() && (props.collapsed || isCollapsed))\n            draw();\n\n            return () => window.removeEventListener(\"resize\", handleResize)\n        }, [])\n\n        useEffect(() => {\n            draw(printing);\n        }, [printing, width])\n\n        const setState = (state) => {\n            setCollapsed(state.collapsed)\n        }\n\n        const collapsePreferences = new CollapsePreferences({name: name, state: { collapsed: collapsed }, setState: setState});\n\n        if (Graph.name(props) === null) {\n            return(null);\n        } else {\n            const printCss = collapsed ? 'print:hidden' : '';\n            const cssClasses = Graph.className() + ' grapher' + printCss;\n            return (\n                <div className={cssClasses}>\n                    {header()}\n                    {svgContainerJSX()}\n                </div>\n            )\n        }\n    }\n}\n","import Grapher from 'grapher';\n\nclass Graph {\n    static canCollapse() {\n        return false;\n    }\n\n    static name() {\n        return null;\n    }\n\n    static className() {\n        return null;\n    }\n\n    static dataName(_props) {\n        return null;\n    }\n\n    static graphId() {\n        return null;\n    }\n}\n\nexport default Grapher(Graph);\n","import Histogram from 'histogram';\nimport chroma from 'chroma-js';\n\nclass ReportPlugins {\n    constructor(parent) {\n        this.parent = parent;\n    }\n\n    init(_callback) {\n    }\n\n\n    queryResult(_query) {\n        return null;\n    }\n\n    generateStats() {\n        return (<Histogram />);\n    }\n}\n\nexport default ReportPlugins;\n","import React, { useState } from 'react';\nimport CollapsePreferences from '../../collapse_preferences';\n\nconst ReportHeader = (props) => {\n    const [state, setState] = useState({ collapsed: null });\n    const [renderable, _setRenderable] = useState(props.renderable === undefined ? true : props.renderable);\n    const collapsePreferences = new CollapsePreferences(\n        { name: props.name, state: { ...state }, setState: setState },\n        props.defaultCollapsed\n    );\n\n    if (state.collapsed === null) setState({ collapsed: collapsePreferences.preferenceStoredAsCollapsed() });\n    if (!renderable) return null;\n\n    return (\n        <div className={`${state.collapsed ? 'print:!hidden' : ''}`}>\n            <h3 className=\"caption font-bold border-b-2 border-seqorange\" onClick={() => collapsePreferences.toggleCollapse()}>\n                {collapsePreferences.renderCollapseIcon()}\n                <span> {props.name}</span>\n            </h3>\n            <div className='mx-1 print:mx-0'>\n                {!state.collapsed && props.renderContent()}\n            </div>\n        </div>\n    );\n};\n\nexport default ReportHeader;\n","import ReportHeader from './report_header';\nimport _ from 'underscore';\n\nconst RunSummary = (props) => {\n    const renderContent = () => {\n        return (\n            <div className=\"overview mr-0 mb-0\">\n                <p className=\"m-0 text-sm\">\n                    <strong>SequenceServer {props.seqserv_version}</strong> using{' '}\n                    <strong>{props.program_version}</strong>\n                    {props.submitted_at &&\n                        `, query submitted on ${props.submitted_at}`}\n                </p>\n                <p className=\"m-0 text-sm\">\n                    <strong> Databases: </strong>\n                    {props.querydb\n                        .map((db) => {\n                            return db.title;\n                        })\n                        .join(', ')}{' '}\n                    ({props.stats.nsequences} sequences,&nbsp;\n                    {props.stats.ncharacters} characters)\n                </p>\n                <p className=\"m-0 text-sm\">\n                    <strong>Parameters: </strong>{' '}\n                    {_.map(props.params, function (val, key) {\n                        return key + ' ' + val;\n                    }).join(', ')}\n                </p>\n                <p className=\"m-0 text-sm\">\n                    Please cite:{' '}\n                    <a href=\"https://doi.org/10.1093/molbev/msz185\" className=\"text-seqblue hover:text-seqorange\">\n                        https://doi.org/10.1093/molbev/msz185\n                    </a>\n                </p>\n            </div>\n        );\n    };\n\n    return <ReportHeader name=\"Run Summary\" renderContent={renderContent} />;\n};\n\nexport default RunSummary;\n","import _ from 'underscore';\nimport * as d3 from 'd3';\nexport function get_colors_for_evalue(evalue, hits) {\n    var colors = d3.scaleLog()\n        .domain([\n            d3.min([1e-5, d3.min(hits.map(function (d) {\n                if (parseFloat(d.evalue) === 0.0) return undefined;\n                return d.evalue;\n            }))]),\n            d3.max(hits.map(function (d) {\n                return d.evalue;\n            }))\n        ])\n        .range([0,0.8]);\n    var rgb = colors(evalue);\n    return d3.hsl(20, 0.82 , rgb);\n}\n\nexport function toLetters(num) {\n    var mod = num % 26,\n        pow = num / 26 | 0,\n        out = mod ? String.fromCharCode(96 + mod) : (--pow, 'z');\n    return pow ? toLetters(pow) + out : out;\n}\n\nexport function getPrefix(str) {\n    if (str.length === 0) return '';\n\n    var lastChar = str.charAt(str.length - 1);\n    return /[a-zA-Z]/.test(lastChar) ? lastChar : '';\n}\n\n/**\n* Defines how ticks will be formatted.\n *\n * Examples: 200 aa, 2.4 kbp, 7.6 Mbp.\n *\n * Borrowed from Kablammo. Modified by Priyam based on https://github.com/mbostock/d3/issues/1722.\n */\nexport function tick_formatter(scale, seq_type) {\n    const prefix = d3.format('~s')\n    const suffixes = {amino_acid: 'aa', nucleic_acid: 'bp'};\n\n    return function (d) {\n        const formatted = prefix(d);\n\n        return `${formatNumberUnits(formatted)}${suffixes[seq_type]}`;\n    };\n}\n\nexport function formatNumberUnits(number) {\n    const suffix = number.replace(/[0-9.]/g, '');\n    const numericPart = parseFloat(number).toFixed(2);\n    // Round to 1 decimal place\n    const rounded = Math.round(numericPart * 10) / 10;\n\n    return `${rounded % 1 === 0 ? rounded.toFixed(0) : rounded} ${suffix}`;\n}\n\nexport function get_seq_type(algorithm) {\n    var SEQ_TYPES = {\n        blastn: {\n            query_seq_type:   'nucleic_acid',\n            subject_seq_type: 'nucleic_acid'\n        },\n        blastp: {\n            query_seq_type:   'amino_acid',\n            subject_seq_type: 'amino_acid'\n        },\n        blastx: {\n            query_seq_type:   'nucleic_acid',\n            subject_seq_type: 'amino_acid'\n        },\n        tblastx: {\n            query_seq_type:   'nucleic_acid',\n            subject_seq_type: 'nucleic_acid'\n        },\n        tblastn: {\n            query_seq_type:   'amino_acid',\n            subject_seq_type: 'nucleic_acid'\n        }\n    };\n    return SEQ_TYPES[algorithm];\n}\n\nexport function prettify_evalue(evalue) {\n    var matches = evalue.toString().split('e');\n    var base  = matches[0];\n    var power = matches[1];\n\n    if (power)\n    {\n        var s = parseFloat(base).toFixed(2);\n        var element = '<span>'+s+' &times; 10<sup>'+power+'</sup></span>';\n        return element;\n    }\n    else {\n        if (!(base % 1==0))\n            return parseFloat(base).toFixed(2);\n        else\n            return base;\n    }\n}\n","import React from 'react';\n\nvar Utils = {\n    /***********************************\n     * Formatters for hits & hsp table *\n     ***********************************/\n\n    // Formats an array of two elements as \"first (last)\".\n    format_2_tuple: function (tuple) {\n        return (tuple[0] + ' (' + tuple[tuple.length - 1] + ')');\n    },\n\n    /**\n     * Returns fraction as percentage\n     */\n    inPercentage: function (num, den) {\n        var x = (num * 100.0 / den).toFixed(1);\n        if (x % 1 == 0) {\n            x = parseInt(x, 10);\n            return `${x}%`;\n        }\n        else {\n            return `${x}%`;\n        }\n    },\n\n    /**\n     * Returns fractional representation as String.\n     */\n    inFraction: function (num , den) {\n        return num + '/' + den;\n    },\n\n    /**\n     * Returns given Float as String formatted to two decimal places.\n     */\n    inTwoDecimal: function (num) {\n        return num.toFixed(2);\n    },\n\n    /**\n     * Returns zero if num is zero. Returns two decimal representation of num\n     * if num is between [1..10). Returns num in scientific notation otherwise.\n     */\n    inExponential: function (num) {\n        // Nothing to do if num is 0.\n        if (num === 0) {\n            return 0;\n        }\n\n        // Round to two decimal places if in the rane [1..10).\n        if (num >= 1 && num < 10)\n        {\n            return this.inTwoDecimal(num);\n        }\n\n        // Return numbers in the range [0..1) and [10..Inf] in\n        // scientific format.\n        var exp = num.toExponential(2);\n        var parts = exp.split('e');\n        var base  = parts[0];\n        var power = parts[1];\n        return <span>{base}&times;10<sup>{power}</sup></span>;\n    }\n};\n\nexport default Utils;\n","import * as d3 from 'd3';\nimport Circos from './circosjs';\nimport _ from 'underscore';\n\nimport Grapher from 'grapher';\nimport * as Helpers from './visualisation_helpers';\nimport Utils from './utils';\n\nclass Graph {\n    static canCollapse() {\n        return true;\n    }\n\n    static name() {\n        return 'Chord diagram of queries and their top hits';\n    }\n\n    static className() {\n        return 'circos';\n    }\n\n    static graphId(props) {\n        return 'circos-collapse';\n    }\n\n    static dataName(props) {\n        return 'Circos-visualisation';\n    }\n\n    constructor($svgContainer, props) {\n        this.queries = [];\n        props.queries.forEach((query) => {\n            if (query.hits.length > 0) {\n                this.queries.push(query);\n            }\n        });\n        this.svgContainer = $svgContainer;\n        this.seq_type = Helpers.get_seq_type(props.program);\n        this.algorithm = props.program;\n        // Initialize dimensions\n        this.width = this.svgContainer.width();\n        this.height = 600;\n        this.innerRadius = 200;\n        this.outerRadius = 230;\n\n        // Initialize data arrays\n        this.query_arr = [];\n        this.hit_arr = [];\n        this.layout_arr = [];\n        this.chords_arr = [];\n\n        // Initialize other properties\n        this.hsp_count = 50;\n        this.denominator = 1;\n        this.spacing = 20;\n        this.labelSpacing = 10;\n        this.initiate();\n    }\n\n    initiate() {\n        // Call initialization methods\n        this.construct_layout();\n        this.iterator_for_edits();\n\n        // Remove duplicate hits\n        this.hit_arr = _.uniq(this.hit_arr);\n\n        // Handle spacing\n        this.handle_spacing();\n\n        // Insert the circos container\n        d3.select(this.svgContainer[0])\n            .insert('div', ':first-child')\n            .attr('class', 'circosContainer');\n\n        // Create the instance\n        this.create_instance(this.svgContainer, this.width, this.height);\n\n        // Render the instance or show an error\n        if (this.chords_arr.length && this.layout_arr.length) {\n            this.instance_render();\n        } else {\n            this.render_error();\n        }\n\n        // Setup the tooltip\n        this.setupTooltip();\n        // this.drawLegend();\n    }\n\n    iterator_for_edits() {\n        this.max_length = this.calculate_max_length();\n        if (this.hit_arr.length > 10) {\n            this.complex_layout_edits();\n        }\n    }\n\n    // Generate both layout_arr and chords_arr with top hsps set by this.hsp_count\n    construct_layout() {\n        var num_karyotype = 32;\n        var num_queries = this.queries.length;\n        var x = Math.min(num_karyotype / 2, num_queries);\n        var num_hits = (num_karyotype - x) / x;\n        this.new_layout = [];\n        this.data = _.map(this.queries, _.bind(this.processQuery, this, x, num_hits));\n    }\n\n    processQuery(x, num_hits, query) {\n        if (this.query_arr.length < x) {\n            var label = query.id;\n            var len = query.length;\n            var item1 = {\n                len: len,\n                color: '#8dd3c7',\n                label: label,\n                id: 'Query_' + this.clean_id(query.id),\n                ori_id: label,\n            };\n            this.layout_arr.push(item1);\n            _.map(query.hits, _.bind(this.processHit, this, num_hits, query));\n        }\n        this.query_arr.push(query.id);\n        return query;\n    }\n\n    processHit(num_hits, query, hit) {\n        if (hit.number < num_hits) {\n            if (_.indexOf(this.hit_arr, hit.id) == -1) {\n                var label = hit.id;\n                var len = hit.length;\n                this.hit_arr.push(hit.id);\n                var item2 = {\n                    len: len,\n                    color: '#80b1d3',\n                    label: label,\n                    id: 'Hit_' + this.clean_id(hit.id),\n                    ori_id: label,\n                };\n                this.layout_arr.push(item2);\n            }\n            _.map(hit.hsps, _.bind(this.processHSP, this, query, hit));\n        }\n        return hit;\n    }\n\n    processHSP(query, hit, hsp) {\n        this.chords_arr.push([\n            'Query_' + this.clean_id(query.id),\n            hsp.qstart,\n            hsp.qend,\n            'Hit_' + this.clean_id(hit.id),\n            hsp.sstart,\n            hsp.send,\n            hit.number,\n            hsp,\n        ]);\n        return hsp;\n    }\n\n    // rearraging hit and query karyotypes to have all query in one place\n    rearrange_new_layout() {\n        _.each(\n            this.new_layout,\n            _.bind(function (obj) {\n                var id = obj.id.slice(0, 3);\n                if (id == 'Que') {\n                    this.layout_arr.push(obj);\n                }\n            }, this)\n        );\n        _.each(\n            this.new_layout,\n            _.bind(function (obj) {\n                var id = obj.id.slice(0, 3);\n                if (id == 'Hit') {\n                    this.layout_arr.push(obj);\n                }\n            }, this)\n        );\n    }\n\n    // label edits along with deleting hits which are too small to display\n    complex_layout_edits() {\n        this.delete_from_layout = [];\n        this.delete_from_chords = [];\n        _.each(\n            this.layout_arr,\n            _.bind(function (obj, index) {\n                var rel_length = (obj.len / this.max_length).toFixed(3);\n                var label = obj.label;\n                if (rel_length < 0.1 && obj.id.slice(0, 3) != 'Que') {\n                    this.delete_from_layout.push(obj);\n                    this.hit_arr.slice(_.indexOf(this.hit_arr, obj.label), 1); // corresponding delete from hit_arr\n                }\n            }, this)\n        );\n    }\n\n    // get the chords_arr index based on hit or query id\n    check_in_chords_arr(id, type, index) {\n        var count = 0;\n        _.each(\n            this.chords_arr,\n            _.bind(function (obj) {\n                if (type == 'Que') {\n                    if (obj[0] != id) {\n                        count++;\n                    }\n                }\n            }, this)\n        );\n        if (count == this.chords_arr.length) {\n            console.log('no record found ' + id);\n            this.delete_arr.push(index);\n        }\n    }\n\n    // get index of hit_arr based on id\n    find_index_of_hit(id) {\n        var found;\n        _.each(\n            this.queries,\n            _.bind(function (query) {\n                _.each(\n                    query.hits,\n                    _.bind(function (hit) {\n                        var check_id = 'Hit_' + this.clean_id(hit.id);\n                        if (id == check_id) {\n                            found = hit.id;\n                        }\n                    }, this)\n                );\n            }, this)\n        );\n        return _.indexOf(this.layout_arr, found);\n    }\n\n    edit_labels() {\n        console.log('label edits');\n        _.each(\n            this.layout_arr,\n            _.bind(function (obj) {\n                var rel_length = (obj.len / this.max_length).toFixed(3);\n                var label = obj.label;\n                if (rel_length < 0.41) {\n                    obj.label = '..';\n                } else if (label.length > 10) {\n                    obj.label = label.slice(0, 2) + '...';\n                } else {\n                    obj.label = obj.ori_id;\n                }\n            }, this)\n        );\n    }\n\n    calculate_multipliers() {\n        var sum_query_length = 0;\n        var sum_hit_length = 0;\n        _.each(\n            this.query_arr,\n            _.bind(function (id) {\n                _.each(\n                    this.data,\n                    _.bind(function (query) {\n                        if (id == query.id) {\n                            sum_query_length += query.length;\n                        }\n                    }, this)\n                );\n            }, this)\n        );\n\n        _.each(\n            this.data,\n            _.bind(function (query) {\n                _.each(\n                    query.hits,\n                    _.bind(function (hit) {\n                        var index = _.indexOf(this.hit_arr, hit.id);\n                        if (index >= 0) {\n                            sum_hit_length += hit.length;\n                        }\n                    }, this)\n                );\n            }, this)\n        );\n        var mid_sum = (sum_query_length + sum_hit_length) / 2;\n        console.log(\n            'mid sum ' +\n      mid_sum +\n      ' hit_sum ' +\n      sum_hit_length +\n      ' query_sum ' +\n      sum_query_length\n        );\n        this.query_multiplier = (mid_sum / sum_query_length).toFixed(3);\n        this.hit_multiplier = (mid_sum / sum_hit_length).toFixed(3);\n        console.log(\n            'query ' + this.query_multiplier + ' hit ' + this.hit_multiplier\n        );\n    }\n\n    handle_spacing() {\n        if (this.max_length > 16000) {\n            this.spacing = 200;\n        } else if (this.max_length > 12000) {\n            this.spacing = 150;\n        } else if (this.max_length > 8000) {\n            this.spacing = 100;\n        } else if (this.max_length > 4000) {\n            this.spacing = 75;\n        } else if (this.max_length > 1800) {\n            this.spacing = 50;\n        }\n    }\n\n    calculate_max_length() {\n        var max = 0;\n        _.each(this.layout_arr, function (obj) {\n            if (max < obj.len) {\n                max = obj.len;\n            }\n        });\n        return max;\n    }\n\n    clean_id(id) {\n        return id.replace(/[^a-zA-Z0-9]/g, '');\n    }\n\n    create_instance(container, width, height) {\n        this.instance = new Circos({\n            container: '.circosContainer',\n            width: width,\n            height: height,\n        });\n        this.chord_layout();\n        this.instance_layout();\n    }\n\n    chord_layout() {\n        if (this.chords_arr.length > 32) {\n            this.paletteSize = 32;\n        } else {\n            this.paletteSize = this.chords_arr.length;\n        }\n        return {\n            colorPaletteSize: this.paletteSize,\n            // color: 'rgb(0,0,0)',\n            colorPalette: 'RdYlBu', // colors of chords based on last value in chords\n            // tooltipContent: 'Hiten',\n            opacity: 0.85, // add opacity to ribbons\n        };\n    }\n\n    instance_layout() {\n        return {\n            innerRadius: this.innerRadius,\n            outerRadius: this.outerRadius,\n            cornerRadius: 1, // rounding at edges of karyotypes\n            labels: {\n                display: true,\n                size: '10px',\n                radialOffset: 10,\n            },\n            ticks: {\n                display: true,\n                spacing: this.spacing, // the ticks values to display\n                labelSpacing: this.labelSpacing, // ticks value apper in interval\n                labelDenominator: this.denominator, // divide the value by this value\n                labelSuffix: '',\n                labelSize: '10px',\n                majorSpacing: this.labelSpacing, // major ticks apper in interval\n                size: {\n                    minor: 0, // to remove minor ticks\n                    major: 4,\n                },\n            },\n        };\n    }\n\n    instance_render() {\n        this.instance.layout(this.instance_layout(), this.layout_arr);\n        this.instance.chord('chord1', this.chord_layout(), this.chords_arr);\n        this.instance.render();\n    }\n\n    render_error() {\n        this.svgContainer.find('svg').remove();\n        this.svg = d3\n            .select(this.svgContainer[0])\n            .insert('svg', ':first-child')\n            .attr('width', this.svgContainer.width())\n            .attr('height', this.svgContainer.height())\n            .append('g')\n            .attr('class', 'circos-error')\n            .attr(\n                'transform',\n                'translate(' +\n        this.svgContainer.width() / 2 +\n        ',' +\n        this.svgContainer.height() / 2 +\n        ')'\n            )\n            .append('text')\n            .attr('text-anchor', 'start')\n            .attr('dy', '-0.25em')\n            .attr('x', -175)\n            .style('font-size', '14px')\n            .text('Chord diagram looks great with fewer than 16 queries');\n    }\n\n    layoutReset() {\n        this.layoutHide = [];\n        _.each(this.layout_arr, function (obj) {\n            $('.' + obj.id).css('opacity', 1);\n        });\n    }\n\n    chordsReset() {\n        this.chordsHide = [];\n        _.each(this.chords_arr, function (obj) {\n            var slen = obj[1] + obj[2];\n            var tlen = obj[4] + obj[5];\n            $('#' + obj[0] + '_' + slen + '_' + obj[3] + '_' + tlen).show();\n        });\n    }\n\n    chordsCheck(id, type) {\n        _.each(\n            this.chords_arr,\n            _.bind(function (obj, index) {\n                if (type == 'Que') {\n                    if (obj[0] == id) {\n                        this.chordsHide.push(index);\n                        this.layoutHide.push(obj[3]);\n                    }\n                }\n                if (type == 'Hit') {\n                    if (obj[3] == id) {\n                        this.chordsHide.push(index);\n                        this.layoutHide.push(obj[0]);\n                    }\n                }\n            }, this)\n        );\n    }\n\n    chordsClean() {\n        _.each(\n            this.chords_arr,\n            _.bind(function (obj, index) {\n                if (_.indexOf(this.chordsHide, index) == -1) {\n                    var slen = obj[1] + obj[2];\n                    var tlen = obj[4] + obj[5];\n                    $('#' + obj[0] + '_' + slen + '_' + obj[3] + '_' + tlen).hide();\n                }\n            }, this)\n        );\n    }\n\n    layoutClean() {\n        _.each(\n            this.layout_arr,\n            _.bind(function (obj, index) {\n                if (_.indexOf(this.layoutHide, obj.id) == -1) {\n                    $('.' + obj.id).css('opacity', 0.1);\n                }\n            }, this)\n        );\n    }\n\n    setupTooltip() {\n        var selected = {};\n        $('.circos-distribution').on(\n            'click',\n            _.bind(function (event) {\n                event.stopPropagation();\n                this.layoutReset();\n                this.chordsReset();\n                selected = {};\n            }, this)\n        );\n        _.each(\n            this.query_arr,\n            _.bind(function (id, index) {\n                this.chordsHide = [];\n                this.layoutHide = [];\n                if (id) {\n                    $('.circos .Query_' + this.clean_id(id))\n                        .attr('title', id)\n                        .on(\n                            'click',\n                            _.bind(function (event) {\n                                event.stopPropagation();\n                                if (selected[index] != id) {\n                                    selected[index] = id;\n                                    var cleaned_id = 'Query_' + this.clean_id(id);\n                                    this.layoutHide.push(cleaned_id);\n                                    this.chordsCheck(cleaned_id, 'Que');\n                                    this.chordsClean();\n                                    this.layoutClean();\n                                } else {\n                                    selected[index] = 0;\n                                    this.layoutReset();\n                                    this.chordsReset();\n                                }\n                            }, this)\n                        );\n                }\n            }, this)\n        );\n        _.each(\n            this.hit_arr,\n            _.bind(function (id, index) {\n                this.chordsHide = [];\n                this.layoutHide = [];\n                if (id) {\n                    $('.circos .Hit_' + this.clean_id(id))\n                        .attr('title', id)\n                        .on(\n                            'click',\n                            _.bind(function (event) {\n                                event.stopPropagation();\n                                if (selected[index] != id) {\n                                    selected[index] = id;\n                                    var cleaned_id = 'Hit_' + this.clean_id(id);\n                                    this.layoutHide.push(cleaned_id);\n                                    this.chordsCheck(cleaned_id, 'Hit');\n                                    this.chordsClean();\n                                    this.layoutClean();\n                                } else {\n                                    selected[index] = 0;\n                                    this.layoutReset();\n                                    this.chordsReset();\n                                }\n                            }, this)\n                        );\n                }\n            }, this)\n        );\n        var algorithm = this.algorithm;\n        _.each(this.chords_arr, function (obj) {\n            $('#' + obj[0] + '_' + obj[3])\n                .attr('title', function () {\n                    // E value and identity.\n                    var alt_tooltip =\n            'E value: ' +\n            Helpers.prettify_evalue(obj[7].evalue) +\n            `, Identities: ${Utils.inPercentage(\n                obj[7].identity,\n                obj[7].length\n            )}`;\n                    // Positives (for protein alignment).\n                    if (algorithm != 'blastn') {\n                        alt_tooltip += `<br>Positives: ${Utils.inPercentage(\n                            obj[7].positives,\n                            obj[7].length\n                        )}`;\n                    }\n                    // Gaps. My understanding is that identities and gaps should add up to 100%.\n                    alt_tooltip += `, Gaps: ${Utils.inPercentage(\n                        obj[7].gaps,\n                        obj[7].length\n                    )}`;\n                    return alt_tooltip;\n                });\n        });\n        $('.circos').tooltip({\n            position: {\n                my: 'left+3 bottom-3',\n                at: 'right bottom',\n                using: function(position, feedback) {\n                  $(this).css(position);\n                  $('<div>')\n                    .addClass('arrow')\n                    .addClass(feedback.vertical)\n                    .addClass(feedback.horizontal)\n                    .appendTo(this);\n                }\n            },\n            items: '.chord1 path, .cs-layout g',\n            show: false,\n            hide: false,\n            content: function() {\n                var title = $(this).attr('title');\n                if (!title) return false;\n                var parsedHTML = $.parseHTML(title);\n                return parsedHTML;\n            }\n        });\n    }\n\n    ratioCalculate(value, min, max, scope, reverse, logScale) {\n        var fraction, scaleLogBase, x;\n        scaleLogBase = logScale ? 2.3 : 1;\n        if (\n            min === max ||\n      (value === min && !reverse) ||\n      (value === max && reverse)\n        ) {\n            return 0;\n        }\n        if (value === max || (value === min && reverse)) {\n            return scope - 1;\n        }\n        fraction = (value - min) / (max - min);\n        x = Math.exp((1 / scaleLogBase) * Math.log(fraction));\n        if (reverse) {\n            x = 1 - x;\n        }\n        return Math.floor(scope * x);\n    }\n\n    drawLegend() {\n        this.ratioHSP = [];\n        _.each(\n            this.chords_arr,\n            _.bind(function (obj) {\n                var item = { number: obj[6], evalue: obj[7].evalue };\n                this.ratioHSP.push(item);\n            }, this)\n        );\n        var min = d3.min(this.ratioHSP, function (d) {\n            return d.number;\n        });\n        var max = d3.max(this.ratioHSP, function (d) {\n            return d.number;\n        });\n        console.log('chords_arr ' + this.chords_arr.length);\n        console.log('ratioHSP test ' + this.ratioHSP.length);\n        console.log('paletteSize ' + this.paletteSize);\n        console.log('min ' + min + ' max ' + max);\n        this.legend = d3\n            .select(this.svgContainer[0])\n            .insert('svg', ':first-child')\n            .attr('height', 20)\n            .attr('width', this.ratioHSP.length * 30)\n            .attr('transform', 'translate(10, 10)')\n            .append('g')\n            .attr('class', 'RdYlBu')\n            .attr('transform', 'translate(10, 0)');\n\n        var bar = this.legend\n            .selectAll('.bar')\n            .data(this.ratioHSP)\n            .enter()\n            .append('g')\n            .attr('class', 'g')\n            .attr('transform', function (d, i) {\n                return 'translate(' + i * 30 + ',0)';\n            })\n            .append('rect')\n            .attr(\n                'class',\n                _.bind(function (d, i) {\n                    var s = this.ratioCalculate(\n                        d.number,\n                        min,\n                        max,\n                        this.paletteSize,\n                        false,\n                        false\n                    );\n                    console.log('calc ratio ' + s);\n                    return 'q' + s + '-' + this.paletteSize;\n                }, this)\n            )\n            .attr('title', function (d) {\n                return d.evalue;\n            })\n            .attr('x', 1)\n            .attr('width', 30)\n            .attr('height', 20);\n        // .attr('fill','#43ff21');\n\n        var scale = d3.scaleLinear().domain([0, 250]).range([0, 100]);\n\n        // this.legend.append('rect')\n        //     .attr('x', 7*14)\n        //     .attr('width', 2*10)\n        //     .attr('height', 10)\n        //     .attr('fill','#43ff21');\n        //\n        // this.legend.append('text')\n        //     .attr('class','text-legend')\n        //     .attr('transform','translate('+10+',0)')\n        //     .attr('x',6*14)\n        //     .text('Weaker Hits');\n        //\n        // this.legend.append('text')\n        //     .attr('class','text-legend')\n        //     .attr('transform','translate('+10+',0)')\n        //     .attr('x',9*14)\n        //     .text('Stronger Hits');\n\n        // bar.selectAll('rect')\n\n    // this.legend.append('rect')\n    //     .attr('x',1)\n    //     .attr('width', 10)\n    //     .attr('height', 10)\n    //     .attr('fill','#232323');\n    }\n}\n\nexport default Grapher(Graph);\n","import Circos from '../../circos';\nimport ReportHeader from './report_header';\n\nconst GraphicalOverview = ({queries, program, plugins}) => {\n    /**\n    * Does the report have at least two hits? This is used to determine\n    * whether Circos should be enabled or not.\n    */\n    const atLeastTwoHits = () => {\n        let hitNum = 0;\n        return queries.some((query) => {\n            hitNum += query.hits.length;\n            return hitNum > 1;\n        });\n    }\n\n    const renderContent = () => {\n        if(!atLeastTwoHits()) return null;\n\n        return (\n            <>\n                <Circos queries={queries} program={program} />\n                {plugins.generateStats(queries)}\n            </>\n        )\n    }\n\n    return (\n        <ReportHeader\n            name=\"Graphical Overview\"\n            renderContent={renderContent}\n            renderable={atLeastTwoHits()}\n            defaultCollapsed={true}\n        />\n    )\n}\n\nexport default GraphicalOverview;\n","import * as d3 from 'd3';\nimport _ from 'underscore';\nimport Grapher from 'grapher';\nimport * as Helpers from './visualisation_helpers';\nimport Utils from './utils';\n\nclass Graph {\n    static canCollapse() {\n        return true;\n    }\n\n    static name() {\n        return 'Graphical overview of aligning hit sequences to the query';\n    }\n\n    static className() {\n        return 'alignment-overview';\n    }\n\n    static graphId(props) {\n        return 'alignment_'+props.query.number;\n    }\n\n    static dataName(props) {\n        return 'Alignment-Overview-'+props.query.id;\n    }\n\n    constructor($svgContainer, props) {\n        this.svg_container = $svgContainer;\n        var $queryDiv = $svgContainer.parents('.resultn');\n        var hits = this.extractData(props.query.hits, props.query.number);\n        this.graphIt($queryDiv, $svgContainer, 0, 20, null, hits);\n    }\n\n    extractData(query_hits, number) {\n        var hits = [];\n        query_hits.map(function (hit) {\n            var _hsps = [];\n            var hsps = hit.hsps;\n            _.each(hsps, function (hsp) {\n                var _hsp = {};\n                _hsp.hspEvalue = hsp.evalue;\n                _hsp.hspStart = hsp.qstart;\n                _hsp.hspEnd = hsp.qend;\n                _hsp.hspFrame = hsp.sframe;\n                _hsp.hspId = 'Query_' + number + '_hit_' + hit.number + '_hsp_' + hsp.number;\n                _hsp.hspIdentity = hsp.identity;\n                _hsp.hspGaps = hsp.gaps;\n                _hsp.hspPositives = hsp.positives;\n                _hsp.hspLength = hsp.length;\n                _hsps.push(_hsp);\n            });\n            _hsps.hitId = hit.id;\n            _hsps.hitDef = 'Query_'+number+'_hit_'+hit.number;\n            _hsps.hitEvalue = hit.hsps[0].evalue;\n            hits.push(_hsps);\n        });\n        return hits;\n    }\n\n    setupClick($graphDiv) {\n        $('a', $graphDiv).click(function (evt) {\n            evt.preventDefault();\n            evt.stopPropagation();\n            window.location.hash = $(this).attr('href');\n        });\n    }\n\n    graphControls($queryDiv, $graphDiv, isInit, opts, hits) {\n        var MIN_HITS_TO_SHOW = 20;\n\n        var totalHits, shownHits, lessButton, moreButton;\n\n        var countHits = function () {\n            totalHits = hits.length;\n            shownHits = $queryDiv.find('.ghit > g').length;\n        };\n\n        var setupButtons = function($queryDiv, $graphDiv) {\n            $graphDiv\n                .append(\n                    $('<button/>')\n                        .addClass('btn btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer more')\n                        .attr('type', 'button')\n                        .attr('data-parent-query', $queryDiv.attr('id'))\n                        .html('View More&nbsp;')\n                        .append(\n                            $('<i/>')\n                                .html('&nbsp;&nbsp;')\n                                .addClass('fa fa-angle-double-down')\n                        ),\n                    $('<button/>')\n                        .addClass('btn btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer less')\n                        .attr('type', 'button')\n                        .attr('data-parent-query', $queryDiv.attr('id'))\n                        .html('View Less&nbsp;')\n                        .append(\n                            $('<i/>')\n                                .html('&nbsp;&nbsp;')\n                                .addClass('fa fa-angle-double-up')\n                        )\n                );\n\n            lessButton = $('.less', $graphDiv);\n            moreButton = $('.more', $graphDiv);\n        };\n\n        var initButtons = function () {\n            countHits();\n            if (totalHits === MIN_HITS_TO_SHOW ||\n            shownHits < MIN_HITS_TO_SHOW) {\n                lessButton.hide();\n                moreButton.hide();\n            }\n            else if (shownHits === totalHits) {\n                moreButton.hide();\n                lessButton.show();\n            }\n            else if (shownHits === MIN_HITS_TO_SHOW) {\n                lessButton.hide();\n                moreButton.show();\n            }\n            else {\n                lessButton.show();\n                moreButton.show();\n            }\n        };\n\n        // Setup view buttons' state properly if called for first time.\n        if (isInit === true) {\n            setupButtons($queryDiv, $graphDiv);\n            initButtons();\n        }\n\n        moreButton.on('click', _.bind(function (e) {\n            countHits();\n            this.graphIt($queryDiv, $graphDiv, shownHits, MIN_HITS_TO_SHOW, opts, hits);\n            initButtons();\n            e.stopPropagation();\n        },this));\n\n        lessButton.on('click', _.bind(function (e) {\n            countHits();\n            var diff = shownHits - MIN_HITS_TO_SHOW;\n\n            // Decrease number of shown hits by defined constant.\n            if (diff >= MIN_HITS_TO_SHOW) {\n                this.graphIt($queryDiv, $graphDiv, shownHits, -MIN_HITS_TO_SHOW, opts, hits);\n                initButtons();\n            }\n            else if (diff !== 0) {\n            // Ensure a certain number of hits always stay in graph.\n                this.graphIt($queryDiv, $graphDiv, shownHits, MIN_HITS_TO_SHOW - shownHits, opts, hits);\n                initButtons();\n            }\n            e.stopPropagation();\n        },this));\n    }\n\n    drawLegend(svg, options, width, height, hits) {\n        var svg_legend = svg.append('g')\n            .attr('transform',\n                'translate(0,' + (height - 1.75 * options.margin) + ')');\n\n        svg_legend.append('rect')\n            .attr('x', 7.5 * (width - 2 * options.margin) / 10)\n            .attr('width', 2 * (width - 4 * options.margin) / 10)\n            .attr('height', options.legend)\n            .attr('fill', 'url(#legend-grad)');\n\n        svg_legend.append('text')\n            .attr('class',' legend-text')\n            .attr('transform', 'translate(0, ' +options.legend +')')\n            .attr('x', 9.5 * (width - 2 * options.margin) / 10 + options.margin / 2)\n            .text('Weaker hits');\n        // .text(function() {\n        //   return Helpers.prettify_evalue(hits[hits.length-1].hitEvalue);\n        // })\n\n        svg_legend.append('text')\n            .attr('class',' legend-text')\n            .attr('transform', 'translate(0, ' + options.legend + ')')\n            .attr('x', 6.7 * (width - 2 * options.margin) / 10 - options.margin / 2)\n            .text('Stronger hits');\n        // .text(function () {\n        //   return Helpers.prettify_evalue(hits[0].hitEvalue);\n        // })\n\n        svg.append('linearGradient')\n            .attr('id', 'legend-grad')\n            .selectAll('stop')\n            .data([\n                {offset: '0%', color: '#000'},\n                {offset: '45%', color: '#c74f14'},\n                {offset: '100%', color: '#f6bea2'}\n            ])\n            .enter()\n            .append('stop')\n            .attr('offset', function (d) {\n                return d.offset;\n            })\n            .attr('stop-color', function (d) {\n                return d.color;\n            });\n    }\n\n    graphIt($queryDiv, $graphDiv, index, howMany, opts, inhits) {\n    /* barHeight: Height of each hit track.\n     * legend: Height reserved for the overview legend.\n     * margin: Margin around the svg element.\n     */\n        var defaults = {\n                barHeight: 4,\n                legend: inhits.length > 1 ? 3 : 0,\n                margin: 20\n            },\n            options = $.extend(defaults, opts);\n        var hits = inhits.slice(0 , index + howMany);\n\n        // Don't draw anything when no hits are obtained.\n        if (hits.length < 1) return false;\n\n        if (index !== 0) {\n        // Currently, we have no good way to extend pre-existing graph\n        // and hence, are removing the old one and redrawing.\n            $graphDiv.find('svg').remove();\n        }\n\n        var queryLen = $queryDiv.data().queryLen;\n        var q_i = $queryDiv.attr('id');\n\n        var width = $graphDiv.width();\n        var height = hits.length * (options.barHeight) +\n                     2 * options.legend + 4 * options.margin;\n\n        // var height = $graphDiv.height();\n\n        var SEQ_TYPES = {\n            blastn: 'nucleic_acid',\n            blastp: 'amino_acid',\n            blastx: 'nucleic_acid',\n            tblastx: 'nucleic_acid',\n            tblastn: 'amino_acid'\n        };\n\n        var svg = d3.select($graphDiv[0])\n            .selectAll('svg')\n            .data([hits])\n            .enter()\n            .insert('svg', ':first-child')\n            .attr('width', width)\n            .attr('height', height)\n            .append('g')\n            .attr('transform', 'translate(' + options.margin / 2 + ', ' + (1.5 * options.margin) + ')');\n\n        var x = d3.scaleLinear().range([0, width - options.margin]);\n\n        x.domain([1, queryLen]);\n\n        var algorithm = $queryDiv.data().algorithm;\n        var formatter = Helpers.tick_formatter(x, SEQ_TYPES[algorithm]);\n\n        var _tValues = x.ticks(11);\n        _tValues.pop();\n\n        var xAxis = d3.axisBottom(x)\n            .tickValues(_tValues.concat([1, queryLen]))\n            .tickFormat(formatter);\n\n        // Attach the axis to DOM (<svg> element)\n        var container = svg.append('g')\n            .attr('transform', 'translate(0, ' + options.margin + ')')\n            .append('g')\n            .attr('class', 'x axis')\n            .call(xAxis);\n\n        // Vertical alignment of ticks\n        container.selectAll('text')\n            .attr('x','25px')\n            .attr('y','2px')\n            .attr('transform','rotate(-90)');\n\n        var y = d3.scaleBand()\n            .range([0, height - 3 * options.margin - 2 * options.legend], 0.3);\n\n        y.domain(hits.map(function (d) {\n            return d.hitId;\n        }));\n\n        var gradScale = d3.scaleLog()\n            .domain([\n                d3.min([1e-5, d3.min(hits.map(function (d) {\n                    if (parseFloat(d.hitEvalue) === 0.0) return undefined;\n                    return d.hitEvalue;\n                }))\n                ]),\n                d3.max(hits.map(function (d) {\n                    return d.hitEvalue;\n                }))\n            ])\n            .range([0,0.8]);\n\n        svg.append('g')\n            .attr('class', 'ghit')\n            .attr('transform', 'translate(0, ' + 1.65 * (options.margin - options.legend) + ')')\n            .selectAll('.hits')\n            .data(hits)\n            .enter()\n            .append('g')\n            .each(function (d,i) {\n                // TODO: Avoid too many variables and improve naming.\n\n                d3.select(this)\n                    .selectAll('.hsp')\n                    .data(d).enter()\n                    .append('a')\n                    .each(function (v, j) {\n                    // Drawing the HSPs connector line using the same\n                    // color as that of the hit track (using lookahead).\n                        var yHspline = y(d.hitId) + options.barHeight / 2;\n                        var hsplineColor = d3.hsl(20, 0.82, gradScale(v.hspEvalue));\n\n                        if (j+1 < d.length) {\n                            if (d[j].hspEnd <= d[j+1].hspStart) {\n                                d3.select(this.parentNode)\n                                    .append('line')\n                                    .attr('x1', x(d[j].hspEnd))\n                                    .attr('y1', yHspline)\n                                    .attr('x2', x(d[j+1].hspStart))\n                                    .attr('y2', yHspline)\n                                    .attr('stroke', hsplineColor);\n                            }\n                            else if (d[j].hspStart > d[j+1].hspEnd) {\n                                d3.select(this.parentNode)\n                                    .append('line')\n                                    .attr('x1', x(d[j+1].hspEnd))\n                                    .attr('y1', yHspline)\n                                    .attr('x2', x(d[j].hspStart))\n                                    .attr('y2', yHspline)\n                                    .attr('stroke', hsplineColor);\n                            }\n                        }\n\n                        var alt_tooltip = d.hitId + '<br>E value: ' + Helpers.prettify_evalue(v.hspEvalue) +\n                            `<br>Identities: ${Utils.inPercentage(v.hspIdentity, v.hspLength)}`;\n                        // if chosen algorithm was blastn, the tooltip won't show the Positives% value in the tooltip\n                        if (algorithm != 'blastn'){\n                            alt_tooltip += `<br>Positives: ${Utils.inPercentage(v.hspPositives, v.hspLength)}`;\n                        }\n                        alt_tooltip += `, Gaps: ${Utils.inPercentage(v.hspGaps, v.hspLength)}`;\n\n                        // Draw the rectangular hit tracks itself.\n                        d3.select(this)\n                            .attr('xlink:href', '#' + q_i + '_hit_' + (i+1))\n                            .append('rect')\n                            .attr('title', alt_tooltip)\n                            .attr('class','bar')\n                            .attr('x', function (d) {\n                                return x(d.hspStart);\n                            })\n                            .attr('y', y(d.hitId))\n                            .attr('width', function (d) {\n                                return x(d.hspEnd - d.hspStart + 1);\n                            })\n                            .attr('height', options.barHeight)\n                            .attr('fill', d3.rgb(hsplineColor));\n                    });\n            });\n\n        // Draw legend only when more than one hit present\n        if (hits.length > 1) {\n            this.drawLegend(svg, options, width, height, inhits);\n        }\n        // Bind listener events once all the graphical elements have\n        // been drawn for first time.\n        if (index === 0) {\n            this.graphControls($queryDiv, $graphDiv, true, opts, inhits);\n        }\n        // Ensure clicking on 'rect' takes user to the relevant hit on all\n        // browsers.\n        this.setupClick($graphDiv);\n    }\n}\n\nvar HitsOverview = Grapher(Graph);\nexport default HitsOverview;\n","import * as d3 from 'd3';\nimport _ from 'underscore';\nimport Grapher from 'grapher';\nimport * as Helpers from './visualisation_helpers';\n\n/**\n * Renders Length Distribution of all hits per query\n */\n\nclass Graph {\n    static canCollapse() {\n        return true;\n    }\n\n    static name() {\n        return 'Length distribution of matching hit sequences';\n    }\n\n    static className() {\n        return 'length-distribution';\n    }\n\n    static graphId(props) {\n        return 'length_'+props.query.number;\n    }\n\n    static dataName(props) {\n        return 'length-distribution-'+props.query.id;\n    }\n\n    constructor($svg_container, props) {\n        this.query = props.query;\n        this._seq_type = Helpers.get_seq_type(props.algorithm);\n        this.svg_container = $svg_container;\n        if (props.algorithm == 'blastx') {\n            this.query_length = this.query.length / 3;\n        } else if (props.algorithm == 'tblastn') {\n            this.query_length = this.query.length * 3;\n        } else {\n            this.query_length = this.query.length;\n        }\n        this._margin = {top: 30, right: 25, bottom: 55, left: 12.5};\n        this.initiate($svg_container.width(), $svg_container.height());\n    }\n\n    initiate(width, height) {\n        this._width = width - this._margin.left - this._margin.right;\n        this._height = height - this._margin.top - this._margin.bottom;\n        this.svg = d3.select(this.svg_container[0]).insert('svg', ':first-child')\n            .attr('width', this._width + this._margin.right + this._margin.left)\n            .attr('height', this._height + this._margin.top + this._margin.bottom)\n            .append('g')\n            .attr('transform','translate('+this._margin.left+','+this._margin.top+')');\n        this.hit_lengths();\n        this.define_scale_and_bins();\n        this.update_data();\n        this.draw();\n    }\n\n    draw() {\n        this.draw_rectangles();\n        this.draw_query_line();\n        this.draw_axes();\n    }\n\n    define_scale_and_bins() {\n        this._scale_x = d3.scaleLinear()\n            .domain([\n                0,\n                (d3.max([this.query_length, d3.max(this._data)]) * 1.01)\n            ]).nice()\n            .range([0, this._width]);\n        this._bins = d3.bin()\n            .domain(this._scale_x.domain())\n            .thresholds(this._scale_x.ticks(50))(this._data);\n        this._scale_y = d3.scaleLinear()\n            .domain([0, d3.max(this._bins, function(d) { return d.length; })])\n            .range([this._height, 0]).nice();\n    }\n\n    hit_lengths() {\n        this._data = _.map(this.query.hits, _.iteratee('length'));\n    }\n\n    setupResponsiveness() {\n        var currentWidth = $(window).width();\n        console.log('cureent '+currentWidth);\n        var debounced_draw = _.debounce(_.bind(function () {\n            if (currentWidth != $(window).width()) {\n                console.log('redraw initiated '+this._height);\n                this.draw();\n                currentWidth = $(window).width();\n            }\n        }, this), 125);\n        $(window).resize(debounced_draw);\n    }\n\n    tick_formatter(seq_type) {\n        const ticks = this._scale_x.ticks();\n        const prefix = d3.format('~s');\n        const suffixes = { amino_acid: 'aa', nucleic_acid: 'bp' };\n\n        return (d) => {\n            if (d === 0 || !ticks.includes(d)) return;\n\n            if (suffixes[seq_type] === 'aa') {\n                return `${d} ${suffixes[seq_type]}`;\n            } else {\n                const formatted = prefix(d);\n\n                return `${Helpers.formatNumberUnits(formatted)}${suffixes[seq_type]}`;\n            }\n        };\n    }\n\n    update_data() {\n        var self = this;\n        var data2 = [];\n        this._bins.map(function (bin) {\n            var inner_data = [];\n            bin.reverse();\n            var y0 = bin.length;\n            bin.map(function (d,i) {\n                var y1 = bin.length - (i+1);\n                var len_index = _.findIndex(self.query.hits, {length: d});\n                var evalue = self.query.hits[len_index].hsps[0].evalue;\n                var item = {\n                    value: d,\n                    id: self.query.hits[len_index].id,\n                    evalue: evalue,\n                    url: '#Query_'+self.query.number+'_hit_'+self.query.hits[len_index].number,\n                    y0: y0,\n                    y1: y0 += (y1 - y0),\n                    color: Helpers.get_colors_for_evalue(evalue,self.query.hits)\n                };\n                inner_data.push(item);\n            });\n            var item = {data: inner_data, x: bin.x0, dx: bin.x1, length: bin.length};\n            data2.push(item);\n        });\n        this._update_data = data2;\n    }\n\n    draw_rectangles() {\n        var self = this;\n        var bar = this.svg.selectAll('.bar')\n            .data(this._update_data)\n            .enter().append('g')\n            .attr('class', 'g')\n            .attr('transform', function(d) {\n                return 'translate('+(self._scale_x(d.x)+self._margin.left)+',0)';\n            });\n\n        bar.selectAll('rect')\n            .data(function (d) { return d.data; })\n            .enter().append('a')\n            .attr('xlink:href', function(i) { return i.url; })\n            .append('rect')\n            .attr('class','bar')\n            .attr('title', function(i) {\n                return i.id+' '+'<br>E value: '+Helpers.prettify_evalue(i.evalue)+'<br>Length: '+i.value;\n            })\n            .attr('x', 1)\n            .attr('y', function(i) { return (self._scale_y(i.y0)); })\n            .attr('width', self._scale_x(this._bins[1].x0) - self._scale_x(this._bins[0].x0) - 1)\n            .attr('height', function (i) { return self._scale_y(i.y1) - self._scale_y(i.y0); })\n            .attr('fill', function(i) {\n                return i.color;\n            });\n    }\n\n    draw_query_line() {\n        var query_line = this.svg.append('g')\n            .attr('class','query_line')\n            .attr('transform','translate('+(this._margin.left+this._scale_x(this.query_length))+',0)');\n\n        query_line.append('rect')\n            .attr('x',1)\n            .attr('class','bar')\n            .attr('width',4)\n            .attr('height',this._height)\n            .style('fill','#c74f14');\n\n        query_line.append('text')\n            .attr('dy', '0.75em')\n            .attr('y', -10)\n            .attr('x', 2)\n            .attr('text-anchor','start')\n            .text('Query')\n            .style('fill','#000')\n            .attr('transform','rotate(-45)');\n    }\n\n    draw_axes() {\n        var space, len;\n        len = this._scale_y.ticks().length;\n        if (len >= 5) {\n            space = 5;\n        } else {\n            space = len;\n        }\n        var formatter = this.tick_formatter(this._seq_type.subject_seq_type);\n        var x_axis = d3.axisTop(this._scale_x)\n            .ticks(50)\n            .tickFormat(formatter);\n        var y_axis = d3.axisLeft(this._scale_y)\n            .tickValues(this._scale_y.ticks(space))\n            .tickSizeOuter(0)\n            .tickFormat(function (e) {\n                if (Math.floor(e) != e) {\n                    return ;\n                }\n                return e;\n            });\n        var ticks = this._scale_y.ticks();\n        for (var i in ticks) {\n            if (ticks[i] % 1 != 0) {\n                y_axis.tickValues(d3.range(0, d3.max(this._bins, function(d) { return d.length; })+1));\n                break;\n            }\n        }\n        var self = this;\n        var xContainer = this.svg.append('g')\n            .attr('class', 'axis axis--x')\n            .attr('transform', 'translate('+this._margin.left+','+this._height+')')\n            .call(x_axis);\n\n        xContainer.selectAll('line').attr('y2',function (d) {\n            var ticks = self._scale_x.ticks();\n            if (_.indexOf(ticks, d) >= 0) {\n                return 7;\n            } else {\n                return 4;\n            }\n        });\n\n        xContainer.selectAll('text').style('text-anchor','end')\n            .attr('x', '-8px')\n            .attr('y', '3px')\n            .attr('dy', '0')\n            .attr('transform','rotate(-90)');\n\n        this.svg.append('g')\n            .attr('class','axis axis--y')\n            .attr('transform','translate('+this._margin.left+',0)')\n            .call(y_axis);\n    }\n}\n\nvar LengthDistribution = Grapher(Graph);\nexport default LengthDistribution;\n","import React, { Component, createRef } from 'react';\nimport _ from 'underscore';\n\nimport HitsOverview from './hits_overview';\nimport LengthDistribution from './length_distribution'; // length distribution of hits\nimport Utils from './utils';\nimport { fastqToFasta } from './fastq_to_fasta';\nimport CollapsePreferences from './collapse_preferences';\nimport './jquery_world';\n\n/**\n * Query component displays query defline, graphical overview, length\n * distribution, and hits table.\n */\nexport class ReportQuery extends Component {\n    // Each update cycle will cause all previous queries to be re-rendered.\n    // We avoid that by implementing shouldComponentUpdate life-cycle hook.\n    // The trick is to simply check if the components has recieved props\n    // before.\n    shouldComponentUpdate() {\n        // If the component has received props before, query property will\n        // be set on it. If it is, we return false so that the component\n        // is not re-rendered. If the query property is not set, we return\n        // true: this must be the first time react is trying to render the\n        // component.\n        return !this.props.query;\n    }\n    // Kind of public API //\n\n    /**\n     * Returns the id of query.\n     */\n    domID() {\n        return 'Query_' + this.props.query.number;\n    }\n\n    queryLength() {\n        return this.props.query.length;\n    }\n\n    /**\n     * Returns number of hits.\n     */\n    numhits() {\n        return this.props.query.hits.length;\n    }\n    headerJSX() {\n        var meta = `Length: ${this.queryLength().toLocaleString()}`;\n\n        if (this.props.showQueryCrumbs) {\n            meta = `query ${this.props.query.number}. ${meta}`;\n        }\n        return <div className=\"section-header border-b border-seqorange justify-between w-full flex flex-col sm:flex-row gap-4\">\n            <h3 className=\"text-base cursor-pointer flex flex-col sm:flex-row items-start\">\n                <strong>Query=<span className=\"ml-1\">{this.props.query.id}</span></strong>\n                <span className=\"ml-1\">{this.props.query.title}</span>\n            </h3>\n            <span className=\"label first-letter:capitalize text-sm text-right font-normal text-inherit pt-0 px-0\">{meta}</span>\n        </div>;\n    }\n\n    hitsListJSX() {\n        return <div className=\"pt-0 px-0 pb-px\">\n            <HitsOverview key={'GO_' + this.props.query.number} query={this.props.query} program={this.props.program} collapsed={this.props.veryBig} />\n            <LengthDistribution key={'LD_' + this.props.query.id} query={this.props.query} algorithm={this.props.program} />\n            <HitsTable key={'HT_' + this.props.query.number} query={this.props.query} imported_xml={this.props.imported_xml} />\n        </div>;\n    }\n\n    noHitsJSX() {\n        return <div className=\"pt-0 px-0 pb-px\">\n            <strong> ****** No BLAST hits found ****** </strong>\n        </div>;\n    }\n\n    render() {\n        return (\n            <div className=\"resultn mt-1.5\" id={this.domID()}\n                data-query-len={this.props.query.length}\n                data-algorithm={this.props.program}>\n                {this.headerJSX()}\n                {this.numhits() && this.hitsListJSX() || this.noHitsJSX()}\n            </div>\n        );\n    }\n}\n\n\n/**\n * Query widget for Search component.\n */\nexport class SearchQueryWidget extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            value: $('input#input_sequence').val() || ''\n        };\n        this.value = this.value.bind(this);\n        this.clear = this.clear.bind(this);\n        this.focus = this.focus.bind(this);\n        this.isEmpty = this.isEmpty.bind(this);\n        this.textarea = this.textarea.bind(this);\n        this.controls = this.controls.bind(this);\n        this.handleInput = this.handleInput.bind(this);\n        this.hideShowButton = this.hideShowButton.bind(this);\n        this.indicateError = this.indicateError.bind(this);\n        this.indicateNormal = this.indicateNormal.bind(this);\n        this.type = this.type.bind(this);\n        this.guessSequenceType = this.guessSequenceType.bind(this);\n        this.preProcessSequence = this.preProcessSequence.bind(this);\n        this.notify = this.notify.bind(this);\n\n        this.textareaRef = createRef();\n        this.controlsRef = createRef();\n    }\n\n\n    // LIFECYCLE Methods\n\n    componentDidMount() {\n        $('body').click(function () {\n            $('[data-notifications] [data-role=notification].active').hide('drop', { direction: 'up' }).removeClass('active');\n        });\n    }\n\n    componentDidUpdate() {\n        this.hideShowButton();\n        this.preProcessSequence();\n        this.props.onSequenceChanged(this.residuesCount());\n\n        var type = this.type();\n        if (!type || type !== this._type) {\n            this._type = type;\n            this.notify(type);\n            this.props.onSequenceTypeChanged(type);\n        }\n    }\n\n    // Kind of public API. //\n\n    /**\n     * Returns query sequence if no argument is provided (or null or undefined\n     * is provided as argument). Otherwise, sets query sequence to the given\n     * value and returns `this`.\n     *\n     * Default/initial state of query sequence is an empty string. Caller must\n     * explicitly provide empty string as argument to \"reset\" query sequence.\n     */\n    value(val) {\n        if (val == null) {\n            // i.e., val is null or undefined\n            return this.state.value;\n        }\n        else {\n            this.setState({\n                value: val\n            });\n            return this;\n        }\n    }\n\n    residuesCount() {\n        const sequence = this.value();\n        const lines = sequence.split('\\n');\n        const residuesCount = lines.reduce((count, line) => {\n            if (!line.startsWith('>')) {\n                return count + line.length;\n            }\n            return count;\n        }, 0);\n\n        return residuesCount;\n    }\n\n    /**\n     * Clears textarea. Returns `this`.\n     *\n     * Clearing textarea also causes it to be focussed.\n     */\n    clear() {\n        return this.value('').focus();\n    }\n\n    /**\n     * Focuses textarea. Returns `this`.\n     */\n    focus() {\n        this.textarea().focus();\n        return this;\n    }\n\n    /**\n     * Returns true if query is absent ('', undefined, null), false otherwise.\n     */\n    isEmpty() {\n        return !this.value();\n    }\n\n\n    // Internal helpers. //\n\n    textarea() {\n        return $(this.textareaRef.current);\n    }\n\n    controls() {\n        return $(this.controlsRef.current);\n    }\n\n    handleInput(evt) {\n        this.value(evt.target.value);\n    }\n\n    /**\n     * Hides or shows 'clear sequence' button.\n     *\n     * Rendering the 'clear sequence' button takes into account presence or\n     * absence of a scrollbar.\n     *\n     * Called by `componentDidUpdate`.\n     */\n    hideShowButton() {\n        if (!this.isEmpty()) {\n            // Calculation below is based on -\n            // http://chris-spittles.co.uk/jquery-calculate-scrollbar-width/\n            // FIXME: can reflow be avoided here?\n            var textareaNode = this.textarea()[0];\n            var sequenceControlsRight = textareaNode.offsetWidth - textareaNode.clientWidth;\n            this.controls().css('right', sequenceControlsRight + 17);\n            this.controls().removeClass('hidden');\n        }\n        else {\n            // FIXME: what are lines 1, 2, & 3 doing here?\n            this.textarea().parent().removeClass('has-error');\n            this.$sequenceFile = $('#sequence-file');\n            this.$sequenceFile.empty();\n\n            this.controls().addClass('hidden');\n        }\n    }\n\n    /**\n     * Put red border around textarea.\n     */\n    indicateError() {\n        this.textarea().parent().addClass('has-error');\n    }\n\n    /**\n     * Put normal blue border around textarea.\n     */\n    indicateNormal() {\n        this.textarea().parent().removeClass('has-error');\n    }\n\n    /**\n     * Returns type of the query sequence (nucleotide, protein, mixed).\n     *\n     * Query widget supports executing a callback when the query type changes.\n     * Components interested in query type should register a callback instead\n     * of directly calling this method.\n     */\n    type() {\n        let sequence = this.value().trim();\n        // FASTQ detected, but we don't know if conversion has succeeded yet\n        // will notify separately if it does\n        if (sequence.startsWith('@') ) { return undefined; }\n\n        var sequences = sequence.split(/>.*/);\n\n        var type, tmp;\n\n        for (var i = 0; i < sequences.length; i++) {\n            tmp = this.guessSequenceType(sequences[i]);\n\n            // could not guess the sequence type; try the next sequence\n            if (!tmp) { continue; }\n\n            if (!type) {\n                // successfully guessed the type of atleast one sequence\n                type = tmp;\n            }\n            else if (tmp !== type) {\n                // user has mixed different type of sequences\n                return 'mixed';\n            }\n        }\n\n        return type;\n    }\n\n    preProcessSequence() {\n        var sequence = this.value();\n        var updatedSequence = fastqToFasta(sequence);\n\n        if (sequence !== updatedSequence) {\n            this.value(updatedSequence);\n            this.notify('fastq');\n        }\n    }\n\n    /**\n     * Guesses and returns the type of the given sequence (nucleotide,\n     * protein).\n     */\n    guessSequenceType(sequence) {\n        // remove 'noisy' characters\n        sequence = sequence.replace(/[^A-Z]/gi, ''); // non-letter characters\n        sequence = sequence.replace(/[NX]/gi, ''); // ambiguous  characters\n\n        // can't determine the type of ultrashort queries\n        if (sequence.length < 10) {\n            return undefined;\n        }\n\n        // count the number of putative NA\n        var putative_NA_count = 0;\n        for (var i = 0; i < sequence.length; i++) {\n            if (sequence[i].match(/[ACGTU]/i)) {\n                putative_NA_count += 1;\n            }\n        }\n\n        var threshold = 0.9 * sequence.length;\n        return putative_NA_count > threshold ? 'nucleotide' : 'protein';\n    }\n\n    notify(type) {\n        this.indicateNormal();\n        clearTimeout(this.notification_timeout);\n        // $('[data-notifications] [data-role=notification].active').hide().removeClass('active');\n\n        if (type) {\n            $('#' + type + '-sequence-notification').show('drop', { direction: 'up' }).addClass('active');\n\n            this.notification_timeout = setTimeout(function () {\n                $('[data-notifications] [data-role=notification].active').hide('drop', { direction: 'up' }).removeClass('active');\n            }, 5000);\n\n            if (type === 'mixed') {\n                this.indicateError();\n            }\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"relative\">\n                <div\n                    className=\"sequence\">\n                    <textarea\n                        id=\"sequence\" ref={this.textareaRef}\n                        className=\"block w-full p-4 text-gray-900 border border-gray-300 rounded-l-lg rounded-tr-lg bg-gray-50 text-sm font-mono min-h-52 resize-y\"\n                        name=\"sequence\" value={this.state.value}\n                        rows=\"6\"\n                        required=\"required\"\n                        placeholder=\"Paste query sequence(s) or drag file\n                        containing query sequence(s) in FASTA format here ...\"\n                        spellCheck=\"false\" autoFocus\n                        onChange={this.handleInput}>\n                    </textarea>\n                </div>\n                <div\n                    className=\"hidden absolute top-2 right-2\"\n                    ref={this.controlsRef}>\n                    <button\n                        type=\"button\"\n                        className=\"border border-gray-300 rounded bg-white hover:bg-gray-200\" id=\"btn-sequence-clear\"\n                        title=\"Clear query sequence(s).\"\n                        onClick={this.clear}>\n                        <span id=\"sequence-file\"></span>\n                        <i className=\"fa fa-times w-6 h-6 p-1\"></i>\n                        <span className=\"sr-only\">Clear query sequence(s).</span>\n                    </button>\n                </div>\n            </div>\n        );\n    }\n}\n\n\n/**\n * Renders summary of all hits per query in a tabular form.\n */\n\nclass HitsTable extends Component {\n    constructor(props) {\n        super(props);\n        this.name = 'Hit sequences producing significant alignments';\n        this.collapsePreferences = new CollapsePreferences(this);\n        this.state = {\n            collapsed: this.collapsePreferences.preferenceStoredAsCollapsed()\n        };\n    }\n\n    tableJSX() {\n        var hasName = _.every(this.props.query.hits, function (hit) {\n            return hit.sciname !== '';\n        });\n\n        // Width of sequence column is 55% when species name is not shown and\n        // query coverage is.\n        var seqwidth = 55;\n        // If we are going to show species name, then reduce the width of\n        // sequence column by the width of species column.\n        if (hasName) seqwidth -= 15;\n        // If we are not going to show query coverage (i.e. for imported XML),\n        // then increase the width of sequence column by the width of coverage\n        // column.\n        if (this.props.imported_xml) seqwidth += 15;\n\n        return <table\n            className=\"table table-hover table-condensed tabular-view text-sm min-w-full mb-0\">\n            <thead>\n                <tr className=\"text-neutral-500\">\n                    <th className=\"text-left font-normal\">#</th>\n                    <th style={{ width: `${seqwidth}%` }} className=\"text-left font-normal\">Similar sequences</th>\n                    {hasName && <th className=\"text-left font-normal w-2/12\">Species</th>}\n                    {!this.props.imported_xml && <th className=\"text-right font-normal w-2/12\">Query coverage (%)</th>}\n                    <th className=\"text-right font-normal w-1/12\">Total score</th>\n                    <th className=\"text-right font-normal w-1/12\">E value</th>\n                    <th className=\"text-right font-normal w-1/12\">Identity (%)</th>\n                </tr>\n            </thead>\n            <tbody>\n                {\n                    _.map(this.props.query.hits, _.bind(function (hit) {\n                        return (\n                            <tr key={hit.number}>\n                                <td className=\"text-left\">{hit.number + '.'}</td>\n                                <td>\n                                    <a href={'#Query_' + this.props.query.number + '_hit_' + hit.number}\n                                        className=\"text-sm text-seqblue hover:text-seqorange cursor-pointer pe-1 line-clamp-1 tooltip-item\" title={`${hit.id} ${hit.title}`}>{hit.id} {hit.title}</a>\n                                </td>\n                                {hasName &&\n                                    <td className=\"pe-1 line-clamp-1 tooltip-item\" title={hit.sciname}>\n                                        {hit.sciname}\n                                    </td>\n                                }\n                                {!this.props.imported_xml && <td className=\"text-right\">{hit.qcovs}</td>}\n                                <td className=\"pe-1 text-right\">{hit.total_score}</td>\n                                <td className=\"pe-1 text-right\">{Utils.inExponential(hit.hsps[0].evalue)}</td>\n                                <td className=\"pe-1 text-right\">{Utils.inPercentage(hit.hsps[0].identity, hit.hsps[0].length)}</td>\n                            </tr>\n                        );\n                    }, this))\n                }\n            </tbody>\n        </table>;\n    }\n\n    render() {\n        return (\n            <div className={`table-hit-overview ${this.state.collapsed ? 'print:hidden' : ''}`}>\n                <div className=\"grapher-header pr-px\">\n                    <h4 className=\"inline-block pl-px m-0 caption cursor-pointer text-sm caption\" onClick={() => this.collapsePreferences.toggleCollapse()}>\n                        {this.collapsePreferences.renderCollapseIcon()}\n                        <span> {this.name}</span>\n                    </h4>\n                </div>\n                <div id={'Query_' + this.props.query.number + 'HT_' + this.props.query.number} className=\"overflow-auto md:overflow-hidden\">\n                    {!this.state.collapsed && this.tableJSX()}\n                </div>\n            </div>\n        );\n    }\n}\n","import * as d3 from 'd3';\nimport _ from 'underscore';\nimport Grapher from 'grapher';\nimport * as Helpers from './visualisation_helpers';\n\n/**\n * Renders Kablammo visualization\n *\n * JSON received from server side is modified as JSON expected by kablammo's\n * graph.js.  All the relevant information including a SVG container where\n * visual needs to be rendered, is delegated to graph.js. graph.js renders\n * kablammo visualization and has all event handlers for events performed on\n * the visual.\n *\n * Event handlers related to downloading and viewing of alignments and images\n * have been extracted from grapher.js and interface.js and directly included\n * here.\n */\n\nclass Graph {\n    static canCollapse() {\n        return true;\n    }\n\n    static name() {\n        return 'Graphical overview of aligning region(s)';\n    }\n\n    static className() {\n        return 'kablammo';\n    }\n\n    static graphId(props) {\n        return 'kablammo_'+props.query.number+'_'+props.hit.number;\n    }\n\n    static dataName(props) {\n        return `Kablammo_query-${props.query.number}_${props.query.id}_${props.hit.id}`;\n    }\n\n    constructor($svgContainer, props) {\n        this._zoom_scale_by = 1.4;\n        this._padding_x = 12;\n        this._padding_y = 55;\n\n        this._canvas_height = $svgContainer.height();\n        this._canvas_width = $svgContainer.width();\n\n        this._results = Helpers.get_seq_type(props.algorithm);\n        this._query_id = props.query.id;\n        this._subject_id = props.hit.id;\n        this._query_length = props.query.length;\n        this._subject_length = props.hit.length;\n        this._show_numbers = props.showHSPCrumbs;\n        // this._hsps = this.toKablammo(props.hit.hsps, props.query);\n        this._hsps = props.hit.hsps;\n        this._maxBitScore = props.query.hits[0].hsps[0].bit_score;\n\n        this.svgContainer_d3 = d3.select($svgContainer[0]);\n        this._svg = {};\n\n        this._svg.jq = $(this._svg.raw);\n\n        this._scales = this._create_scales();\n        this.use_complement_coords = false;\n        this._axis_ticks = 10;\n\n        this._initiate();\n        this.bindHoverHandler($svgContainer);\n    }\n\n    bindHoverHandler ($svgContainer) {\n        // Raise polygon on hover.\n        $svgContainer.find('polygon').hover(\n            function () {\n                var $g = $(this).parent();\n                $g.parent().append($g);\n            }\n        );\n    }\n\n    _initiate() {\n        this._svg.d3 =\n          this.svgContainer_d3.insert('svg', ':first-child')\n              .attr('height', this._canvas_height)\n              .attr('width', this._canvas_width);\n        this._svg.raw = this._svg.d3._groups[0][0];\n        this._render_graph();\n    }\n\n    _rotate_axis_labels(text, text_anchor, dx, dy) {\n        text.style('text-anchor', text_anchor)\n            .attr('x', dx)\n            .attr('y', dy)\n        // When axis orientation is \"bottom\", d3 automataically applies a 0.71em\n        // dy offset to labels. As Inkscape does not seem to properly interpret\n        // such values, force them to be zero. When calling this function, then,\n        // you must compensate by adding 0.71em worth of offset to the dy value\n        // you provide.\n            .attr('dx', 0)\n            .attr('dy', 0)\n            .attr('transform', 'rotate(-90)');\n    }\n\n    _create_axis(scale, orientation, height, text_anchor, dx, dy, seq_type) {\n        var formatter = Helpers.tick_formatter(scale, seq_type);\n        var tvalues = scale.ticks();\n        var axis;\n        tvalues.pop();\n        if (orientation === 'top') {\n            axis = d3.axisTop(scale)\n        } else {\n            axis = d3.axisBottom(scale)\n        }\n\n        axis.ticks(this._axis_ticks)\n            .tickValues(tvalues.concat(scale.domain()))\n            .tickFormat(formatter)\n\n        var container = this._svg.d3.append('g')\n            .attr('class', 'axis')\n            .attr('transform', 'translate(0,' + height + ')')\n            .call(axis);\n        this._rotate_axis_labels(container.selectAll('text'), text_anchor, dx, dy);\n        return container;\n    }\n\n    _is_domain_within_orig(original_domain, new_domain) {\n        return original_domain[0] <= new_domain[0] && original_domain[1] >= new_domain[1];\n    }\n\n    _zoom_scale(scale, original_domain, zoom_from, scale_by) {\n        var l = scale.domain()[0];\n        var r = scale.domain()[1];\n\n        l = zoom_from - (zoom_from - l) / scale_by;\n        r = zoom_from + (r - zoom_from) / scale_by;\n\n        l = Math.round(l);\n        r = Math.round(r);\n        if(r - l < this._axis_ticks)\n            return;\n\n        var new_domain = [l, r];\n        if(this._is_domain_within_orig(original_domain, new_domain))\n            scale.domain(new_domain);\n        else\n            scale.domain(original_domain);\n    }\n\n    _pan_scale(existing_scale, original_domain, delta) {\n        var scale = (existing_scale.domain()[1] - existing_scale.domain()[0]) / (existing_scale.range()[1] - existing_scale.range()[0]);\n        var scaled_delta = -delta * scale;\n\n        var domain = existing_scale.domain();\n        var l = domain[0] + scaled_delta;\n        var r = domain[1] + scaled_delta;\n        var new_domain = [l, r];\n\n        if(this._is_domain_within_orig(original_domain, new_domain))\n            existing_scale.domain(new_domain);\n    }\n\n    _render_polygons() {\n        var self = this;\n\n        // Remove all existing child elements.\n        this._svg.d3.selectAll('*').remove();\n\n        this._polygons = this._svg.d3.selectAll('polygon')\n            .data(this._hsps.slice().reverse())\n            .enter()\n            .append('g')\n            .attr('class','polygon');\n\n        this._polygons.append('polygon')\n            .attr('class', 'hit')\n            .attr('fill', function(hsp) {\n                return self.determine_colour(hsp.bit_score / self._maxBitScore);\n            }).attr('points', function(hsp) {\n                // We create query_x_points such that the 0th element will *always* be\n                // on the left of the 1st element, regardless of whether the axis is\n                // drawn normally (i.e., ltr) or reversed (i.e., rtl). We do the same\n                // for subject_x_points. As our parsing code guarantees start < end, we\n                // decide on this ordering based on the reading frame, because it\n                // determines whether our axis will be reversed or not.\n                var query_x_points = [self._scales.query.scale(hsp.qstart), self._scales.query.scale(hsp.qend)];\n                var subject_x_points = [self._scales.subject.scale(hsp.sstart), self._scales.subject.scale(hsp.send)];\n\n                // Axis will be rendered with 5' end on right and 3' end on left, so we\n                // must reverse the order of vertices for the polygon we will render to\n                // prevent the polygon from \"crossing over\" itself.\n                if(!self.use_complement_coords) {\n                    if(hsp.qframe < 0)\n                        query_x_points.reverse();\n                    if(hsp.sframe < 0)\n                        subject_x_points.reverse();\n                }\n\n                var points = [\n                    [query_x_points[0],   self._scales.query.height   + 1],\n                    [subject_x_points[0], self._scales.subject.height - 1],\n                    [subject_x_points[1], self._scales.subject.height - 1],\n                    [query_x_points[1],   self._scales.query.height   + 1],\n                ];\n\n                return points.map(function(point) {\n                    return point[0] + ',' + point[1];\n                }).join(' ');\n            });\n\n        if (self._show_numbers) {\n            this._polygons.append('text')\n                .attr('x', function(hsp) {\n                    var query_x_points = [self._scales.query.scale(hsp.qstart), self._scales.query.scale(hsp.qend)];\n                    var subject_x_points = [self._scales.subject.scale(hsp.sstart), self._scales.subject.scale(hsp.send)];\n                    var middle1 = (query_x_points[0] + subject_x_points[0]) * 0.5;\n                    var middle2 = (query_x_points[1] + subject_x_points[1]) * 0.5;\n                    return (middle2 + middle1) * 0.5;\n                })\n                .attr('y', function(hsp) {\n                    var a = self._scales.query.height;\n                    var b = self._scales.subject.height;\n                    var middle = ( b - a ) / 2;\n                    return a + middle + 2; // for font-height 10px\n                })\n                .text(function(hsp) {\n                    return Helpers.toLetters(hsp.number);\n                });\n        }\n\n    }\n\n    _overlaps(s1, e1, s2, e2) {\n        return Math.min(e1, e2) > Math.max(s1, s2);\n    }\n\n    _rects_overlap(rect1, rect2, padding) {\n        padding = padding || 0;\n\n        return this._overlaps(\n            rect1.left - padding,\n            rect1.right + padding,\n            rect2.left,\n            rect2.right\n        ) && this._overlaps(\n            rect1.top - padding,\n            rect1.bottom + padding,\n            rect2.top,\n            rect2.bottom\n        );\n    }\n\n    _render_axes() {\n        var query_axis = this._create_axis(this._scales.query.scale,   'top',\n            this._scales.query.height,   'start', '9px', '2px',\n            this._results.query_seq_type);\n        var subject_axis = this._create_axis(this._scales.subject.scale, 'bottom',\n            this._scales.subject.height, 'end',   '-11px',  '3px',\n            this._results.subject_seq_type);\n    }\n\n    _render_graph() {\n        this._render_polygons();\n        this._render_axes();\n    }\n\n    _find_nearest_scale(point) {\n        var nearest = null;\n        var smallest_distance = Number.MAX_VALUE;\n\n        var self = this;\n        Object.keys(this._scales).forEach(function(scale_name) {\n            var scale        = self._scales[scale_name].scale;\n            var scale_height = self._scales[scale_name].height;\n\n            var delta = Math.abs(scale_height - point[1]);\n            if(delta < smallest_distance) {\n                nearest = scale;\n                smallest_distance = delta;\n            }\n        });\n\n        return nearest;\n    }\n\n    _create_scales() {\n        var query_range   = [this._padding_x, this._canvas_width - this._padding_x];\n        var subject_range = [this._padding_x, this._canvas_width - this._padding_x];\n\n        // If we wish to show the HSPs relative to the original (input or DB)\n        // sequence rather than its complement (i.e., use_complement_coords = false),\n        // even when the HSPs lie on the complement, then we must display the axis\n        // with its 5' end on the right and 3' end on the left. In this case, you can\n        // imagine the invisible complementary strand (with its 5' end on left and 3'\n        // end on right) floating above the rendered original strand, with the hits\n        // actually falling on the complementary strand.\n        //\n        // If we show the HSPs relative to the complementary strand (i.e.,\n        // use_complement_coords = true), then we *always* wish to show the axis with\n        // its 5' end on the left and 3' end on the right.\n        //\n        // Regardless of whether this value is true or falase, the rendered polygons\n        // will be precisely the same (meaning down to the pixel -- they will be\n        // *identical*). Only the direction of the axis, and the coordinates of\n        // points falling along it, change.\n        if(!this.use_complement_coords) {\n            if(this._hsps[0].qframe < 0)\n                query_range.reverse();\n            if(this._hsps[0].sframe < 0)\n                subject_range.reverse();\n        }\n\n        var query_scale = d3.scaleLinear()\n            .domain([1, this._query_length])\n            .range(query_range);\n        var subject_scale = d3.scaleLinear()\n            .domain([1, this._subject_length])\n            .range(subject_range);\n        query_scale.original_domain = query_scale.domain();\n        subject_scale.original_domain = subject_scale.domain();\n\n        var query_height = this._padding_y;\n        var subject_height = this._canvas_height - this._padding_y;\n\n        var scales = {\n            subject: { height: subject_height, scale: subject_scale },\n            query:   { height: query_height,   scale: query_scale   },\n        };\n        return scales;\n    }\n\n    _rgba_to_rgb(rgba, matte_rgb) {\n        // Algorithm taken from http://stackoverflow.com/a/2049362/1691611.\n        var normalize = function (colour) {\n            return colour.map(function (channel) { return channel / 255; });\n        };\n\n        var denormalize = function (colour) {\n            return colour.map(function (channel) { return Math.round(Math.min(255, channel * 255)); });\n        };\n\n        var norm = normalize(rgba.slice(0, 3));\n        matte_rgb = normalize(matte_rgb);\n        var alpha = rgba[3] / 255;\n\n        var rgb = [\n            (alpha * norm[0]) + (1 - alpha) * matte_rgb[0],\n            (alpha * norm[1]) + (1 - alpha) * matte_rgb[1],\n            (alpha * norm[2]) + (1 - alpha) * matte_rgb[2],\n        ];\n\n        return denormalize(rgb);\n    }\n\n    /**\n   * Determines colour of a hsp based on normalized bit-score.\n   *\n   * Taken from grapher.js\n   */\n    determine_colour(level) {\n        var graph_colour = { r: 199, g: 79, b: 20 };\n        var matte_colour = { r: 255, g: 255, b: 255 };\n        var min_opacity = 0.3;\n        var opacity = ((1 - min_opacity) * level) + min_opacity;\n        var rgb = this._rgba_to_rgb([\n            graph_colour.r,\n            graph_colour.g,\n            graph_colour.b,\n            255 * opacity\n        ], [\n            matte_colour.r,\n            matte_colour.g,\n            matte_colour.b,\n        ]);\n        return 'rgb(' + rgb.join(',') + ')';\n    }\n}\n\nvar Kablammo = Grapher(Graph);\nexport default Kablammo;\n","/**\n * Dynamically create form and submit.\n *\n * Author: Filip Ter\n */\nexport default function downloadFASTA(sequence_ids, database_ids) {\n    var form = $('<form/>').attr('method', 'post').attr('action', 'get_sequence');\n    addField('sequence_ids', sequence_ids);\n    addField('database_ids', database_ids);\n    addField('_csrf', document.querySelector('meta[name=\"_csrf\"]').content);\n    form.appendTo('body').submit().remove();\n\n    function addField(name, val) {\n        form.append(\n            $('<input>').attr('type', 'hidden').attr('name', name).val(val)\n        );\n    }\n}\n","import * as Exporter from './exporter';\nimport _ from 'underscore';\n\nexport default class AlignmentExporter {\n    constructor() {\n        this.prepare_alignments_for_export = this.prepare_alignments_for_export.bind(this);\n        this.export_alignments = this.export_alignments.bind(this);\n    }\n\n    wrap_string(str, width) {\n        return str.match(new RegExp(`.{1,${width}}`, 'g')).join('\\n');\n    }\n\n    generate_fasta(hsps) {\n        let fasta = '';\n\n        hsps.map(hsp => {\n            fasta += `>${hsp.query_id}:${hsp.qstart}-${hsp.qend}\\n`;\n            fasta += `${hsp.qseq}\\n`;\n            fasta += `>${hsp.query_id}:${hsp.qstart}-${hsp.qend}_alignment_${hsp.hit_id}:${hsp.sstart}-${hsp.send}\\n`;\n            fasta += `${hsp.midline}\\n`;\n            fasta += `>${hsp.hit_id}:${hsp.sstart}-${hsp.send}\\n`;\n            fasta += `${hsp.sseq}\\n`;\n        });\n\n        return fasta;\n    }\n\n    get_alignments_download_metadata(hsps, filename_prefix){\n        const fasta = this.generate_fasta(hsps);\n        const blob = new Blob([fasta], { type: 'text/fasta' });\n        const filename = Exporter.sanitize_filename(filename_prefix) + '.txt';\n        return {filename, blob};\n    }\n\n    prepare_alignments_for_export(hsps, filename_prefix) {\n        const { filename, blob } = this.get_alignments_download_metadata(hsps, filename_prefix);\n        return Exporter.generate_blob_url(blob, filename);\n    }\n\n    export_alignments(hsps, filename_prefix) {\n        const { filename, blob } = this.get_alignments_download_metadata(hsps, filename_prefix);\n        Exporter.download_blob(blob, filename);\n    }\n}\n","class HitButtons {\n    constructor(hit) {\n        this.hit = hit;\n    }\n\n    buttons() {\n        return [];\n    }\n}\n\nexport default HitButtons;","import React, { Component } from 'react';\nimport _ from 'underscore';\n\nimport HSPOverview from './kablammo';\nimport downloadFASTA from './download_fasta';\nimport AlignmentExporter from './alignment_exporter'; // to download textual alignment\nimport HitButtons from 'hit_buttons';\n\n/**\n * Component for each hit. Receives props from Report. Has no state.\n */\nexport default class extends Component {\n    constructor(props) {\n        super(props);\n        this.accession = this.accession.bind(this);\n        this.sequenceID = this.sequenceID.bind(this);\n        this.hitLength = this.hitLength.bind(this);\n        this.numHSPs = this.numHSPs.bind(this);\n        this.domID = this.domID.bind(this);\n        this.databaseIDs = this.databaseIDs.bind(this);\n        this.showSequenceViewer = this.showSequenceViewer.bind(this);\n        this.viewSequenceLink = this.viewSequenceLink.bind(this);\n        this.downloadFASTA = this.downloadFASTA.bind(this);\n        this.downloadAlignment = this.downloadAlignment.bind(this);\n        this.headerJSX = this.headerJSX.bind(this);\n        this.contentJSX = this.contentJSX.bind(this);\n        this.hitLinks = this.hitLinks.bind(this);\n        this.viewSequenceButton = this.viewSequenceButton.bind(this);\n        this.downloadFASTAButton = this.downloadFASTAButton.bind(this);\n        this.hit_buttons = new HitButtons(this);\n    }\n    shouldComponentUpdate() {\n        return !this.props.hit;\n    }\n    /**\n     * Returns accession number of the hit sequence.\n     */\n    accession() {\n        return this.props.hit.accession;\n    }\n\n    /**\n     * Returns id of the hit sequence.\n     */\n    sequenceID() {\n        return this.props.hit.id;\n    }\n\n    /**\n     * Returns length of the hit sequence.\n     */\n    hitLength() {\n        return this.props.hit.length;\n    }\n\n    numHSPs() {\n        return this.props.hit.hsps.length;\n    }\n\n    // Internal helpers. //\n\n    /**\n     * Returns id that will be used for the DOM node corresponding to the hit.\n     */\n    domID() {\n        return 'Query_' + this.props.query.number + '_hit_' + this.props.hit.number;\n    }\n\n    databaseIDs() {\n        return _.map(this.props.querydb, _.iteratee('id'));\n    }\n\n    showSequenceViewer() {\n        this.props.showSequenceModal(this.viewSequenceLink());\n    }\n\n    viewSequenceLink() {\n        var sequenceIDs = encodeURIComponent(this.sequenceID());\n        var databaseIDs = encodeURIComponent(this.databaseIDs());\n        return `get_sequence/?sequence_ids=${sequenceIDs}&database_ids=${databaseIDs}`;\n    }\n\n    downloadFASTA(_event) {\n        var sequenceIDs = [this.sequenceID()];\n        downloadFASTA(sequenceIDs, this.databaseIDs());\n    }\n\n    // Event-handler for exporting alignments.\n    // Calls relevant method on AlignmentExporter defined in alignment_exporter.js.\n    downloadAlignment(_event) {\n        var hsps = _.map(this.props.hit.hsps, _.bind(function (hsp) {\n            hsp.query_id = this.props.query.id;\n            hsp.hit_id = this.props.hit.id;\n            return hsp;\n        }, this));\n\n        var aln_exporter = new AlignmentExporter();\n        aln_exporter.export_alignments(hsps, this.props.query.id + '_' + this.props.hit.id);\n    }\n\n    headerJSX() {\n        var meta = `Length: ${this.hitLength().toLocaleString()}`;\n\n        if (this.props.showQueryCrumbs && this.props.showHitCrumbs) {\n            // Multiper queries, multiple hits\n            meta = `hit ${this.props.hit.number} of query ${this.props.query.number}. ${meta}`;\n        }\n        else if (this.props.showQueryCrumbs && !this.props.showHitCrumbs) {\n            // Multiple queries, single hit\n            meta = `the only hit of query ${this.props.query.number}. ${meta}`;\n        }\n        else if (!this.props.showQueryCrumbs && this.props.showHitCrumbs) {\n            // Single query, multiple hits\n            meta = `hit ${this.props.hit.number}. ${meta}`;\n        }\n\n        return <div className=\"section-header border-b border-seqorange flex flex-col sm:flex-row sm:justify-between w-full\">\n            <h4 className=\"text-sm cursor-pointer flex flex-col sm:flex-row items-start sm:items-start\" data-parent-id={`#${this.domID()}`}>\n                <div className=\"flex items-start\">\n                    <i className=\"fa-regular fa-square-minus print:!hidden\"></i>\n                    <strong className=\"cursor-text ml-1 print:ml-0\"> {this.props.hit.id}</strong>\n                </div>\n                <span className=\"ml-1\">{this.props.hit.title}</span>\n            </h4>\n            <span className=\"label first-letter:capitalize text-sm font-normal text-inherit cursor-text\">{meta}</span>\n        </div>;\n    }\n\n    contentJSX() {\n        return <div className=\"pt-0 px-0 pb-px\" data-parent-hit={this.domID()}>\n            {this.hitLinks()}\n            <HSPOverview key={'kablammo' + this.props.query.id} query={this.props.query}\n                hit={this.props.hit} algorithm={this.props.algorithm}\n                showHSPCrumbs={this.numHSPs() > 1 && this.numHSPs() < 27}\n                collapsed={this.props.veryBig} />\n        </div>;\n    }\n\n    hitLinks() {\n        var btns = [];\n        if (!(this.props.imported_xml || this.props.non_parse_seqids)) {\n            btns = btns.concat([\n                this.viewSequenceButton(),\n                this.downloadFASTAButton()\n            ]);\n        }\n        btns.push(this.downloadAlignmentButton());\n\n        this.hit_buttons.buttons().forEach((button) => {\n            btns.push(button);\n        });\n\n        return (\n            <div className=\"hit-links h-4 print:hidden\">\n                <label className=\"text-sm text-seqblue hover:seqorange cursor-pointer mb-0\">\n                    <input type=\"checkbox\" id={this.domID() + '_checkbox'}\n                        value={this.sequenceID()} onChange={function () {\n                            this.props.selectHit(this.domID() + '_checkbox');\n                            this.props.onChange();\n                        }.bind(this)} data-target={'#' + this.domID()}\n                    /> Select\n                </label>\n                {\n                    btns.map((btn, index) => {\n                        return [<span className=\"text-seqorange mt-0 mr-1 ml-0 mb-1 px-1\" key={`btn-${index}`}>|</span>, this.button(Object.assign(btn, { key: index }))];\n                    })\n                }\n                {\n                    this.props.hit.links.map((link, index) => {\n                        return [<span className=\"text-seqorange mt-0 mr-1 ml-0 mb-1 px-1\" key={`link-${index}`}>|</span>, this.a(link, index)];\n                    })\n                }\n            </div>\n        );\n    }\n\n    // Return JSX for view sequence button.\n    viewSequenceButton() {\n        if (this.hitLength() > 10000) {\n            return {\n                text: 'Sequence',\n                icon: 'fa-eye',\n                className: 'view-sequence',\n                title: 'Sequence too long',\n            };\n        }\n        else {\n            return {\n                text: 'Sequence',\n                icon: 'fa-eye',\n                className: 'view-sequence',\n                onClick: () => this.showSequenceViewer()\n            };\n\n        }\n    }\n\n    downloadFASTAButton() {\n        return {\n            text: 'FASTA',\n            icon: 'fa-download',\n            className: 'download-fa',\n            onClick: () => this.downloadFASTA()\n        };\n    }\n\n    downloadAlignmentButton() {\n        return {\n            text: 'Alignment',\n            icon: 'fa-download',\n            className: 'download-aln',\n            onClick: () => this.downloadAlignment()\n        };\n    }\n\n    button({ text, icon, title, className, onClick, key }) {\n        if (onClick) {\n            return <button key={key} className={`btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer ${className}`}\n                title={title} onClick={onClick}><i className={`fa ${icon}`}></i> {text}\n            </button>;\n        }\n        else {\n            return <button key={key} className=\"text-sm view-sequence disabled\"\n                title={title} disabled={true}>\n                <i className={`fa ${icon}`}></i> {text}\n            </button>;\n        }\n    }\n\n    /**\n     * Render URL for sequence-viewer.\n     */\n    a(link, key) {\n        if (!link.title || !link.url) return;\n\n        let className = 'btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer';\n        if (link.class) className = `${className} ${link.class}`;\n        return <a href={link.url} key={`${link.url}-${key}`} className={className} target='_blank'>\n            {link.icon && <i className={'fa ' + link.icon}></i>}\n            {' ' + link.title + ' '}\n        </a>;\n    }\n    render() {\n        return (\n            <div className=\"hit mt-1 border-l-2 border-transparent pl-1 -ml-1\" id={this.domID()} data-hit-def={this.props.hit.id}\n                data-hit-len={this.props.hit.length} data-hit-evalue={this.props.hit.evalue}>\n                {this.headerJSX()} {this.contentJSX()}\n            </div>\n        );\n    }\n}\n","import React, { useState, createRef, useEffect } from \"react\";\nimport useDetectPrint from \"react-detect-print\";\nimport _ from \"underscore\";\n\nimport Utils from \"./utils\";\nimport * as Helpers from \"./visualisation_helpers\";\n\n/**\n * Alignment viewer.\n */\n// export default class HSP extends React.Component {\nexport default function HSP(props) {\n  const hsp = props.hsp;\n  const hspRef = createRef();\n  const printing = useDetectPrint();\n  const [chars, setChars] = useState(0)\n  const [width, setWidth] = useState(window.innerWidth);\n\n  const domID = () => {\n    const { query, hit, hsp } = props;\n    return `Query_${query.number}_hit_${hit.number}_${hsp.number}`;\n  }\n\n  const hitDOM_ID = () => {\n    return \"Query_\" + props.query.number + \"_hit_\" + props.hit.number;\n  }\n\n  useEffect(() => {\n    // Attach a debounced listener to handle window resize events \n    // Updates the width state with the current window width, throttled to run at most once every 125ms\n    const handleResize = _.debounce(() => setWidth(window.innerWidth), 125);\n    window.addEventListener(\"resize\", handleResize);\n\n    // TODO: print handler\n    draw();\n  }, [])\n\n  useEffect(() => {\n    draw(printing);\n  }, [printing, width])\n  \n  const draw = (printing = false) => {\n    const charWidth = props.getCharacterWidth();\n    const containerWidth = printing ? 900 : $(hspRef.current).width();\n    setChars(Math.floor((containerWidth - 4) / charWidth))\n  }\n\n  /**\n   * Returns an array of span elements or plain strings (React automatically\n   * adds span tag around strings). This array is passed as it is to JSX to be\n   * rendered just above the pairwise alignment (see render method).\n   *\n   * We cannot return a string from this method otherwise we wouldn't be able\n   * to use JSX elements to format text (like, superscript).\n   */\n  const hspStats = () => {\n    // An array to hold text or span elements that make up the line.\n    let line = [];\n\n    // Bit score and total score.\n    line.push(\n      `Score: ${Utils.inTwoDecimal(hsp.bit_score)} (${hsp.score}), `\n    );\n\n    // E value\n    line.push(\"E value: \");\n    line.push(Utils.inExponential(hsp.evalue));\n    line.push(\", \");\n\n    // Identity\n    line.push([\n      `Identity: ${Utils.inFraction(\n        hsp.identity,\n        hsp.length\n      )} (${Utils.inPercentage(hsp.identity, hsp.length)}), `,\n    ]);\n\n    // Positives (for protein alignment).\n    if (\n      props.algorithm === \"blastp\" ||\n      props.algorithm === \"blastx\" ||\n      props.algorithm === \"tblastn\" ||\n      props.algorithm === \"tblastx\"\n    ) {\n      line.push(\n        `Positives: ${Utils.inFraction(\n          hsp.positives,\n          hsp.length\n        )} (${Utils.inPercentage(hsp.positives, hsp.length)}), `\n      );\n    }\n\n    // Gaps\n    line.push(\n      `Gaps: ${Utils.inFraction(\n        hsp.gaps,\n        hsp.length\n      )} (${Utils.inPercentage(hsp.gaps, hsp.length)})`\n    );\n\n    // Query coverage\n    //line.push(`Query coverage: ${this.hsp.qcovhsp}%, `)\n\n    switch (props.algorithm) {\n      case \"tblastx\":\n        line.push(\n          `, Frame: ${Utils.inFraction(hsp.qframe, hsp.sframe)}`\n        );\n        break;\n      case \"blastn\":\n        line.push(\n          `, Strand: ${hsp.qframe > 0 ? \"+\" : \"-\"} / ${\n            hsp.sframe > 0 ? \"+\" : \"-\"\n          }`\n        );\n        break;\n      case \"blastx\":\n        line.push(`, Query Frame: ${hsp.qframe}`);\n        break;\n      case \"tblastn\":\n        line.push(`, Hit Frame: ${hsp.sframe}`);\n        break;\n    }\n\n    return line;\n  }\n\n\n  // Width of the coordinate part of hsp lines. Essentially the length of\n  // the largest coordinate.\n  const hspLinesWidth = () => {\n    return _.max(\n      _.map(\n        [hsp.qstart, hsp.qend, hsp.sstart, hsp.send],\n        (n) => {\n          return n.toString().length;\n        }\n      )\n    );\n  }\n\n  /**\n   * Returns array of pre tags containing the three query, middle, and subject\n   * lines that together comprise one 'rendered line' of HSP.\n   */\n  const hspLines = () => {\n    // Space reserved for showing coordinates\n    const width = hspLinesWidth();\n\n    // Number of residues we can draw per line is the total number of\n    // characters we can have in a line minus space required to show left\n    // and right coordinates minus 10 characters reserved for displaying\n    // the words Query, Subject and three blank spaces per line.\n    const adjustedLineWidth = chars - 2 * width - 10;\n\n    // Number of lines of pairwise-alignment (i.e., each line consists of 3\n    // lines). We draw as many pre tags.\n    const lines = Math.ceil(hsp.length / adjustedLineWidth);\n\n    let pp = [];\n    let nqseq = getNqseq();\n    let nsseq = getNsseq();\n    for (let i = 1; i <= lines; i++) {\n      let seq_start_index = adjustedLineWidth * (i - 1);\n      let seq_stop_index = seq_start_index + adjustedLineWidth;\n\n      let lqstart = nqseq;\n      let lqseq = hsp.qseq.slice(seq_start_index, seq_stop_index);\n      let lqend =\n        nqseq +\n        (lqseq.length - lqseq.split(\"-\").length) *\n          qframe_unit() *\n          qframe_sign();\n      nqseq = lqend + qframe_unit() * qframe_sign();\n\n      let lmseq = hsp.midline.slice(seq_start_index, seq_stop_index);\n\n      let lsstart = nsseq;\n      let lsseq = hsp.sseq.slice(seq_start_index, seq_stop_index);\n      let lsend =\n        nsseq +\n        (lsseq.length - lsseq.split(\"-\").length) *\n          sframe_unit() *\n          sframe_sign();\n      nsseq = lsend + sframe_unit() * sframe_sign();\n\n      pp.push(\n        <pre key={hsp.number + \",\" + i} className=\"pre-item m-0 p-0 rounded-none border-0 bg-inherit whitespace-pre-wrap break-keep mt-1 tracking-wider\">\n          <span className=\"text-gray-500\">\n            {`Query   ${formatCoords(lqstart, width)} `}\n          </span>\n          <span>{lqseq}</span>\n          <span className=\"text-gray-500\">{` ${lqend}`}</span>\n          <br />\n          <span className=\"text-gray-500\">\n            {`${formatCoords(\"\", width + 8)} `}\n          </span>\n          <span>{lmseq}</span>\n          <br />\n          <span className=\"text-gray-500\">\n            {`Subject ${formatCoords(lsstart, width)} `}\n          </span>\n          <span>{lsseq}</span>\n          <span className=\"text-gray-500\">{` ${lsend}`}</span>\n          <br />\n        </pre>\n      );\n    }\n\n    return pp;\n  }\n\n\n  // Alignment start coordinate for query sequence.\n  //\n  // This will be qstart or qend depending on the direction in which the\n  // (translated) query sequence aligned.\n  const getNqseq = () => {\n    switch (props.algorithm) {\n      case \"blastp\":\n      case \"blastx\":\n      case \"tblastn\":\n      case \"tblastx\":\n        return hsp.qframe >= 0 ? hsp.qstart : hsp.qend;\n      case \"blastn\":\n        // BLASTN is a bit weird in that, no matter which direction the query\n        // sequence aligned in, qstart is taken as alignment start coordinate\n        // for query.\n        return hsp.qstart;\n    }\n  }\n\n  // Alignment start coordinate for subject sequence.\n  //\n  // This will be sstart or send depending on the direction in which the\n  // (translated) subject sequence aligned.\n  const getNsseq = () => {\n    switch (props.algorithm) {\n      case \"blastp\":\n      case \"blastx\":\n      case \"tblastn\":\n      case \"tblastx\":\n        return hsp.sframe >= 0 ? hsp.sstart : hsp.send;\n      case \"blastn\":\n        // BLASTN is a bit weird in that, no matter which direction the\n        // subject sequence aligned in, sstart is taken as alignment\n        // start coordinate for subject.\n        return hsp.sstart;\n    }\n  }\n\n  // Jump in query coordinate.\n  //\n  // Roughly,\n  //\n  //   qend = qstart + n * qframe_unit\n  //\n  // This will be 1 or 3 depending on whether the query sequence was\n  // translated or not.\n  const qframe_unit = () => {\n    switch (props.algorithm) {\n      case \"blastp\":\n      case \"blastn\":\n      case \"tblastn\":\n        return 1;\n      case \"blastx\":\n      // _Translated_ nucleotide query against protein database.\n      case \"tblastx\":\n        // _Translated_ nucleotide query against translated\n        // nucleotide database.\n        return 3;\n    }\n  }\n\n  // Jump in subject coordinate.\n  //\n  // Roughly,\n  //\n  //   send = sstart + n * sframe_unit\n  //\n  // This will be 1 or 3 depending on whether the subject sequence was\n  // translated or not.\n  const sframe_unit = () => {\n    switch (props.algorithm) {\n      case \"blastp\":\n      case \"blastx\":\n      case \"blastn\":\n        return 1;\n      case \"tblastn\":\n        // Protein query against _translated_ nucleotide database.\n        return 3;\n      case \"tblastx\":\n        // Translated nucleotide query against _translated_\n        // nucleotide database.\n        return 3;\n    }\n  }\n\n  // If we should add or subtract qframe_unit from qstart to arrive at qend.\n  //\n  // Roughly,\n  //\n  //   qend = qstart + (qframe_sign) * n * qframe_unit\n  //\n  // This will be +1 or -1, depending on the direction in which the\n  // (translated) query sequence aligned.\n  const qframe_sign = () => {\n    return hsp.qframe >= 0 ? 1 : -1;\n  }\n\n  // If we should add or subtract sframe_unit from sstart to arrive at send.\n  //\n  // Roughly,\n  //\n  //   send = sstart + (sframe_sign) * n * sframe_unit\n  //\n  // This will be +1 or -1, depending on the direction in which the\n  // (translated) subject sequence aligned.\n  const sframe_sign = () => {\n    return hsp.sframe >= 0 ? 1 : -1;\n  }\n\n  /**\n   * Pad given coord with ' ' till its length == width. Returns undefined if\n   * width is not supplied.\n   */\n  const formatCoords = (coord, width) => {\n    if (width) {\n      let padding = width - coord.toString().length;\n      return Array(padding + 1)\n        .join(\" \")\n        .concat([coord]);\n    }\n  }\n\n  const spanCoords = (text) => {\n    return <span className=\"text-gray-700\">{text}</span>;\n  }\n\n  return (\n    <div\n      className=\"hsp pt-px pb-5 border-l-2 border-transparent pl-1 -ml-1\"\n      id={domID()}\n      ref={hspRef}\n      data-parent-hit={hitDOM_ID()}\n    >\n      <p className=\"m-0 p-0 rounded-none border-0 bg-inherit whitespace-pre-wrap break-keep text-sm text-neutral-500 font-semibold tracking-wide\">\n        {props.showHSPNumbers &&\n          `${Helpers.toLetters(hsp.number)}. `}\n        {hspStats().map((s, i) => (\n          <span key={i}>{s}</span>\n        ))}\n      </p>\n      {hspLines()}\n    </div>\n  );\n}\n\n// Redraw if window resized.\n// $(window).resize(\n//   _.debounce(function () {\n//     _.each(HSPComponents, (comp) => {\n//       comp.draw();\n//     });\n//   }, 100)\n// );\n","/* eslint-disable no-unused-vars */\nimport { Component } from 'react';\nimport _ from 'underscore';\n\nimport { ReportQuery } from './query';\nimport Hit from './hit';\nimport HSP from './hsp';\nimport AlignmentExporter from './alignment_exporter';\n/* eslint-enable no-unused-vars */\n\nclass Hits extends Component {\n    constructor(props) {\n        super(props);\n        this.numUpdates = 0;\n        this.nextQuery = 0;\n        this.nextHit = 0;\n        this.nextHSP = 0;\n        this.maxHSPs = 10; // max HSPs to render in a cycle\n        this.state = props.state;\n        this.state.pluginResults = [];\n        this.prepareAlignmentOfSelectedHits = this.prepareAlignmentOfSelectedHits.bind(this);\n    }\n\n    componentDidMount() {\n        this.props.plugins.init(this.onPluginResultsFetched.bind(this));\n        this.componentDidUpdate(this.props, this.state);\n    }\n\n    onPluginResultsFetched(pluginResults) {\n        this.setState({ pluginResults: pluginResults });\n    }\n\n    replacePluginResults(pluginResults) {\n        if (!pluginResults) return;\n\n        const updatedResults = this.props.plugins.replacePluginResults(this.state.results, pluginResults);\n        this.setState({ results: updatedResults, pluginResults: pluginResults });\n    }\n\n    /**\n    * Called for the first time after as BLAST results have been retrieved from\n    * the server and added to this.state by fetchResults. Only summary overview\n    * and circos would have been rendered at this point. At this stage we kick\n    * start iteratively adding 1 HSP to the page every 25 milli-seconds.\n    */\n    componentDidUpdate(_prevProps, prevState) {\n        // Log to console how long the last update take?\n        // console.log((Date.now() - this.lastTimeStamp) / 1000);\n\n        // Queue next update if we have not rendered all results yet.\n        if (this.nextQuery < this.state.queries.length) {\n            // setTimeout is used to clear call stack and space out\n            // the updates giving the browser a chance to respond\n            // to user interactions.\n            setTimeout(() => this.updateState(), 25);\n        } else {\n            this.props.componentFinishedUpdating();\n        }\n\n        if (this.state.pluginResults.length > 0 && prevState.pluginResults.length == 0) {\n            this.replacePluginResults(this.state.pluginResults);\n        }\n    }\n\n    isFirstUpdate() {\n        return this.nextQuery == 0 && this.nextHit == 0 && this.nextHSP == 0;\n    }\n\n    /* eslint complexity: [\"error\", 6] */\n    /* ---------------------\n    * Push next slice of results to React for rendering.\n    */\n    updateState() {\n        var results = { items: [], numHSPsProcessed: 0 };\n        this.processQueries(results);\n\n        // Push the components to react for rendering.\n        this.numUpdates++;\n        this.lastTimeStamp = Date.now();\n        this.setState({\n            results: this.state.results.concat(results.items),\n            veryBig: this.numUpdates >= 250,\n        });\n    }\n\n    processQueries(results) {\n        while (this.nextQuery < this.state.queries.length) {\n            var query = this.state.queries[this.nextQuery];\n\n            // We may see a query multiple times during rendering because only\n            // 10 hsps are rendered in each cycle, but we want to create the\n            // corresponding Query component only the first time we see it.\n            if (this.nextHit == 0 && this.nextHSP == 0) {\n                results.items.push(this.renderReportQuery(query));\n                results.items.push(this.props.plugins.queryResult(query, this.state.pluginResults));\n            }\n\n            this.processHits(results, query);\n            this.iterateLoops(['nextQuery', 'nextHit'], query.hits.length);\n            if (results.numHSPsProcessed == this.maxHSPs) break;\n        }\n    }\n\n    processHits(results, query) {\n        while (this.nextHit < query.hits.length) {\n            var hit = query.hits[this.nextHit];\n            // We may see a hit multiple times during rendering because only\n            // 3 hsps are rendered in each cycle, but we want to create the\n            // corresponding Hit component only the first time we see it.\n            if (this.nextHSP == 0) results.items.push(this.renderHit(query, hit));\n\n            this.processHSPS(results, query, hit);\n            this.iterateLoops(['nextHit', 'nextHSP'], hit.hsps.length);\n            if (results.numHSPsProcessed == this.maxHSPs) break;\n        }\n    }\n\n    processHSPS(results, query, hit) {\n        while (this.nextHSP < hit.hsps.length) {\n            // Get nextHSP and increment the counter.\n            var hsp = hit.hsps[this.nextHSP++];\n            results.items.push(\n                this.renderHsp(query, hit, hsp)\n            );\n            results.numHSPsProcessed++;\n            if (results.numHSPsProcessed == this.maxHSPs) break;\n        }\n    }\n\n    /*\n    *  this function check if 2nd argument is reach end of it\n    */\n    iterateLoops(args, length) {\n        if (this[args[1]] != length) return;\n\n        this[args[0]]++;\n        this[args[1]] = 0;\n    }\n\n    renderHsp(query, hit, hsp) {\n        return (\n            <HSP\n                key={\n                    'Query_' +\n                        query.number +\n                        '_Hit_' +\n                        hit.number +\n                        '_HSP_' +\n                        hsp.number\n                }\n                query={query}\n                hit={hit}\n                hsp={hsp}\n                algorithm={this.state.program}\n                showHSPNumbers={hit.hsps.length > 1}\n                {...this.props}\n            />\n        );\n    }\n\n    renderHit(query, hit) {\n        return (\n            <Hit\n                key={'Query_' + query.number + '_Hit_' + hit.number}\n                query={query}\n                hit={hit}\n                algorithm={this.state.program}\n                querydb={this.state.querydb}\n                selectHit={this.selectHit}\n                imported_xml={this.state.imported_xml}\n                non_parse_seqids={this.state.non_parse_seqids}\n                showQueryCrumbs={this.state.queries.length > 1}\n                showHitCrumbs={query.hits.length > 1}\n                veryBig={this.state.veryBig}\n                onChange={this.prepareAlignmentOfSelectedHits}\n                {...this.props}\n            />\n        );\n    }\n\n    renderReportQuery(query) {\n        return (\n            <ReportQuery\n                key={'Query_' + query.id}\n                query={query}\n                program={this.state.program}\n                querydb={this.state.querydb}\n                showQueryCrumbs={this.state.queries.length > 1}\n                non_parse_seqids={this.state.non_parse_seqids}\n                imported_xml={this.state.imported_xml}\n                veryBig={this.state.veryBig}\n            />\n        );\n    }\n\n    /* eslint complexity: [\"error\", 6] */\n    /* -----------------------------------\n    * Event-handler when hit is selected\n    * Adds border-seqorange to hit component.\n    * Updates number of Fasta that can be downloaded\n    */\n    selectHit(id) {\n        var checkbox = $('#' + id);\n        var num_checked = $('.hit-links :checkbox:checked').length;\n\n        if (!checkbox || !checkbox.val()) return;\n\n        var $hit = $(checkbox.data('target'));\n\n        // Highlight selected hit and enable 'Download FASTA/Alignment of\n        // selected' links.\n        if (checkbox.is(':checked')) {\n            $hit.addClass('border-seqorange');\n            $hit.next('.hsp').addClass('border-seqorange');\n            $hit.removeClass('border-transparent');\n            $hit.next('.hsp').removeClass('border-transparent');\n            $('.download-fasta-of-selected').enable();\n            $('.download-alignment-of-selected').enable();\n        } else {\n            $hit.removeClass('border-seqorange');\n            $hit.next('.hsp').removeClass('border-seqorange');\n            $hit.addClass('border-transparent');\n            $hit.next('.hsp').addClass('border-transparent');\n            $('.download-fasta-of-selected').attr('href', '#').removeAttr('download');\n        }\n\n        var $a = $('.download-fasta-of-selected');\n        var $b = $('.download-alignment-of-selected');\n\n        if (num_checked >= 1) {\n            $a.find('.font-bold').html(num_checked);\n            $b.find('.font-bold').html(num_checked);\n            $a.find('.font-bold').addClass('px-1').removeClass('px-0.5');\n            $b.find('.font-bold').addClass('px-1').removeClass('px-0.5');\n        }\n\n        if (num_checked == 0) {\n            $a.addClass('disabled').find('.font-bold').html('');\n            $b.addClass('disabled').find('.font-bold').html('');\n            $a.find('.font-bold').removeClass('px-1').addClass('px-0.5');\n            $b.find('.font-bold').removeClass('px-1').addClass('px-0.5');\n        }\n    }\n\n    prepareAlignmentOfSelectedHits() {\n        var sequence_ids = $('.hit-links :checkbox:checked').map(function () {\n            return this.value;\n        }).get();\n\n        if(!sequence_ids.length){\n            // remove attributes from link if sequence_ids array is empty\n            $('.download-alignment-of-selected').attr('href', '#').removeAttr('download');\n            return;\n\n        }\n        if(this.state.alignment_blob_url){\n            // always revoke existing url if any because this method will always create a new url\n            window.URL.revokeObjectURL(this.state.alignment_blob_url);\n        }\n        var hsps_arr = [];\n        var aln_exporter = new AlignmentExporter();\n        const self = this;\n        _.each(this.state.queries, _.bind(function (query) {\n            _.each(query.hits, function (hit) {\n                if (_.indexOf(sequence_ids, hit.id) != -1) {\n                    hsps_arr = hsps_arr.concat(self.props.populate_hsp_array(hit, query.id));\n                }\n            });\n        }, this));\n        const filename = 'alignment-' + sequence_ids.length + '_hits.txt';\n        const blob_url = aln_exporter.prepare_alignments_for_export(hsps_arr, filename);\n        // set required download attributes for link\n        $('.download-alignment-of-selected').attr('href', blob_url).attr('download', filename);\n        // track new url for future removal\n        this.setState({alignment_blob_url: blob_url});\n    }\n\n    render() {\n        return this.state.results;\n    }\n}\n\nexport default Hits;\n","import ReportHeader from './report_header';\nimport Hits from '../../hits';\n\nconst AlignmentResults = (props) => {\n    const renderContent = () => (\n        <div>\n            {props.state.results}\n            <Hits\n                {...props}\n                componentFinishedUpdating={(_) => props.componentFinishedUpdating(_)}\n            />\n        </div>\n    );\n\n    return <ReportHeader name=\"Alignment Results\" renderContent={renderContent} />;\n};\n\nexport default AlignmentResults;\n","export default function asMailtoHref(querydb, program, numQueries, url, isOpenAccess) {\n    const dbsArr = formatDatabases(querydb);\n    const mailto = composeEmail(dbsArr, program, numQueries, url, isOpenAccess);\n    return encodeEmail(mailto);\n}\n\nfunction formatDatabases(querydb) {\n    return querydb ? querydb.slice(0, 15).map(db => ' ' + db.title) : \"\";\n}\n\nfunction composeEmail(dbsArr, program, numQueries, url, isOpenAccess) {\n    const upperProgram = program.toUpperCase();\n    const accessStatement = isOpenAccess ? '' : 'The link will work if you have access to that particular SequenceServer instance.';\n\n    return `mailto:?subject=SequenceServer ${upperProgram} analysis results &body=Hello,\n\n        Here is a link to my recent ${upperProgram} analysis of ${numQueries} sequences.\n            ${url}\n\n        The following databases were used (up to 15 are shown):\n            ${dbsArr}\n\n        ${accessStatement}\n\n        Thank you for using SequenceServer, and please remember to cite our paper.\n\n        Best regards,\n\n        https://sequenceserver.com`;\n}\n\nfunction encodeEmail(mailto) {\n    return encodeURI(mailto).replace(/(%20){2,}/g, '');\n}\n","import { useState } from 'react';\nimport asMailtoHref from './mailto';\n\nconst ShareURLComponent = ({ querydb, program, queryLength, url }) => {\n    const [copied, setCopied] = useState(false);\n\n    const copyToClipboard = () => {\n        navigator.clipboard.writeText(url);\n        setCopied(true);\n    };\n\n    return (\n        <div className=\"px-6 share-url-component\">\n            <input className=\"w-full mb-3 pt-3\" name=\"shareableUrl\" type=\"text\" value={url} readOnly />\n            <div className=\"py-4 flex justify-between items-center\">\n                <button className=\"py-2 px-3 border border-transparent rounded-md shadow-sm text-white bg-seqblue hover:bg-seqorange focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-seqorange\" onClick={copyToClipboard}>{copied ? 'Copied!' : 'Copy to Clipboard'}</button>\n                <a href={asMailtoHref(querydb, program, queryLength, url, true)}>Share via email</a>\n            </div>\n        </div>\n    );\n};\n\nexport default ShareURLComponent;\n","import React, { createRef } from \"react\";\nimport ShareURLComponent from \"./share_url\";\nimport _ from \"underscore\";\n\n/**\n * Takes sequence accession as props, fetches the sequence from the server, and\n * displays it in a modal.\n */\nexport default class CloudShareModal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      formState: 'input', // Possible values: 'input', 'loading', 'results', 'error'\n      errorMessages: [],\n      email: '',\n      agreeToTos: false,\n      shareableurl: '',\n      isModalVisible: false,\n    };\n    this.modalRef = createRef();\n  }\n\n  // Lifecycle methods. //\n\n  handleChange = (e) => {\n    const { name, value, type, checked } = e.target;\n    const inputValue = type === 'checkbox' ? checked : value;\n\n    this.setState({ [name]: inputValue });\n  }\n\n  handleSubmit = async (e) => {\n    e.preventDefault();\n\n    const { email } = this.state;\n    const jobId = this.getJobIdFromPath();\n\n    this.setState({ formState: 'loading' });\n\n    const requestData = {\n      job_id: jobId,\n      sender_email: email\n    };\n\n    try {\n      const response = await fetch('/cloud_share', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(requestData)\n      });\n\n      if (!response.ok) {\n        throw new Error('Network response was not ok');\n      }\n\n      const data = await response.json();\n\n      if (data.shareable_url) {\n        this.setState({ formState: 'results', shareableurl: data.shareable_url });\n      } else if (data.errors) {\n        this.setState({ formState: 'error', errorMessages: data.errors });\n      } else {\n        throw new Error('Unknown error submitting form');\n      }\n    } catch (error) {\n      this.setState({\n        formState: 'error',\n        errorMessages: [error.message]\n      });\n    }\n  }\n\n  getJobIdFromPath = () => {\n    const regex = /\\/([^/]+)(?:\\/|#|\\?|$)/;\n    const match = window.location.pathname.match(regex);\n    return match ? match[1] : match;\n  }\n\n  show = () => {\n    this.modalRef.current?.showModal();\n  }\n\n  hide = () => {\n    this.modalRef.current?.close();\n  }\n\n  renderLoading() {\n    return (\n      <div className=\"text-center pt-3\">\n        <i className=\"fa fa-spinner fa-3x fa-spin\"></i>\n        <p className=\"my-3\">Uploading the job to SequenceServer Cloud, please wait...</p>\n      </div>\n    );\n  }\n\n  renderResults() {\n    const { shareableurl } = this.state;\n\n    return <ShareURLComponent url={shareableurl} querydb={this.props.querydb} program={this.props.program} queryLength={this.props.queryLength} />;\n  }\n\n  renderError() {\n    const { errorMessages } = this.state;\n\n    return (\n      <>\n        {\n          errorMessages.map((errorMessage, index) => (\n            <div key={`fastan-${index}`} className=\"fastan\">\n              <div className=\"pt-0 px-0 pb-px\">\n                <div className=\"text-danger text-lg border border-danger p-2 my-2\">{errorMessage}</div>\n              </div>\n            </div>\n          ))\n        }\n        {this.renderForm()}\n      </>\n    );\n  }\n\n  renderForm() {\n    const { email, agreeToTos } = this.state;\n    const isSubmitDisabled = !agreeToTos;\n\n    return(\n      <form onSubmit={this.handleSubmit}>\n        <div className=\"px-6 py-4 text-sm\">\n          <label htmlFor=\"emailInput\" className=\"text-seqblue hover:text-orange cursor-pointer mb-0\">Your Email Address</label>\n          <input\n            type=\"email\"\n            id=\"emailInput\"\n            className=\"block w-full rounded-md border-0 py-1.5 px-3 mb-3 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-seqblue sm:text-sm sm:leading-6\"\n            placeholder=\"person@example.com\"\n            name=\"email\"\n            value={email}\n            required=\"required\"\n            onChange={this.handleChange}\n          />\n          <p className=\"mb-3\">\n            By submitting this form you agree to upload this SequenceServer result set to <a href=\"https://sequenceserver.com/cloud/\" target=\"_bank\" className=\"text-seqblue hover:text-seqorange\">SenquenceServer Cloud</a>\n            , where it will become available on the internet to everyone with the link. You also agree that your email address will be stored on SequenceServer databases as proof of authentication for support and similar purposes.\n          </p>\n          <div className=\"form-check\">\n            <input\n              type=\"checkbox\"\n              id=\"tosCheckbox\"\n              className=\"form-check-input\"\n              name=\"agreeToTos\"\n              checked={agreeToTos}\n              onChange={this.handleChange}\n            />\n            <label htmlFor=\"tosCheckbox\" className=\"pl-2\">\n              &nbsp;I agree to the <b><a href=\"https://sequenceserver.com/cloud/terms_and_conditions\" target=\"_blank\" className=\"text-seqblue hover:text-seqorange\">Terms and Conditions of Service</a></b>\n            </label>\n          </div>\n        </div>\n        <div className=\"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6\">\n          <button\n              type=\"submit\"\n              style={{ backgroundColor: isSubmitDisabled ? '#C74F13' : '#1B557A' }}\n              className='border-seqblue py-2 px-3 rounded-md text-white'\n              disabled={isSubmitDisabled}\n          >\n              Submit\n          </button>\n        </div>\n      </form>\n    )\n  }\n\n  render() {\n    const { formState, isModalVisible } = this.state;\n\n    let content;\n    switch (formState) {\n      case 'loading':\n        content = this.renderLoading();\n        break;\n      case 'results':\n        content = this.renderResults();\n        break;\n      case 'error':\n        content = this.renderError();\n        break;\n      case 'input':\n      default:\n        content = this.renderForm();\n        break;\n    }\n\n    return (\n      <div className=\"relative\">\n        <dialog ref={this.modalRef} className=\"fixed p-4 w-full max-w-2xl bg-transparent focus:outline-none\">\n          <div className=\"relative flex flex-col rounded-lg bg-white shadow\">\n            <div className=\"flex items-start justify-between rounded-t border-b p-5\">\n              <h3 className=\"text-xl font-medium text-gray-900\">\n                Share to SequenceServer Cloud\n              </h3>\n              <button className=\"ml-auto inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200\" onClick={this.hide}>\n                <i className=\"fa-solid fa-xmark hover:text-black\"></i>\n              </button>\n            </div>\n            <div className=\"dialog-content\">\n              {content}\n            </div>\n          </div>\n        </dialog>\n      </div>\n    );\n  }\n}\n","import React from 'react';\n\nclass DownloadLinks extends React.Component{\n    render () {}\n}\n\nexport default DownloadLinks;","import React, { Component } from 'react';\nimport _ from 'underscore';\n\nimport downloadFASTA from '../../download_fasta';\nimport asMailtoHref from '../..//mailto';\nimport CloudShareModal from '../../cloud_share_modal';\nimport DownloadLinks from 'download_links';\n/**\n * checks whether code is being run by jest\n */\n// eslint-disable-next-line no-undef\nconst isTestMode = () => process.env.JEST_WORKER_ID !== undefined || process.env.NODE_ENV === 'test';\n/**\n * Renders links for downloading hit information in different formats.\n * Renders links for navigating to each query.\n */\nexport default class extends Component {\n\n    constructor(props) {\n        super(props);\n        this.downloadFastaOfAll = this.downloadFastaOfAll.bind(this);\n        this.downloadFastaOfSelected = this.downloadFastaOfSelected.bind(this);\n        this.topPanelJSX = this.topPanelJSX.bind(this);\n        this.summaryString = this.summaryString.bind(this);\n        this.indexJSX = this.indexJSX.bind(this);\n        this.downloadsPanelJSX = this.downloadsPanelJSX.bind(this);\n        this.handleQueryIndexChange = this.handleQueryIndexChange.bind(this);\n        this.isElementInViewPort = this.isElementInViewPort.bind(this);\n        this.setVisibleQueryIndex = this.setVisibleQueryIndex.bind(this);\n        this.debounceScrolling = this.debounceScrolling.bind(this);\n        this.scrollListener = this.scrollListener.bind(this);\n        this.copyURL = this.copyURL.bind(this);\n        this.shareCloudInit = this.shareCloudInit.bind(this);\n        this.sharingPanelJSX = this.sharingPanelJSX.bind(this);\n        this.cloudShareModal = React.createRef();\n        this.timeout = null;\n        this.queryElems = [];\n        this.state = {\n            queryIndex: 1\n        };\n    }\n\n    componentDidMount() {\n        //keep track of the current queryIndex so it doesn't get lost on page reload\n        const urlMatch = window.location.href.match(/#Query_(\\d+)/);\n        if (urlMatch && urlMatch.length > 1) {\n            const queryNumber = +urlMatch[1];\n            const index = this.props.data.queries.findIndex(query => query.number === queryNumber);\n            this.setState({ queryIndex: index + 1 });\n        }\n        window.addEventListener('scroll', this.scrollListener);\n        $('a[href^=\"#Query_\"]').on('click', this.animateAnchorElements);\n    }\n    componentWillUnmount() {\n        window.removeEventListener('scroll', this.scrollListener);\n    }\n    componentDidUpdate(prevProps) {\n        if (this.props.allQueriesLoaded && !prevProps.allQueriesLoaded) {\n            /**\n             * storing all query elements in this variable once they all become available so we don't have to fetch them all over again\n             */\n            this.queryElems = Array.from(document.querySelectorAll('.resultn'));\n        }\n    }\n\n\n    /**\n     * to avoid unnecessary computations, we debounce the scroll listener so it only fires after user has stopped scrolling for some milliseconds\n     */\n    scrollListener() {\n        this.debounceScrolling(this.setVisibleQueryIndex, 500);\n    }\n\n    debounceScrolling(callback, timer) {\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n        }\n        this.timeout = setTimeout(callback, timer);\n    }\n\n    /**\n     * This method makes the page aware of what query is visible so that clicking previous / next button at any point\n     * navigates to the proper query\n     */\n    setVisibleQueryIndex() {\n        const queryElems = this.queryElems.length ? this.queryElems : Array.from(document.querySelectorAll('.resultn'));\n        const hits = Array.from(document.querySelectorAll('.hit[id^=Query_]'));\n        // get the first visible element and marks it as the current query\n        const topmostEl = queryElems.find(this.isElementInViewPort) || hits.find(this.isElementInViewPort);\n        if (topmostEl) {\n            const queryIndex = Number(topmostEl.id.match(/Query_(\\d+)/)[1]);\n            let hash = `#Query_${queryIndex}`;\n            // if we can guarantee that the browser can handle change in url hash without the page jumping,\n            // then we update the url hash after scroll. else, hash is only updated on click of next or prev button\n            if (window.history.pushState) {\n                window.history.pushState(null, null, hash);\n            }\n            this.setState({ queryIndex });\n        }\n    }\n    animateAnchorElements(e) {\n        // allow normal behavior in test mode to prevent warnings or errors from jquery\n        if (isTestMode()) return;\n        e.preventDefault();\n        $('html, body').animate({\n            scrollTop: $(this.hash).offset().top\n        }, 300);\n        if (window.history.pushState) {\n            window.history.pushState(null, null, this.hash);\n        } else {\n            window.location.hash = this.hash;\n        }\n    }\n    isElementInViewPort(elem) {\n        const { top, left, right, bottom } = elem.getBoundingClientRect();\n        return (\n            top >= 0 &&\n            left >= 0 &&\n            bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n            right <= (window.innerWidth || document.documentElement.clientWidth)\n        );\n    }\n    /**\n         * Clear sessionStorage - useful to initiate a new search in the same tab.\n         * Passing sessionStorage.clear directly as onclick callback didn't work\n         * (on macOS Chrome).\n        */\n    clearSession() {\n        sessionStorage.clear();\n    }\n    /**\n     *\n     * handle next and previous query button clicks\n     */\n    handleQueryIndexChange(nextQuery) {\n        if (nextQuery < 1 || nextQuery > this.props.data.queries.length) return;\n        const anchorEl = document.createElement('a');\n        //indexing at [nextQuery - 1] because array is 0-indexed\n        anchorEl.setAttribute('href', '#Query_' + this.props.data.queries[nextQuery - 1].number);\n        anchorEl.setAttribute('hidden', true);\n        document.body.appendChild(anchorEl);\n        // add smooth scrolling animation with jquery\n        $(anchorEl).on('click', this.animateAnchorElements);\n        anchorEl.click();\n        document.body.removeChild(anchorEl);\n        this.setState({ queryIndex: nextQuery });\n    }\n    /**\n     * Event-handler for downloading fasta of all hits.\n     */\n    downloadFastaOfAll() {\n        var sequence_ids = [];\n        this.props.data.queries.forEach(\n            (query) => query.hits.forEach(\n                (hit) => sequence_ids.push(hit.id)));\n        var database_ids = this.props.data.querydb.map((querydb) => querydb.id);\n        downloadFASTA(sequence_ids, database_ids);\n        return false;\n    }\n\n    /**\n     * Handles downloading fasta of selected hits.\n     */\n    downloadFastaOfSelected() {\n        var sequence_ids = $('.hit-links :checkbox:checked').map(function () {\n            return this.value;\n        }).get();\n        if (sequence_ids.length === 0) {\n            return false;\n        }\n        var database_ids = _.map(this.props.data.querydb, _.iteratee('id'));\n        downloadFASTA(sequence_ids, database_ids);\n        return false;\n    }\n\n    /**\n     * Handles copying the URL into the user's clipboard. Modified from: https://stackoverflow.com/a/49618964/18117380\n     * Hides the 'Copied!' tooltip after 3 seconds\n     */\n\n    copyURL() {\n        const element = document.createElement('input');\n        const url = window.location.href;\n        document.body.appendChild(element);\n        element.value = url;\n        element.select();\n        document.execCommand('copy');\n        document.body.removeChild(element);\n\n        const tooltip = document.getElementById('tooltip');\n        tooltip.classList.remove('hidden');\n\n        setTimeout(() => {\n            tooltip.classList.add('hidden');\n        }, 3000);\n    }\n\n    shareCloudInit() {\n        this.cloudShareModal.current.show();\n    }\n\n    topPanelJSX() {\n        var path = location.pathname.split('/');\n        // Get job id.\n        var job_id = path.pop();\n        // Deriving rootURL this way is required for subURI deployments\n        // - we cannot just send to '/'.\n        var rootURL = path.join('/');\n        return (\n            <div className=\"sidebar-top-panel\">\n                <div className=\"pl-px table mb-0 w-full\">\n                    <h4 className=\"text-sm font-bold mb-0 mt-0.5\">\n                        {this.summaryString()}\n                    </h4>\n                </div>\n                {this.props.data.queries.length > 12 && this.queryIndexButtons()}\n                <div>\n                    <a href={`${rootURL}/?job_id=${job_id}`} className=\"text-sm text-seqblue hover:text-seqorange cursor-pointer\">\n                        <i className=\"fa fa-pencil\"></i> Edit search\n                    </a>\n                    <span className=\"text-seqorange px-1\">|</span>\n                    <a href={`${rootURL}/`}\n                        onClick={this.clearSession} className=\"text-sm text-seqblue hover:text-seqorange cursor-pointer\">\n                        <i className=\"fa-regular fa-file\"></i> New search\n                    </a>\n                </div>\n                {this.props.shouldShowIndex && this.indexJSX()}\n            </div>\n        );\n    }\n\n    summaryString() {\n        var program = this.props.data.program;\n        var numqueries = this.props.data.queries.length;\n        var numquerydb = this.props.data.querydb.length;\n\n        return (\n            program.toUpperCase() + ': ' +\n            numqueries + ' ' + (numqueries > 1 ? 'queries' : 'query') + ', ' +\n            numquerydb + ' ' + (numquerydb > 1 ? 'databases' : 'database')\n        );\n    }\n\n    queryIndexButtons() {\n        const buttonStyle = {\n            outline: 'none', border: 'none', background: 'none'\n        };\n        const buttonClasses = 'text-sm text-seqblue hover:text-seqorange hover:bg-gray-200';\n\n        const handlePreviousBtnClick = () => this.handleQueryIndexChange(this.state.queryIndex - 1);\n        const handleNextBtnClick = () => this.handleQueryIndexChange(this.state.queryIndex + 1);\n\n        // eslint-disable-next-line no-unused-vars\n        const NavButton = ({ text, onClick }) => (\n            <button className={buttonClasses} onClick={onClick} style={buttonStyle}>{text}</button>\n        );\n        return <div style={{ display: 'flex', width: '100%', margin: '7px 0' }}>\n            {this.state.queryIndex > 1 && <NavButton text=\"Previous Query\" onClick={handlePreviousBtnClick} />}\n            {this.state.queryIndex > 1 && this.state.queryIndex < this.props.data.queries.length && <span className=\"text-seqorange px-1\">|</span>}\n            {this.state.queryIndex < this.props.data.queries.length && <NavButton onClick={handleNextBtnClick} text=\"Next Query\" />}\n        </div>;\n    }\n    indexJSX() {\n        return <ul className=\"w-full\"> {\n            _.map(this.props.data.queries, (query) => {\n                return <li key={'Side_bar_' + query.id}>\n                    <a className=\"side-nav text-sm text-seqblue hover:text-seqorange focus:text-seqorange active:text-seqorange cursor-pointer hover-bold line-clamp-1 mb-1.5\"\n                        title={'Query= ' + query.id + ' ' + query.title}\n                        href={'#Query_' + query.number}>\n                        {'Query= ' + query.id}\n                    </a>\n                </li>;\n            })\n        }\n        </ul>;\n    }\n\n    downloadsPanelJSX() {\n        return (\n            <div className=\"downloads\">\n                <div className=\"pl-px table mb-0 w-full\">\n                    <h4 className=\"text-sm font-bold mb-0 mt-2.5\">\n                        Download FASTA, XML, TSV\n                    </h4>\n                </div>\n                <ul>\n                    {\n                        !(this.props.data.imported_xml || this.props.data.non_parse_seqids) && <li className=\"hover:bg-gray-200 mb-1\">\n                            <a\n                                href=\"#\"\n                                className={`text-sm text-seqblue download-fasta-of-all hover:text-seqorange cursor-pointer py-0.5 px-0.5 ${!this.props.atLeastOneHit && 'disabled'}`}\n                                onClick={this.props.atLeastOneHit ? this.downloadFastaOfAll : (e) => e.preventDefault()}>\n                                    FASTA of all hits\n                            </a>\n                        </li>\n                    }\n                    {\n                        !(this.props.data.imported_xml || this.props.data.non_parse_seqids) && <li className=\"mb-1\">\n                            <a\n                                href=\"#\"\n                                className=\"flex text-sm download-fasta-of-selected text-seqblue disabled py-0.5 px-0.5\"\n                                onClick={this.downloadFastaOfSelected}>\n                                FASTA of <span className=\"font-bold px-0.5\"></span> selected hit(s)\n                            </a>\n                        </li>\n                    }\n                    <li className=\"hover:bg-gray-200 mb-1\">\n                        <a href=\"#\" className={`text-sm text-seqblue download-alignment-of-all hover:text-seqorange cursor-pointer py-0.5 px-0.5 ${!this.props.atLeastOneHit && 'disabled'}`}>\n                            Alignment of all hits\n                        </a>\n                    </li>\n                    <li className=\"mb-1\">\n                        <a href=\"#\" className=\"flex text-sm download-alignment-of-selected text-seqblue disabled py-0.5 px-0.5\">\n                            Alignment of <span className=\"font-bold px-0.5\"></span> selected hit(s)\n                        </a>\n                    </li>\n                    {\n                        !this.props.data.imported_xml && <li className=\"hover:bg-gray-200 mb-1\">\n                            <a href={'download/' + this.props.data.search_id + '.std_tsv'}>\n                                <div className=\"relative flex flex-col items-center group\">\n                                    <div className=\"flex items-center w-full\">\n                                        <span className=\"w-full text-sm text-seqblue hover:text-seqorange download cursor-pointer py-0.5 px-0.5\">Standard tabular report</span>\n                                        <div className=\"absolute hidden left-full ml-2 items-center group-hover:flex tooltip-wrap\">\n                                            <div className=\"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px\"></div>\n                                            <span className=\"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md\">\n                                                15 columns: query and subject ID; scientific\n                                                name, alignment length, mismatches, gaps, identity,\n                                                start and end coordinates, e value, bitscore, query\n                                                coverage per subject and per HSP.\n                                            </span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    }\n                    {\n                        !this.props.data.imported_xml && <li className=\"hover:bg-gray-200 mb-1\">\n                            <a href={'download/' + this.props.data.search_id + '.full_tsv'}>\n                                <div className=\"relative flex flex-col items-center group\">\n                                    <div className=\"flex items-center w-full\">\n                                        <span className=\"w-full text-sm text-seqblue hover:text-seqorange download cursor-pointer py-0.5 px-0.5\">Full tabular report</span>\n                                        <div className=\"absolute hidden left-full ml-2 items-center group-hover:flex tooltip-wrap\">\n                                            <div className=\"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px\"></div>\n                                            <span className=\"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md\">\n                                                44 columns: query and subject ID, GI,\n                                                accessions, and length; alignment details;\n                                                taxonomy details of subject sequence(s) and\n                                                query coverage per subject and per HSP.\n                                            </span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    }\n                    {\n                        !this.props.data.imported_xml && <li className=\"hover:bg-gray-200 mb-1\">\n                            <a href={'download/' + this.props.data.search_id + '.xml'}>\n                                <div className=\"relative flex flex-col items-center group\">\n                                    <div className=\"flex items-center w-full\">\n                                        <span className=\"w-full text-sm text-seqblue hover:text-seqorange download cursor-pointer py-0.5 px-0.5\">Full XML report</span>\n                                        <div className=\"absolute hidden left-full ml-2 items-center group-hover:flex tooltip-wrap\">\n                                            <div className=\"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px\"></div>\n                                            <span className=\"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md\">\n                                                Results in XML format.\n                                            </span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    }\n                    {\n                        !this.props.data.imported_xml && <li className=\"hover:bg-gray-200 mb-1\">\n                            <a href={'download/' + this.props.data.search_id + '.pairwise'}>\n                                <div className=\"relative flex flex-col items-center group\">\n                                    <div className=\"flex items-center w-full\">\n                                        <span className=\"w-full text-sm text-seqblue hover:text-seqorange download cursor-pointer py-0.5 px-0.5\">Full Text report</span>\n                                        <div className=\"absolute hidden left-full ml-2 items-center group-hover:flex tooltip-wrap\">\n                                            <div className=\"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px\"></div>\n                                            <span className=\"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md\">\n                                                Results in text format.\n                                            </span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    }\n                    <DownloadLinks imported_xml={this.props.data.imported_xml} search_id={this.props.data.search_id} />\n                </ul>\n            </div>\n        );\n    }\n\n    sharingPanelJSX() {\n        return (\n            <div className=\"sharing-panel\">\n                <div className=\"pl-px table mb-0 w-full\">\n                    <h4 className=\"text-sm font-bold mb-0 mt-2.5\">\n                        Share results\n                    </h4>\n                </div>\n                <ul>\n                    {!this.props.cloudSharingEnabled &&\n                        <li className=\"hover:text-seqorange hover:bg-gray-200\">\n                            <a id=\"copyURL\" className=\"flex text-sm text-seqblue hover:text-seqorange copy-URL cursor-pointer py-0.5 px-0.5 w-full\" onClick={this.copyURL}>\n                                <div className=\"relative flex gap-2 items-center group w-full\">\n                                    <i className=\"fa fa-copy\"></i>\n                                    <div className=\"flex items-center\">\n                                        <span className=\"w-full\">Copy URL to clipboard</span>\n                                        <div id=\"tooltip\" className=\"absolute hidden left-full ml-2 items-center\">\n                                            <div className=\"flex items-center\">\n                                                <div className=\"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px\"></div>\n                                                <span className=\"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md\">\n                                                    Copied!\n                                                </span>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    }\n                    {!this.props.cloudSharingEnabled &&\n                        <li className=\"hover:text-seqorange hover:bg-gray-200\">\n                            <a id=\"sendEmail\" className=\"flex text-sm text-seqblue hover:text-seqorange email-URL cursor-pointer py-0.5 px-0.5 w-full\"\n                                href={asMailtoHref(this.props.data.querydb, this.props.data.program, this.props.data.queries.length, window.location.href)}\n                                target=\"_blank\" rel=\"noopener noreferrer\">\n                                <div className=\"relative flex gap-2 items-center group w-full\">\n                                    <i className=\"fa fa-envelope\"></i>\n                                    <div className=\"flex items-center w-full\">\n                                        <span className=\"w-full\">Send by email</span>\n                                        <div className=\"absolute hidden left-full ml-2 items-center group-hover:flex tooltip-wrap\">\n                                            <div className=\"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px\"></div>\n                                            <span className=\"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md\">\n                                                Send by email\n                                            </span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    }\n                    {this.props.cloudSharingEnabled &&\n                        <li className=\"hover:text-seqorange hover:bg-gray-200\">\n                            <button className=\"flex text-sm text-seqblue hover:text-seqorange cloud-Post cursor-pointer py-0.5 px-0.5 w-full\" onClick={this.shareCloudInit}>\n                                <div className=\"relative flex gap-2 items-center group w-full\">\n                                    <i className=\"fa fa-cloud\"></i>\n                                    <div className=\"flex items-center\">\n                                        <span className=\"w-full\">Share to cloud</span>\n                                        <div className=\"absolute hidden left-full ml-2 items-center group-hover:flex tooltip-wrap\">\n                                            <div className=\"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px\"></div>\n                                            <span className=\"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md\">\n                                                Results in pairwise format\n                                                Upload results to SequenceServer Cloud where it will become accessable\n                                                to everyone who has a link.\n                                            </span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </button>\n                        </li>\n                    }\n                </ul>\n                {\n                    <CloudShareModal\n                        ref={this.cloudShareModal}\n                        querydb={this.props.data.querydb}\n                        program={this.props.data.program}\n                        queryLength={this.props.data.queries.length}\n                    />\n                }\n            </div>\n        );\n    }\n\n    render() {\n        return (\n            <div className=\"sidebar sticky top-0 print:hidden\">\n                {this.topPanelJSX()}\n                {this.downloadsPanelJSX()}\n                {this.sharingPanelJSX()}\n                <div className=\"referral-panel\">\n                    <div className=\"pl-px table mb-0 w-full text-sm\">\n                        <h4 className=\"font-bold mb-0 mt-2.5\">Recommend SequenceServer</h4>\n                        <p><a href=\"https://sequenceserver.com/referral-program\" target=\"_blank\" className=\"text-seqblue hover:text-seqorange\">Earn up to $400 per signup</a></p>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\n","import AlignmentExporter from '../alignment_exporter';\n\nexport const preventCollapseOnSelection = () => {\n    $('body').on('mousedown', '.hit > .section-header > h4', function (event) {\n        var $this = $(this);\n        $this.on('mouseup mousemove', function handler(event) {\n            if (event.type === 'mouseup') {\n                // user wants to toggle\n                var hitID = $this.parents('.hit').attr('id');\n                $(`div[data-parent-hit=${hitID}]`).toggle();\n                $this.find('i').toggleClass('fa-square-minus fa-square-plus');\n                $($this.data('parent-id')).toggleClass('print:hidden');\n            } else {\n                // user wants to select\n                $this.attr('data-toggle', '');\n            }\n            $this.off('mouseup mousemove', handler);\n        });\n    });\n}\n\nexport const setupScrollSpy = ($) => {\n    var sectionIds = $('a.side-nav');\n\n    $(document).scroll(function(){\n        sectionIds.each(function(){\n\n            var container = $(this).attr('href');\n            var containerOffset = $(container).offset().top;\n            var containerHeight = $(container).outerHeight();\n            var containerBottom = containerOffset + containerHeight;\n            var scrollPosition = $(document).scrollTop();\n\n            if(scrollPosition < containerBottom - 20 && scrollPosition >= containerOffset - 20){\n                $(this).addClass('active');\n            } else {\n                $(this).removeClass('active');\n            }\n        });\n    });\n}\n\nexport const populate_hsp_array = (hit, query_id) => {\n    return hit.hsps.map(hsp => Object.assign(hsp, {hit_id: hit.id, query_id}));\n}\n\nexport const prepareAlignmentOfAllHits = (queries) => {\n    console.log('prepareAlignmentOfAllHits', queries);\n    // Get number of hits and array of all hsps.\n    var num_hits = 0;\n    var hsps_arr = [];\n    if(!queries.length){\n        return;\n    }\n    queries.forEach(\n        (query) => query.hits.forEach(\n            (hit) => {\n                num_hits++;\n                hsps_arr = hsps_arr.concat(populate_hsp_array(hit, query.id));\n            }\n        )\n    );\n\n    var aln_exporter = new AlignmentExporter();\n    var file_name = `alignment-${num_hits}_hits.txt`;\n    const blob_url = aln_exporter.prepare_alignments_for_export(hsps_arr, file_name);\n    $('.download-alignment-of-all')\n        .attr('href', blob_url)\n        .attr('download', file_name);\n    return false;\n}\n","import React, { Component } from 'react';\n\nimport LoadingBlast from './report/loading_blast';\nimport WarningBlast from './report/warning_blast';\nimport fetchResults from '../services/fetchResults';\n\nimport ReportPlugins from 'report_plugins';\nimport RunSummary from './report/run_summary';\nimport GraphicalOverview from './report/graphical_overview';\nimport AlignmentResults from './report/alignment_results';\nimport Sidebar from './report/sidebar';\n\nimport {\n    preventCollapseOnSelection,\n    populate_hsp_array,\n    setupScrollSpy,\n    prepareAlignmentOfAllHits\n} from '../utils/report.utils';\n\nconst DEFAULT_STATE = {\n    user_warning: null,\n    eownload_links: [],\n    search_id: '',\n    seqserv_version: '',\n    program: '',\n    program_version: '',\n    submitted_at: '',\n    results: [],\n    queries: [],\n    querydb: [],\n    params: [],\n    stats: [],\n    alignment_blob_url: '',\n    allQueriesLoaded: false,\n    cloud_sharing_enabled: false,\n}\n\nclass Report extends Component {\n    constructor(props) {\n        super(props);\n        this.state = DEFAULT_STATE;\n        this.setStateFromJSON = this.setStateFromJSON.bind(this);\n        this.plugins = new ReportPlugins(this);\n    }\n\n    componentDidMount() {\n        fetchResults(this.setStateFromJSON, this.props.showErrorModal)\n        preventCollapseOnSelection();\n    }\n\n    componentFinishedUpdating() {\n        if (this.state.allQueriesLoaded) return;\n        this.shouldShowIndex() && this.setupScrollSpy();\n        this.setState({ allQueriesLoaded: true });\n    }\n\n    shouldShowIndex() {\n        var num_queries = this.state.queries.length;\n        return num_queries >= 2 && num_queries <= 12;\n    }\n\n    /**\n    * Returns true if we have at least one hit.\n    */\n    atLeastOneHit() {\n        return this.state.queries.some((query) => query.hits.length > 0);\n    }\n\n    /*\n    * Calls setState after any required modification to responseJSON.\n    */\n    setStateFromJSON(responseJSON) {\n        this.lastTimeStamp = Date.now();\n        // the callback prepares the download link for all alignments\n        if (responseJSON.user_warning == 'LARGE_RESULT') {\n            this.setState({user_warning: responseJSON.user_warning, download_links: responseJSON.download_links});\n        } else {\n            console.log('prepareAlignmentOfAllHits', prepareAlignmentOfAllHits);\n            this.setState(responseJSON, () => prepareAlignmentOfAllHits(this.state.queries));\n        }\n    }\n\n    render() {\n        if (this.state.user_warning) {\n            return (<WarningBlast downloadLinks={this.state.download_links} />);\n        } else if (this.state.queries.length >= 1) {\n            return (\n                <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 print:grid-cols-1\" id=\"results\">\n                    <div className=\"hidden md:col-span-1 md:block print:hidden\">\n                        <Sidebar\n                            data={this.state}\n                            atLeastOneHit={this.atLeastOneHit()}\n                            shouldShowIndex={this.shouldShowIndex()}\n                            allQueriesLoaded={this.state.allQueriesLoaded}\n                            cloudSharingEnabled={this.state.cloud_sharing_enabled}\n                        />\n                    </div>\n                    <div className=\"col-span-1 md:col-span-3 print:col-span-1\">\n                        <RunSummary\n                            seqserv_version={this.state.seqserv_version}\n                            program_version={this.state.program_version}\n                            submitted_at={this.state.submitted_at}\n                            querydb={this.state.querydb}\n                            stats={this.state.stats}\n                            params={this.state.params}\n                        />\n                        <GraphicalOverview\n                            queries={this.state.queries}\n                            prorgam={this.state.program}\n                            plugins={this.plugins}\n                        />\n                        <AlignmentResults\n                            state={this.state}\n                            populate_hsp_array={populate_hsp_array}\n                            componentFinishedUpdating={(_) => this.componentFinishedUpdating(_)}\n                            plugins={this.plugins}\n                            {...this.props}\n                        />\n                    </div>\n                </div>\n            );\n        } else {\n            return (<LoadingBlast />);\n        }\n    }\n}\n\nexport default Report;\n","import $ from 'jquery';\nimport 'jquery-ui-dist/jquery-ui';\n\nglobal.$ = $;\n/**\n * Simple, small jQuery extensions for convenience.\n */\n(function ($) {\n    /**\n     * Disable an element.\n     *\n     * Sets `disabled` property to `true` and adds `disabled` class.\n     */\n    $.fn.disable = function () {\n        return this.prop('disabled', true).addClass('disabled');\n    };\n\n    /**\n     * Enable an element.\n     *\n     * Sets `disabled` property to `false` and removes `disabled` class\n     * if present.\n     */\n    $.fn.enable = function () {\n        return this.prop('disabled', false).removeClass('disabled');\n    };\n\n    /**\n     * Check an element.\n     *\n     * Sets `checked` property to `true`.\n     */\n    $.fn.check = function () {\n        return this.prop('checked', true);\n    };\n\n    /**\n     * Un-check an element.\n     *\n     * Sets `checked` property to `false`.\n     */\n    $.fn.uncheck = function () {\n        return this.prop('checked', false);\n    };\n\n    /**\n     * Tooltip\n     */\n    $(document).tooltip({\n        position: {\n            my: 'center bottom-20',\n            at: 'center top',\n            using: function( position, feedback ) {\n                $(this).css(position);\n                $('<div>')\n                    .addClass('arrow')\n                    .addClass(feedback.vertical)\n                    .addClass(feedback.horizontal)\n                    .appendTo(this);\n            }\n        },\n        items: 'rect, .tooltip-item',\n        show: false,\n        hide: false,\n        content: function() {\n            var title = $(this).attr('title');\n            if (!title) return false;\n            var parsedHTML = $.parseHTML(title);\n            return parsedHTML;\n        }\n    });\n\n    /**\n     * Returns true / false if any modal is active.\n     */\n    $.modalActive = function () {\n        var active = false;\n        $('.modal').each(function () {\n            var modal = $(this).data('bs.modal');\n            if (modal) {\n                active = modal.isShown;\n                return !active;\n            }\n        });\n        return active;\n    };\n\n\n    /**\n     * Wiggle an element.\n     *\n     * Used for wiggling BLAST button.\n     */\n    $.fn.wiggle = function () {\n        this.finish().effect('bounce', {\n            direction: 'left',\n            distance: 24,\n            times: 4,\n        }, 250);\n    };\n}(jQuery));\n"],"names":["d3","require","","Math","PI","half","d3_functor","v","d3_source","d","source","d3_target","target","d3_svg_chordRadius","radius","d3_svg_arcStartAngle","startAngle","d3_svg_arcEndAngle","endAngle","circosJS","indexOf","item","i","l","this","length","Object","assign","index","key","TypeError","arguments","prototype","hasOwnProperty","call","conf","Core","tracks","heatmaps","histograms","chords","scatters","lines","stacks","highlights","texts","mixConf","defaultConf","removeTracks","trackIds","id","len","ref","store","svg","trackId","type","select","container","_typeof","remove","layout","data","_layout","Layout","log","level","code","message","levels","console","newConf","value","toString","keys","smartBorders","border","borders","currentBorder","track","trackType","width","defaultTrackWidth","innerRadius","out","outerRadius","push","sort","a","b","module","exports","checkParent","layoutSummary","header","line","checkNumber","isNaN","parseChordData","sample","map","datum","elts","source_id","source_start","source_end","target_id","target_start","target_end","filter","start","max","parseFloat","end","min","hsp","meta","block_nb","gap","k","offset","ref1","size","JSON","parse","stringify","blocks","label","color","getAngle","blockId","unit","block","_size","summary","ref2","_data","chord","Chord","build","_this","Track","parseData","applyRules","rules","results","rule","len1","m","results1","condition","parameter","getSource","getTarget","dimChords","parentElement","selectAll","style","p","resetChords","opacity","renderChords","name","ratio","link","append","attr","colorPalette","enter","s","subgroup","t","result","p0","arc","r","p1","a1","a0","curve","self","f","cos","sin","ribbonV3","_d","on","event","dispatch","usePalette","cmin","cmax","colorPaletteSize","colorPaletteReverse","logScale","render","instance","selection","zIndex","tooltipContent","registerTooltip","loadData","processConf","utils","computeMinMax","values","results2","scope","reverse","fraction","scaleLogBase","x","exp","floor","datumContainer","renderDatumContainer","axes","display","renderAxes","renderDatum","j","mouseover","mouseout","renderBlock","backgrounds","background","direction","axis","minor","spacingType","spacing","major","thickness","theta","position","angle","height","logscale","block_id","y","renderLayout","entry","onClick","cornerRadius","labels","renderLayoutLabels","ticks","renderLayoutTicks","labelArc","radialOffset","text","arc_len","slice","blockTicks","space","arr","temp_scale","scaleLinear","domain","range","labelDenominator","labelSuffix","splice","labelSize","labelColor","ids","renderAll","trackStore","translated","empty","parseInt","labelSpacing","labelDisplay0","labelFont","majorSpacing","onMouseOver","element","trackParams","tip","html","show","hide","_jsx","className","children","_jsxs","process","_ref","_ref$downloadLinks","downloadLinks","href","url","concat","location","pathname","callback","errCallback","path","intervals","parseJSON","str","parsedJson","e","error","poll","fetch","then","response","ok","status","interval","shift","setTimeout","errData","pollPeriodically","search","download_url","filename","node","click","generate_blob_url","blob","window","URL","createObjectURL","download_blob","navigator","msSaveOrOpenBlob","sanitize_filename","san","replace","serialize_svg","cloneNode","insert","textContent","get_styles","removeAttribute","setAttributeNS","xmlns","xlink","XMLSerializer","serializeToString","styles","document","styleSheets","process_ss","ss","cssRules","CSSRule","IMPORT_RULE","styleSheet","selectorText","cssText","handle_click","export_callback","$svg","$","parents","find","$body","Exporter","Blob","canvas","getElementById","img","Image","onload","getContext","drawImage","toDataURL","svgString","encodedSvg","encodeURIComponent","match","String","fromCharCode","src","btoa","alert","CollapsePreferences","component","defaultCollapsed","undefined","_classCallCheck","storageKey","collapseStates","localStorage","getItem","currentlyCollapsed","state","collapsed","setState","setItem","plusIcon","minusIcon","Grapher","Graph","props","alwaysShowName","printing","useDetectPrint","_useState2","_slicedToArray","useState","innerWidth","setWidth","_useState4","setCollapsed","svgContainerRef","createRef","graphLinksJSX","svgContainer","current","draw","graphWidth","dataName","useEffect","handleResize","_","addEventListener","isCollapsed","collapsePreferences","preferenceStoredAsCollapsed","canCollapse","removeEventListener","printCss","cssClasses","toggleCollapse","renderCollapseIcon","top","right","graphId","svgContainerJSX","_props","ReportPlugins","parent","_callback","_query","Histogram","renderable","_objectSpread","renderContent","ReportHeader","seqserv_version","program_version","submitted_at","querydb","db","title","join","stats","nsequences","ncharacters","params","val","get_colors_for_evalue","evalue","hits","rgb","colors","toLetters","num","mod","pow","tick_formatter","scale","seq_type","prefix","suffixes","amino_acid","nucleic_acid","formatted","formatNumberUnits","number","suffix","numericPart","toFixed","rounded","round","get_seq_type","algorithm","blastn","query_seq_type","subject_seq_type","blastp","blastx","tblastx","tblastn","prettify_evalue","matches","split","base","power","format_2_tuple","tuple","inPercentage","den","inFraction","inTwoDecimal","inExponential","parts","toExponential","$svgContainer","queries","forEach","query","Helpers","program","query_arr","hit_arr","layout_arr","chords_arr","hsp_count","denominator","initiate","construct_layout","iterator_for_edits","handle_spacing","create_instance","instance_render","render_error","setupTooltip","max_length","calculate_max_length","complex_layout_edits","num_queries","num_karyotype","num_hits","new_layout","processQuery","item1","clean_id","ori_id","processHit","hit","item2","hsps","processHSP","qstart","qend","sstart","send","obj","delete_from_layout","delete_from_chords","rel_length","count","delete_arr","found","check_id","sum_query_length","sum_hit_length","mid_sum","query_multiplier","hit_multiplier","Circos","chord_layout","instance_layout","paletteSize","layoutHide","css","chordsHide","slen","tlen","selected","stopPropagation","layoutReset","chordsReset","cleaned_id","chordsCheck","chordsClean","layoutClean","alt_tooltip","Utils","identity","positives","gaps","tooltip","my","at","using","feedback","addClass","vertical","horizontal","appendTo","items","content","parseHTML","ratioHSP","legend","ratioCalculate","plugins","atLeastTwoHits","hitNum","some","_Fragment","generateStats","svg_container","$queryDiv","extractData","graphIt","query_hits","_hsps","_hsp","hspEvalue","hspStart","hspEnd","hspFrame","sframe","hspId","hspIdentity","hspGaps","hspPositives","hspLength","hitId","hitDef","hitEvalue","$graphDiv","evt","preventDefault","hash","isInit","opts","totalHits","shownHits","lessButton","moreButton","MIN_HITS_TO_SHOW","countHits","initButtons","setupButtons","diff","options","svg_legend","margin","howMany","inhits","defaults","barHeight","extend","queryLen","q_i","formatter","_tValues","pop","xAxis","tickValues","tickFormat","gradScale","each","yHspline","hsplineColor","parentNode","drawLegend","graphControls","setupClick","$svg_container","_seq_type","query_length","_margin","bottom","left","_width","_height","hit_lengths","define_scale_and_bins","update_data","draw_rectangles","draw_query_line","draw_axes","_scale_x","nice","_bins","thresholds","_scale_y","currentWidth","debounced_draw","resize","includes","data2","bin","inner_data","y0","y1","len_index","x0","dx","x1","_update_data","query_line","x_axis","y_axis","tickSizeOuter","xContainer","ReportQuery","_Component","_callSuper","_inherits","_createClass","queryLength","toLocaleString","showQueryCrumbs","HitsOverview","veryBig","LengthDistribution","HitsTable","imported_xml","domID","headerJSX","numhits","hitsListJSX","noHitsJSX","Component","_Component3","_this2","hasName","sciname","seqwidth","qcovs","total_score","_this3","tableJSX","_zoom_scale_by","_padding_x","_padding_y","_canvas_height","_canvas_width","_results","_query_id","_subject_id","_query_length","_subject_length","_show_numbers","showHSPCrumbs","_maxBitScore","bit_score","svgContainer_d3","_svg","jq","raw","_scales","_create_scales","use_complement_coords","_axis_ticks","_initiate","bindHoverHandler","hover","$g","_groups","_render_graph","text_anchor","dy","orientation","tvalues","_rotate_axis_labels","original_domain","new_domain","zoom_from","scale_by","_is_domain_within_orig","existing_scale","delta","scaled_delta","_polygons","determine_colour","query_x_points","subject_x_points","subject","qframe","point","s1","e1","s2","e2","rect1","rect2","padding","_overlaps","_create_axis","_render_polygons","_render_axes","nearest","smallest_distance","Number","MAX_VALUE","scale_name","scale_height","abs","query_range","subject_range","query_scale","subject_scale","query_height","rgba","matte_rgb","normalize","colour","channel","norm","alpha","_rgba_to_rgb","downloadFASTA","sequence_ids","database_ids","form","addField","querySelector","submit","AlignmentExporter","prepare_alignments_for_export","bind","export_alignments","RegExp","fasta","query_id","qseq","hit_id","midline","sseq","filename_prefix","generate_fasta","_this$get_alignments_","get_alignments_download_metadata","_this$get_alignments_2","HitButtons","_default","accession","sequenceID","hitLength","numHSPs","databaseIDs","showSequenceViewer","viewSequenceLink","downloadAlignment","contentJSX","hitLinks","viewSequenceButton","downloadFASTAButton","hit_buttons","showSequenceModal","sequenceIDs","_event","showHitCrumbs","HSPOverview","btns","non_parse_seqids","downloadAlignmentButton","buttons","button","onChange","selectHit","btn","links","icon","_this4","_this5","disabled","HSP","hspRef","chars","setChars","charWidth","getCharacterWidth","containerWidth","qframe_unit","sframe_unit","qframe_sign","sframe_sign","formatCoords","coord","Array","showHSPNumbers","score","hspStats","n","adjustedLineWidth","ceil","pp","nqseq","getNqseq","nsseq","getNsseq","seq_start_index","seq_stop_index","lqstart","lqseq","lqend","lmseq","lsstart","lsseq","lsend","hspLines","Hits","numUpdates","nextQuery","nextHit","nextHSP","maxHSPs","pluginResults","prepareAlignmentOfSelectedHits","init","onPluginResultsFetched","componentDidUpdate","updatedResults","replacePluginResults","_prevProps","prevState","updateState","componentFinishedUpdating","numHSPsProcessed","processQueries","lastTimeStamp","Date","now","renderReportQuery","queryResult","processHits","iterateLoops","renderHit","processHSPS","renderHsp","args","Hit","checkbox","num_checked","$hit","is","next","removeClass","enable","removeAttr","$a","$b","get","alignment_blob_url","revokeObjectURL","hsps_arr","aln_exporter","populate_hsp_array","blob_url","asMailtoHref","numQueries","isOpenAccess","dbsArr","formatDatabases","mailto","upperProgram","toUpperCase","accessStatement","composeEmail","encodeURI","encodeEmail","copied","setCopied","readOnly","clipboard","writeText","Symbol","iterator","o","toStringTag","c","Generator","u","create","_regeneratorDefine2","G","done","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","enumerable","configurable","writable","_invoke","_OverloadYield","asyncGeneratorStep","Promise","resolve","_defineProperties","_toPropertyKey","_getPrototypeOf","ReferenceError","_assertThisInitialized","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","constructor","apply","Boolean","valueOf","_setPrototypeOf","_defineProperty","toPrimitive","_toPrimitive","CloudShareModal","_React$Component","_e$target","checked","inputValue","_regeneratorRuntime","mark","_callee","email","jobId","requestData","wrap","_context","prev","getJobIdFromPath","formState","job_id","sender_email","method","headers","body","sent","Error","json","shareable_url","shareableurl","errors","errorMessages","t0","stop","_next","_throw","_x","_this$modalRef$curren","modalRef","showModal","_this$modalRef$curren2","close","agreeToTos","isModalVisible","ShareURLComponent","errorMessage","renderForm","_this$state","isSubmitDisabled","onSubmit","handleSubmit","htmlFor","placeholder","required","handleChange","backgroundColor","_this$state2","renderLoading","renderResults","renderError","React","DownloadLinks","downloadFastaOfAll","downloadFastaOfSelected","topPanelJSX","summaryString","indexJSX","downloadsPanelJSX","handleQueryIndexChange","isElementInViewPort","setVisibleQueryIndex","debounceScrolling","scrollListener","copyURL","shareCloudInit","sharingPanelJSX","cloudShareModal","timeout","queryElems","queryIndex","urlMatch","queryNumber","findIndex","animateAnchorElements","prevProps","allQueriesLoaded","from","querySelectorAll","timer","clearTimeout","topmostEl","history","pushState","JEST_WORKER_ID","animate","scrollTop","elem","_elem$getBoundingClie","getBoundingClientRect","innerHeight","documentElement","clientHeight","clientWidth","sessionStorage","clear","anchorEl","createElement","setAttribute","appendChild","removeChild","execCommand","classList","add","rootURL","queryIndexButtons","clearSession","shouldShowIndex","numqueries","numquerydb","buttonStyle","outline","NavButton","atLeastOneHit","search_id","cloudSharingEnabled","rel","prepareAlignmentOfAllHits","file_name","DEFAULT_STATE","user_warning","eownload_links","cloud_sharing_enabled","Report","setStateFromJSON","fetchResults","showErrorModal","$this","handler","hitID","toggle","toggleClass","off","setupScrollSpy","responseJSON","download_links","WarningBlast","Sidebar","RunSummary","GraphicalOverview","prorgam","AlignmentResults","LoadingBlast","global","jQuery","fn","disable","prop","check","uncheck","modalActive","active","modal","isShown","wiggle","finish","effect","distance","times"],"sourceRoot":""}