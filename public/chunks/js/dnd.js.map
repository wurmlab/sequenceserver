{"version":3,"file":"chunks/js/dnd.js","mappings":"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","sources":["webpack://SequenceServer/./public/js/dnd.js"],"sourcesContent":["import React, { Component } from 'react';\n\n/**\n * Drag n drop widget.\n */\nexport class DnD extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = { query: null };\n    }\n\n    componentDidMount() {\n        var self = this;\n        var FASTA_FORMAT = /^>/;\n\n        $(document).ready(function () {\n            var tgtMarker = $('.dnd-overlay');\n\n            var dndError = function (id) {\n                $('.dnd-error').hide();\n                $('#' + id + '-notification').show();\n                tgtMarker.effect('fade', 2500);\n            };\n\n            $(document)\n                .on('dragenter', function (evt) {\n                    // Do not activate DnD if a modal is active.\n                    if ($.modalActive()) return;\n\n                    // Based on http://stackoverflow.com/a/8494918/1205465.\n                    // Contrary to what the above link says, the snippet below can't\n                    // distinguish directories from files. We handle that on drop.\n                    var dt = evt.originalEvent.dataTransfer;\n                    var isFile = dt.types && ((dt.types.indexOf &&  // Chrome and Safari\n                        dt.types.indexOf('Files') != -1) ||\n                        (dt.types.contains && // Firefox\n                            dt.types.contains('application/x-moz-file')));\n\n                    if (!isFile) { return; }\n\n                    $('.dnd-error').hide();\n                    tgtMarker.stop(true, true);\n                    tgtMarker.show();\n                    dt.effectAllowed = 'copy';\n                    if (self.state.query.isEmpty()) {\n                        $('.dnd-overlay-overwrite').hide();\n                        $('.dnd-overlay-drop').show('drop', { direction: 'down' }, 'fast');\n                    }\n                    else {\n                        $('.dnd-overlay-drop').hide();\n                        $('.dnd-overlay-overwrite').show('drop', { direction: 'down' }, 'fast');\n                    }\n                })\n                .on('dragleave', '.dnd-overlay', function (evt) {\n                    tgtMarker.hide();\n                    $('.dnd-overlay-drop').hide();\n                    $('.dnd-overlay-overwrite').hide();\n                })\n                .on('dragover', '.dnd-overlay', function (evt) {\n                    evt.originalEvent.dataTransfer.dropEffect = 'copy';\n                    evt.preventDefault();\n                })\n                .on('drop', '.dnd-overlay', function (evt) {\n                    evt.preventDefault();\n                    evt.stopPropagation();\n\n                    var indicator = $('#sequence-file');\n                    self.state.query.focus();\n\n                    var files = evt.originalEvent.dataTransfer.files;\n                    if (files.length > 1) {\n                        dndError('dnd-multi');\n                        return;\n                    }\n\n                    var file = files[0];\n                    if (file.size > 250 * 1048576) {\n                        dndError('dnd-large-file');\n                        return;\n                    }\n\n                    var reader = new FileReader();\n                    reader.onload = function (e) {\n                        var content = e.target.result;\n                        if (FASTA_FORMAT.test(content)) {\n                            indicator.text(file.name + ' ');\n                            self.state.query.value(content);\n                            tgtMarker.hide();\n                        } else {\n                            // apparently not FASTA\n                            dndError('dnd-format');\n                        }\n                    };\n                    reader.onerror = function (e) {\n                        // Couldn't read. Means dropped stuff wasn't FASTA file.\n                        dndError('dnd-format');\n                    };\n                    reader.readAsText(file);\n                });\n        });\n    }\n\n    render() {\n        return (\n            <div\n                className=\"dnd-overlay absolute left-0 top-0 w-full h-full bg-gray-200 bg-opacity-75 z-40\"\n                style={{ display: 'none' }}>\n                <div className=\"flex flex-col space-y-4 h-full items-center justify-center dnd-overlay-container text-2xl\">\n                    <p\n                        className=\"dnd-overlay-drop flex items-center space-x-4\"\n                        style={{ display: 'none' }}>\n                        <i className=\"fa fa-2x fa-file\"></i>\n                        Drop query sequence file here\n                    </p>\n                    <p\n                        className=\"dnd-overlay-overwrite flex items-center space-x-4\"\n                        style={{ display: 'none' }}>\n                        <i className=\"fa fa-2x fa-file\"></i>\n                        <span className=\"text-red-800\">Overwrite</span>&nbps;query sequence file\n                    </p>\n\n                    <div\n                        className=\"dnd-errors text-red-800\">\n                        <div\n                            className=\"dnd-error row\"\n                            id=\"dnd-multi-notification\"\n                            style={{ display: 'none' }}>\n\n                            One file at a time please.\n                        </div>\n\n                        <div\n                            className=\"dnd-error row\"\n                            id=\"dnd-large-file-notification\"\n                            style={{ display: 'none' }}>\n\n                            Too big a file. Can only do less than 250 MB. &gt;_&lt;\n                        </div>\n\n                        <div\n                            className=\"dnd-error row\"\n                            id=\"dnd-format-notification\"\n                            style={{ display: 'none' }}>\n\n                            Only FASTA files please.\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n"],"names":["DnD","_Component","props","_this","_classCallCheck","_callSuper","state","query","_inherits","key","value","self","this","FASTA_FORMAT","$","document","ready","tgtMarker","dndError","id","hide","show","effect","on","evt","modalActive","dt","originalEvent","dataTransfer","types","indexOf","contains","stop","effectAllowed","isEmpty","direction","dropEffect","preventDefault","stopPropagation","indicator","focus","files","length","file","size","reader","FileReader","onload","e","content","target","result","test","text","name","onerror","readAsText","_jsx","className","style","display","children","_jsxs","Component"],"sourceRoot":""}