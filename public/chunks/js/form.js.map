{"version":3,"file":"chunks/js/form.js","mappings":"goDAMO,IAAMA,EAAY,SAAAC,GACrB,SAAAD,EAAYE,GAAO,IAAAC,E,MAmBkB,O,4FAnBlBC,CAAA,KAAAJ,G,EACfG,EAAAE,EAAA,KAAAL,EAAA,CAAME,I,EAiFiB,WACvBC,EAAKG,UAAS,SAAAC,GAAS,MAAK,CACxBC,iBAAkBD,EAAUC,gBAC/B,GACL,G,MArFiB,+B,wFACbL,EAAKM,MAAQ,CACTC,QAAS,GACTC,UAAU,EACVC,cAAc,EACdJ,iBAAiB,EACjBK,eAAgB,GAChBC,aAAc,GACdC,oBAAoB,GAExBZ,EAAKa,gBAAkBb,EAAKa,gBAAgBC,KAAId,GAChDA,EAAKe,SAAWf,EAAKe,SAASD,KAAId,GAClCA,EAAKgB,wBAA0BhB,EAAKgB,wBAAwBF,KAAId,GAChEA,EAAKiB,sBAAwBjB,EAAKiB,sBAAsBH,KAAId,GAC5DA,EAAKkB,aAAelB,EAAKkB,aAAaJ,KAAId,GAC1CA,EAAKmB,WAAanB,EAAKmB,WAAWL,KAAId,GACtCA,EAAKoB,gBAAkBpB,EAAKoB,gBAAgBN,KAAId,GAChDA,EAAKqB,cAAgBrB,EAAKqB,cAAcP,KAAId,GAC5CA,EAAKsB,eAAgBC,EAAAA,EAAAA,aAAYvB,CACrC,CAAC,O,qRAAAwB,CAAA3B,EAAAC,G,EAAAD,G,EAAA,EAAA4B,IAAA,oBAAAC,MAED,WAAoB,IAAAC,EAAA,KAChBC,KAAKC,QAAUC,YAAW,kBAAMH,EAAKxB,SAAS,CAAES,oBAAoB,GAAM,GAAE,IAChF,GAAC,CAAAa,IAAA,wBAAAC,MAED,SAAsB3B,EAAOO,GACzB,OAAQyB,EAAAA,GAAAA,QAAUzB,EAAMC,QAASqB,KAAKtB,MAAMC,UACxCD,EAAMD,kBAAoBuB,KAAKtB,MAAMD,iBACrCC,EAAMI,iBAAmBkB,KAAKtB,MAAMI,gBACpCJ,EAAMK,eAAiBiB,KAAKtB,MAAMK,cAClCL,EAAMM,qBAAuBgB,KAAKtB,MAAMM,kBAChD,GAAC,CAAAa,IAAA,qBAAAC,MAED,SAAmBM,EAAY5B,GACtB2B,EAAAA,GAAAA,QAAU3B,EAAUG,QAASqB,KAAKtB,MAAMC,WACrCqB,KAAKtB,MAAMC,QAAQ0B,OAAS,GAC5BL,KAAKT,aAAae,SAClBN,KAAK7B,MAAMoC,cAAcP,KAAKtB,MAAMC,QAAQ,KAE5CqB,KAAK7B,MAAMoC,cAAc,IAGrC,GAAC,CAAAV,IAAA,aAAAC,MAED,WACI,OAAOU,EAAER,KAAKN,cAAce,QAChC,GAEA,CAAAZ,IAAA,kBAAAC,MAKA,SAAgBY,GACZ,IAAI/B,EAAUqB,KAAKtB,MAAMC,QAAQgC,QACjChC,EAAQiC,OAAOjC,EAAQkC,QAAQH,GAAS,GACxC/B,EAAQmC,QAAQJ,GAChBV,KAAKzB,SAAS,CACVI,QAASA,EACTF,iBAAiB,GAEzB,GAEA,CAAAoB,IAAA,WAAAC,MAGA,SAASiB,GACL,OAAOA,EACFC,MAAM,mBACNL,MAAM,GACNM,KAAI,SAAUC,EAAOf,GAClB,GAAIe,EACA,MAAc,UAAVA,GACOC,EAAAA,EAAAA,KAAA,UAAAC,SAAqBF,GAARA,GAEbA,CAGnB,GACR,GAAC,CAAArB,IAAA,0BAAAC,MAQD,WACSE,KAAKtB,MAAME,UAAaoB,KAAKtB,MAAMG,aAE7BmB,KAAKtB,MAAME,WAAaoB,KAAKtB,MAAMG,aAC1CmB,KAAKzB,SAAS,CAAEO,eAAgB,8EACxBkB,KAAKtB,MAAME,UAAYoB,KAAKtB,MAAMG,cAC1CmB,KAAKzB,SAAS,CAAEO,eAAgB,uEAJhCkB,KAAKzB,SAAS,CAAEO,eAAgB,uGAMxC,GAAC,CAAAe,IAAA,wBAAAC,MAED,WACI,IAAIuB,EAAQ,sCAEZrB,KAAKzB,SAAS,CAAEQ,aAAcsC,IAE1BrB,KAAKtB,MAAMC,QAAQ0B,OAAS,GAC5BL,KAAKzB,SAAS,CACVQ,aAAcsC,GACV,oFAIhB,GAAC,CAAAxB,IAAA,gBAAAC,MAED,WACIwB,aAAatB,KAAKC,SAClBD,KAAKzB,SAAS,CAAES,oBAAoB,GACxC,GAAC,CAAAa,IAAA,kBAAAC,MAED,WAAkB,IAAAyB,EAAA,KACdvB,KAAKZ,0BACLY,KAAKX,wBACLW,KAAKC,QAAUC,YAAW,kBAAMqB,EAAKhD,SAAS,CAAES,oBAAoB,GAAM,GAAE,IAChF,GAAC,CAAAa,IAAA,eAAAC,MAED,SAAaY,EAAQc,EAAO7C,GACxB,OACI8C,EAAAA,EAAAA,MAAA,OAAKC,UAAU,OAAMN,SAAA,EACjBD,EAAAA,EAAAA,KAAA,UACIQ,KAAK,SACLD,UAAS,GAAAE,OAAKlB,EAAS,+FAAiG,iCAAgC,0IACxJmB,GAAG,SACHd,KAAK,SACLjB,MAAOY,EACPoB,UAAWpB,EAAOU,SAEjBpB,KAAKb,SAASuB,GAAU,WAG5Bc,IACGC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,qBAAoBN,SAAA,EAC/BK,EAAAA,EAAAA,MAAA,UACIC,UAAU,qJACVC,KAAK,SACLI,QAAS/B,KAAKgC,yBAAyBZ,SAAA,EAEvCD,EAAAA,EAAAA,KAAA,KAAGO,UAAU,4CACbP,EAAAA,EAAAA,KAAA,QAAMO,UAAU,UAASN,SAAC,sBAG9BD,EAAAA,EAAAA,KAAA,OAAKU,GAAG,WACJH,UAAS,mIAAAE,OAAqI5B,KAAKtB,MAAMD,gBAAkB,GAAK,UAAW2C,UAC3LD,EAAAA,EAAAA,KAAA,MAAIO,UAAU,gBAAgB,kBAAgB,wBAAuBN,SAChEjB,EAAAA,GAAAA,IACGxB,EAAQgC,MAAM,GACdR,EAAAA,GAAAA,MAAO,SAAUO,GACb,OACIS,EAAAA,EAAAA,KAAA,MAEIY,QAAS5B,EAAAA,GAAAA,MAAO,WACZH,KAAKf,gBAAgByB,EACzB,GAAGV,MAAMoB,UAETD,EAAAA,EAAAA,KAAA,KAAGc,KAAK,IAAIP,UAAU,+CAA8CN,SAAEV,KALjEA,EAQjB,GAAGV,gBAQnC,GAAC,CAAAH,IAAA,SAAAC,MAED,WACI,IAAInB,EAAUqB,KAAKtB,MAAMC,QACrB+B,EAAS/B,EAAQ,GACjB6C,EAAQ7C,EAAQ0B,OAAS,EAE7B,OACIc,EAAAA,EAAAA,KAAA,OACIO,UAAU,0DACVG,GAAG,UACHK,IAAKlC,KAAKN,cACVyC,YAAanC,KAAKR,gBAClB4C,WAAYpC,KAAKP,cAAc2B,UAE/BD,EAAAA,EAAAA,KAAA,OAAKO,UAAU,4CAA2CN,UACtDK,EAAAA,EAAAA,MAAA,OAAKC,UAAU,2BAA0BN,SAAA,CACpCpB,KAAKV,aAAaoB,EAAQc,EAAO7C,IAC/BqB,KAAKtB,MAAMD,kBACVgD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,kFAAiFN,SAAA,EAC5FD,EAAAA,EAAAA,KAAA,OAAKO,UAAU,8HACfP,EAAAA,EAAAA,KAAA,QAAMO,UAAU,yHAAwHN,SACjIpB,KAAKtB,MAAME,UAAaoB,KAAKtB,MAAMG,cAElC4C,EAAAA,EAAAA,MAAAY,EAAAA,SAAA,CAAAjB,SAAA,CAAE,IAAEpB,KAAKtB,MAAMK,gBADfiB,KAAKtB,MAAMM,oBAAsBmC,EAAAA,EAAAA,KAAAkB,EAAAA,SAAA,CAAAjB,SAAGpB,KAAKtB,MAAMK,eAAmBiB,KAAKtB,MAAMI,0BASjH,M,6EAAC,CA7MoB,CAASwD,EAAAA,W,SCN9BC,EAAKC,EAAQ,KAEV,SAASC,EAAaC,EAAKC,GAC9B,IAAIC,EAAIL,EAAGM,OAAO,QAAQC,OAAO,KAChCC,KAAK,WAAYJ,GACjBK,MAAM,UAAW,QACjBD,KAAK,OAAQL,GAEdE,EAAEK,OAAOC,QACThD,YAAW,WACP0C,EAAEO,QACN,GAAG,IACP,CAeO,SAASC,EAAkBC,GAC9B,IAAIC,EAAMD,EAAIE,QAAQ,oBAAqB,KAK3C,OAHAD,EAAMA,EAAIC,QAAQ,SAAU,MAElBA,QAAQ,KAAM,IAAIA,QAAQ,KAAM,GAE9C,C,cCoBIC,EAAgB,SAASC,GAoBzB,OAlBAA,EAAMA,EAAIC,WAAU,GAEpBnB,EAAAA,OAAUkB,GAAKV,KAAK,UAAW,OAC1BY,OAAO,OAAQ,gBACfb,OAAO,SACPC,KAAK,QAAS,gBACdA,KAAK,OAAQ,YACbE,OACAW,YAAcC,IAEnBJ,EAAIK,gBAAgB,SACpBL,EAAIK,gBAAgB,SACpBL,EAAIM,eAAexB,EAAAA,WAAcyB,MAAO,QAASzB,EAAAA,WAAckB,KAC/DA,EAAIM,eAAexB,EAAAA,WAAcyB,MAAO,cAAezB,EAAAA,WAAc0B,OAGvD,2IADA,IAAIC,eAAiBC,kBAAkBV,EAIzD,EAEII,EAAa,WAGb,IAFA,IAAIO,EAAS,GAEJC,EAAI,EAAGA,EAAIC,SAASC,YAAYlE,OAAQgE,KAC7C,SAAUG,EAAWC,GAIjB,IAOI,IAAKA,EAAGC,SACJ,MACR,CAAE,MAAOC,GAEL,GAAe,kBAAXA,EAAE5D,KACF,MAAM4D,EACV,MACJ,CAIA,IAAK,IAAIN,EAAI,EAAGA,EAAII,EAAGC,SAASrE,OAAQgE,IAAK,CACzC,IAAIO,EAAOH,EAAGC,SAASL,GACvB,GAAIO,EAAKjD,OAASkD,QAAQC,YACtBN,EAAWI,EAAKG,gBACb,CAIH,IAAIC,EAAeJ,EAAKI,aACpBA,IAAiD,IAAjCA,EAAanE,QAAQ,SACrCuD,GAAU,KAAOQ,EAAKK,QAC9B,CACJ,CACH,CAnCD,CAmCGX,SAASC,YAAYF,IAG5B,OAAOD,CACX,EAEIc,EAAe,SAAUC,GACzB,OAAO,WACH,IAAIC,EAAO5E,EAAER,MAAMqF,QAAQ,YAAYC,KAAK,OAE5C,OADAH,EAAgBC,EAAK,GAAIA,EAAKrC,KAAK,eAC5B,CACX,CACJ,EAEIwC,EAAQ/E,EAAE,Q,kqBACd+E,EAAMC,GAAG,QAAS,iBAAkBN,GApHhB,SAAUzB,EAAKd,IDI5B,SAAuB8C,EAAM9C,QACiB,IAAtC+C,OAAOC,UAAUC,iBACxBF,OAAOC,UAAUC,iBAAiBH,EAAM9C,GAExCF,EATD,SAA2BgD,GAE9B,OADYC,OAAOG,IAAIC,gBAAgBL,EAE3C,CAMqBM,CAAkBN,GAAO9C,EAE9C,CCPIqD,CAFW,IAAIC,KAAK,CAACzC,EAAcC,IAAO,CAAE9B,KAAM,aAClDgB,EAAWqD,EAA2BrD,GAAY,OAEtD,KAiHA4C,EAAMC,GAAG,QAAS,iBAAkBN,GA5GhB,SAAUzB,EAAKd,GAC/B,QAAiD,IAAtC+C,OAAOC,UAAUC,iBAA5B,CAKA,IAEIM,EAAS5B,SAAS6B,eAAe,gBACjCf,EAAO5E,EAAEiD,GAEbyC,EAAOE,OALmB,EAKVhB,EAAKgB,SACrBF,EAAOG,MANmB,EAMXjB,EAAKiB,QAEpB,IAAIC,EAAM,IAAIC,MACdD,EAAIE,OAAS,WACKN,EAAOO,WAAW,MACxBC,UAAUJ,EAAK,EAAG,EAAGJ,EAAOG,MAAOH,EAAOE,QAElDzD,EAAWqD,EAA2BrD,GAAY,OAClDqD,EAAsBE,EAAOS,UAAU,aAAchE,EACzD,EAEA,IAAIiE,EAAYpD,EAAcC,GAC1BoD,EAAaC,mBAAmBF,GAAWrD,QAAQ,oBAAoB,SAASvC,EAAO+F,GACvF,OAAOC,OAAOC,aAAa,KAAOF,EACtC,IACAT,EAAIY,IAAM,6BAA+BxB,OAAOyB,KAAKN,EAvBrD,MAFIO,MAAM,4FA0Bd,K,ICpDqBC,EAAmB,WAMnC,O,EALD,SAAAA,EAAYC,GAAqC,IAA1BC,EAAgBC,UAAAnH,OAAA,QAAAoH,IAAAD,UAAA,IAAAA,UAAA,I,4FAAQnJ,CAAA,KAAAgJ,GAC3CrH,KAAKsH,UAAYA,EACjBtH,KAAKuH,iBAAmBA,EACxBvH,KAAK0H,WAAa,+BAClB1H,KAAK2H,eAAiBC,KAAKC,MAAMC,aAAaC,QAAQ/H,KAAK0H,cAAgB,CAAC,CAChF,G,EAAC,EAAA7H,IAAA,iBAAAC,MAED,WACI,IAAIkI,EAAqBhI,KAAKsH,UAAU5I,MAAMuJ,UAC9CjI,KAAKsH,UAAU/I,SAAS,CAAE0J,WAAYD,IAEtChI,KAAK2H,eAAe3H,KAAKsH,UAAUvG,OAASiH,EAC5CF,aAAaI,QAAQlI,KAAK0H,WAAYE,KAAKO,UAAUnI,KAAK2H,gBAC9D,GAAC,CAAA9H,IAAA,8BAAAC,MAED,WACI,OAAIE,KAAKsH,UAAUvG,QAAQf,KAAK2H,eACrB3H,KAAK2H,eAAe3H,KAAKsH,UAAUvG,MAEvCf,KAAKuH,gBAChB,GAAC,CAAA1H,IAAA,qBAAAC,MAED,WACI,OAAOE,KAAKsH,UAAU5I,MAAMuJ,UAAYjI,KAAKoI,WAAapI,KAAKqI,WACnE,GAAC,CAAAxI,IAAA,YAAAC,MAED,WACI,OAAOqB,EAAAA,EAAAA,KAAA,KAAGO,UAAU,4CACxB,GAAC,CAAA7B,IAAA,WAAAC,MAED,WACI,OAAOqB,EAAAA,EAAAA,KAAA,KAAGO,UAAU,2CACxB,M,6EAAC,CAjCmC,G,ohCCWzB,SAAS4G,EAAQC,GAC5B,OAAO,SAAmBpK,GACtB,IAAMqK,OAA0Cf,IAAzBc,EAAMC,gBAAuCD,EAAMC,iBACpEC,GAAWC,EAAAA,EAAAA,KACX3H,EAAOwH,EAAMxH,KAAK5C,GAC6BwK,EAAAC,GAA3BC,EAAAA,EAAAA,UAASnD,OAAOoD,YAAW,GAA9CzC,EAAKsC,EAAA,GAAEI,EAAQJ,EAAA,GAC2BK,EAAAJ,GAAfC,EAAAA,EAAAA,WAAS,GAAM,GAA1CZ,EAASe,EAAA,GAAEC,EAAYD,EAAA,GACxBE,GAAkBvJ,EAAAA,EAAAA,aAKlBwJ,EAAgB,WAClB,OACI1H,EAAAA,EAAAA,MAAA,OAAKC,UAAU,kEAAiEN,SAAA,EAC5EK,EAAAA,EAAAA,MAAA,KAAGQ,KAAK,IAAIP,UAAU,kFAAiFN,SAAA,EACnGD,EAAAA,EAAAA,KAAA,KAAGO,UAAU,mBAAmB,WAEpCP,EAAAA,EAAAA,KAAA,QAAMO,UAAU,YAAWN,SAAC,OAC5BK,EAAAA,EAAAA,MAAA,KAAGQ,KAAK,IAAIP,UAAU,kFAAiFN,SAAA,EACnGD,EAAAA,EAAAA,KAAA,KAAGO,UAAU,mBAAmB,YAIhD,EAwCM0H,EAAe,WACjB,OAAO5I,EAAE0I,EAAgBzI,QAC7B,EAEM4I,EAAO,WAAsB,IAC3BC,EAAa,OADC9B,UAAAnH,OAAA,QAAAoH,IAAAD,UAAA,IAAAA,UAAA,KAEJ8B,EAAa,OAE3BF,IAAeG,QAIXtB,IAEJmB,IAAe/C,MAAMiD,GACb,IAAIf,EAAMa,IAAgBjL,GAClCiL,IACK9D,KAAK,OACLvC,KAAK,YAAawF,EAAMiB,SAASrL,IAC1C,GAEAsL,EAAAA,EAAAA,YAAU,WAGN,IAAMC,EAAevJ,EAAAA,GAAAA,UAAW,kBAAM4I,EAASrD,OAAOoD,WAAW,GAAE,KACnEpD,OAAOiE,iBAAiB,SAAUD,GAElC,IAAME,EAAcC,EAAoBC,8BAIxC,OAHAb,EAAaV,EAAMwB,gBAAkB5L,EAAM8J,WAAa2B,IACxDP,IAEO,kBAAM3D,OAAOsE,oBAAoB,SAAUN,EAAa,CACnE,GAAG,KAEHD,EAAAA,EAAAA,YAAU,WACNJ,EAAKZ,EACT,GAAG,CAACA,EAAUpC,IAEd,IAIMwD,EAAsB,IAAIxC,EAAoB,CAACtG,KAAMA,EAAMrC,MAAO,CAAEuJ,UAAWA,GAAa1J,SAJjF,SAACG,GACduK,EAAavK,EAAMuJ,UACvB,IAIA,GAA0B,OAAtBM,EAAMxH,KAAK5C,GACX,OAAO,KAEP,IAAM8L,EAAWhC,EAAY,eAAiB,GACxCiC,EAAa3B,EAAM7G,YAAc,WAAauI,EACpD,OACIxI,EAAAA,EAAAA,MAAA,OAAKC,UAAWwI,EAAW9I,SAAA,CAvF5BmH,EAAMwB,eACEtI,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBN,SAAA,EACxCK,EAAAA,EAAAA,MAAA,MACIC,UAAU,wDACVK,QAAS,WAAF,OAAQ8H,EAAoBM,gBAAgB,EAAC/I,SAAA,CAEnDyI,EAAoBO,sBACrBjJ,EAAAA,EAAAA,KAAA,QAAMO,UAAU,eAAcN,SAAC,MAAcmH,EAAMxH,KAAK5C,OAE1D8J,GAAakB,OAEZX,GACA/G,EAAAA,EAAAA,MAAA,OAAKC,UAAU,2BAA2BsB,MAAO,CAAEqH,SAAU,YAAajJ,SAAA,EAC7EK,EAAAA,EAAAA,MAAA,MAAIC,UAAU,UAASN,SAAA,CAAC,IAAOmH,EAAMxH,KAAK5C,OAC1CgD,EAAAA,EAAAA,KAAA,OAAKO,UAAU,aAAasB,MAAO,CAAEqH,SAAU,WAAYC,IAAK,EAAGC,MAAO,GAAInJ,UACxE6G,GAAakB,UAIhBhI,EAAAA,EAAAA,KAAA,OAAKO,UAAU,QAAON,UACvB6G,GAAakB,MAKH,WACpB,IAAIe,EAAa3B,EAAM7G,YAAc,wBAErC,OADKuG,IAAWiC,GAAc,YAE1B/I,EAAAA,EAAAA,KAAA,OACIe,IAAKgH,EACLrH,GAhDU0G,EAAMiC,QAAQrM,GAiDxBuD,UAAWwI,GAGvB,CAsDaO,KAIjB,CACJ,CClIO,SAASC,EAAsBC,EAAQC,GAC1C,IAWIC,EAXStI,EAAAA,WACRuI,OAAO,CACJvI,EAAAA,IAAO,CAAC,KAAMA,EAAAA,IAAOqI,EAAK3J,KAAI,SAAU8J,GACpC,GAA6B,IAAzBC,WAAWD,EAAEJ,QACjB,OAAOI,EAAEJ,MACb,OACApI,EAAAA,IAAOqI,EAAK3J,KAAI,SAAU8J,GACtB,OAAOA,EAAEJ,MACb,OAEHM,MAAM,CAAC,EAAE,IACJC,CAAOP,GACjB,OAAOpI,EAAAA,IAAO,GAAI,IAAOsI,EAC7B,CAkCO,SAASM,EAAkBC,GAC9B,IAAMC,EAASD,EAAO7H,QAAQ,UAAW,IACnC+H,EAAcN,WAAWI,GAAQG,QAAQ,GAEzCC,EAAUC,KAAKC,MAAoB,GAAdJ,GAAoB,GAE/C,MAAO,GAAP1J,OAAU4J,EAAU,GAAM,EAAIA,EAAQD,QAAQ,GAAKC,EAAO,KAAA5J,OAAIyJ,EAClE,CA4BO,SAASM,EAAgBhB,GAC5B,IAAIiB,EAAUjB,EAAOkB,WAAWC,MAAM,KAClCC,EAAQH,EAAQ,GAChBI,EAAQJ,EAAQ,GAEpB,OAAII,EAGc,SADNhB,WAAWe,GAAMR,QAAQ,GACR,mBAAmBS,EAAM,gBAI5CD,EAAO,GAAG,EACLf,WAAWe,GAAMR,QAAQ,GAEzBQ,CAEnB,CCpCA,QAnDkB,SAAUE,EAAKC,GACzB,IAAIC,GAAW,IAANF,EAAcC,GAAKX,QAAQ,GACpC,OAAIY,EAAI,GAAK,GACTA,EAAIC,SAASD,EAAG,IACT,GAAPvK,OAAUuK,EAAC,MAGJ,GAAPvK,OAAUuK,EAAC,IAEnB,E,grBCwWe7D,EA1XR,WA0BN,O,EALD,SAAAC,EAAY8D,EAAelO,I,4FAAOE,CAAA,KAAAkK,GAC9BvI,KAAKsM,cAAgBD,EACrB,IAAIE,EAAYF,EAAchH,QAAQ,YAClCuF,EAAO5K,KAAKwM,YAAYrO,EAAMsO,MAAM7B,KAAMzM,EAAMsO,MAAMrB,QAC1DpL,KAAK0M,QAAQH,EAAWF,EAAe,EAAG,GAAI,KAAMzB,EACxD,E,EAAC,EAAA/K,IAAA,cAAAC,MAED,SAAY6M,EAAYvB,GACpB,IAAIR,EAAO,GAsBX,OArBA+B,EAAW1L,KAAI,SAAU2L,GACrB,IAAIC,EAAQ,GACRC,EAAOF,EAAIE,KACf3M,EAAAA,GAAAA,KAAO2M,GAAM,SAAUC,GACnB,IAAIC,EAAO,CAAC,EACZA,EAAKC,UAAYF,EAAIpC,OACrBqC,EAAKE,SAAWH,EAAII,OACpBH,EAAKI,OAASL,EAAIM,KAClBL,EAAKM,SAAWP,EAAIQ,OACpBP,EAAKQ,MAAQ,SAAWpC,EAAS,QAAUwB,EAAIxB,OAAS,QAAU2B,EAAI3B,OACtE4B,EAAKS,YAAcV,EAAIW,SACvBV,EAAKW,QAAUZ,EAAIa,KACnBZ,EAAKa,aAAed,EAAIe,UACxBd,EAAKe,UAAYhB,EAAI1M,OACrBwM,EAAMmB,KAAKhB,EACf,IACAH,EAAMoB,MAAQrB,EAAI/K,GAClBgL,EAAMqB,OAAS,SAAS9C,EAAO,QAAQwB,EAAIxB,OAC3CyB,EAAMsB,UAAYvB,EAAIE,KAAK,GAAGnC,OAC9BC,EAAKoD,KAAKnB,EACd,IACOjC,CACX,GAAC,CAAA/K,IAAA,aAAAC,MAED,SAAWsO,GACP5N,EAAE,IAAK4N,GAAWlL,OAAM,SAAUmL,GAC9BA,EAAIC,iBACJD,EAAIE,kBACJ7I,OAAO8I,SAASC,KAAOjO,EAAER,MAAM+C,KAAK,OACxC,GACJ,GAAC,CAAAlD,IAAA,gBAAAC,MAED,SAAcyM,EAAW6B,EAAWM,EAAQC,EAAM/D,GAC9C,IAEIgE,EAAWC,EAAWC,EAAYC,EAFlCC,EAAmB,GAInBC,EAAY,WACZL,EAAYhE,EAAKvK,OACjBwO,EAAYtC,EAAUjH,KAAK,aAAajF,MAC5C,EA+BI6O,EAAc,WACdD,IACIL,IAAcI,GAClBH,EAAYG,GACRF,EAAWK,OACXJ,EAAWI,QAENN,IAAcD,GACnBG,EAAWI,OACXL,EAAWM,QAENP,IAAcG,GACnBF,EAAWK,OACXJ,EAAWK,SAGXN,EAAWM,OACXL,EAAWK,OAEnB,GAGe,IAAXV,IAnDe,SAASnC,EAAW6B,GACnCA,EACKtL,OACGtC,EAAE,aACG6O,SAAS,8EACTtM,KAAK,OAAQ,UACbA,KAAK,oBAAqBwJ,EAAUxJ,KAAK,OACzCuM,KAAK,mBACLxM,OACGtC,EAAE,QACG8O,KAAK,gBACLD,SAAS,4BAEtB7O,EAAE,aACG6O,SAAS,8EACTtM,KAAK,OAAQ,UACbA,KAAK,oBAAqBwJ,EAAUxJ,KAAK,OACzCuM,KAAK,mBACLxM,OACGtC,EAAE,QACG8O,KAAK,gBACLD,SAAS,2BAI9BP,EAAatO,EAAE,QAAS4N,GACxBW,EAAavO,EAAE,QAAS4N,EAC5B,CAyBImB,CAAahD,EAAW6B,GACxBc,KAGJH,EAAWvJ,GAAG,QAASrF,EAAAA,GAAAA,MAAO,SAAUwE,GACpCsK,IACAjP,KAAK0M,QAAQH,EAAW6B,EAAWS,EAAWG,EAAkBL,EAAM/D,GACtEsE,IACAvK,EAAE4J,iBACN,GAAEvO,OAEF8O,EAAWtJ,GAAG,QAASrF,EAAAA,GAAAA,MAAO,SAAUwE,GACpCsK,IACA,IAAIO,EAAOX,EAAYG,EAGnBQ,GAAQR,GACRhP,KAAK0M,QAAQH,EAAW6B,EAAWS,GAAW,GAAmBF,EAAM/D,GACvEsE,KAEc,IAATM,IAELxP,KAAK0M,QAAQH,EAAW6B,EAAWS,EAAWG,EAAmBH,EAAWF,EAAM/D,GAClFsE,KAEJvK,EAAE4J,iBACN,GAAEvO,MACN,GAAC,CAAAH,IAAA,aAAAC,MAED,SAAW2D,EAAKgM,EAASpJ,EAAOD,EAAQwE,GACpC,IAAI8E,EAAajM,EAAIX,OAAO,KACvBC,KAAK,YACF,gBAAkBqD,EAAS,KAAOqJ,EAAQE,QAAU,KAE5DD,EAAW5M,OAAO,QACbC,KAAK,IAAK,KAAOsD,EAAQ,EAAIoJ,EAAQE,QAAU,IAC/C5M,KAAK,QAAS,GAAKsD,EAAQ,EAAIoJ,EAAQE,QAAU,IACjD5M,KAAK,SAAU0M,EAAQG,QACvB7M,KAAK,OAAQ,qBAElB2M,EAAW5M,OAAO,QACbC,KAAK,QAAQ,gBACbA,KAAK,YAAa,gBAAiB0M,EAAQG,OAAQ,KACnD7M,KAAK,IAAK,KAAOsD,EAAQ,EAAIoJ,EAAQE,QAAU,GAAKF,EAAQE,OAAS,GACrEE,KAAK,eAKVH,EAAW5M,OAAO,QACbC,KAAK,QAAQ,gBACbA,KAAK,YAAa,gBAAkB0M,EAAQG,OAAS,KACrD7M,KAAK,IAAK,KAAOsD,EAAQ,EAAIoJ,EAAQE,QAAU,GAAKF,EAAQE,OAAS,GACrEE,KAAK,iBAKVpM,EAAIX,OAAO,kBACNC,KAAK,KAAM,eACX+M,UAAU,QACVC,KAAK,CACF,CAACC,OAAQ,KAAMC,MAAO,QACtB,CAACD,OAAQ,MAAOC,MAAO,WACvB,CAACD,OAAQ,OAAQC,MAAO,aAE3BC,QACApN,OAAO,QACPC,KAAK,UAAU,SAAUgI,GACtB,OAAOA,EAAEiF,MACb,IACCjN,KAAK,cAAc,SAAUgI,GAC1B,OAAOA,EAAEkF,KACb,GACR,GAAC,CAAApQ,IAAA,UAAAC,MAED,SAAQyM,EAAW6B,EAAW+B,EAAOC,EAASzB,EAAM0B,GAKhD,IAAIC,EAAW,CACPC,UAAW,EACXX,OAAQS,EAAOhQ,OAAS,EAAI,EAAI,EAChCsP,OAAQ,IAEZF,EAAUjP,EAAEgQ,OAAOF,EAAU3B,GAC7B/D,EAAOyF,EAAO1P,MAAM,EAAIwP,EAAQC,GAGpC,GAAIxF,EAAKvK,OAAS,EAAG,OAAO,EAEd,IAAV8P,GAGA/B,EAAU9I,KAAK,OAAOnC,SAG1B,IAAIsN,EAAWlE,EAAUwD,OAAOU,SAC5BC,EAAMnE,EAAUxJ,KAAK,MAErBsD,EAAQ+H,EAAU/H,QAClBD,EAASwE,EAAKvK,OAAUoP,EAAQc,UACvB,EAAId,EAAQG,OAAS,EAAIH,EAAQE,OAY1ClM,EAAMlB,EAAAA,OAAU6L,EAAU,IACzB0B,UAAU,OACVC,KAAK,CAACnF,IACNsF,QACAvM,OAAO,MAAO,gBACdZ,KAAK,QAASsD,GACdtD,KAAK,SAAUqD,GACftD,OAAO,KACPC,KAAK,YAAa,aAAe0M,EAAQE,OAAS,EAAI,KAAQ,IAAMF,EAAQE,OAAU,KAEvFxD,EAAI5J,EAAAA,cAAiB0I,MAAM,CAAC,EAAG5E,EAAQoJ,EAAQE,SAEnDxD,EAAErB,OAAO,CAAC,EAAG2F,IAEb,IF5N8BE,EAC5BC,EACAC,EE0NEC,EAAYvE,EAAUwD,OAAOe,UAC7BC,GF7N0BJ,EEsMd,CACZK,OAAQ,eACRC,OAAQ,aACRC,OAAQ,eACRC,QAAS,eACTC,QAAS,cAkBuCN,GF5NlDF,EAASrO,EAAAA,OAAU,MACnBsO,EAAW,CAACQ,WAAY,KAAMC,aAAc,MAE3C,SAAUvG,GACb,IAAMwG,EAAYX,EAAO7F,GAEzB,MAAO,GAAPnJ,OAAUuJ,EAAkBoG,IAAU3P,OAAGiP,EAASF,GACtD,GEuNQa,EAAWrF,EAAEsF,MAAM,IACvBD,EAASE,MAET,IAAIC,EAAQpP,EAAAA,WAAc4J,GACrByF,WAAWJ,EAAS5P,OAAO,CAAC,EAAG6O,KAC/BoB,WAAWd,GAGAtN,EAAIX,OAAO,KACtBC,KAAK,YAAa,gBAAkB0M,EAAQE,OAAS,KACrD7M,OAAO,KACPC,KAAK,QAAS,UACd+O,KAAKH,GAGA7B,UAAU,QACf/M,KAAK,IAAI,QACTA,KAAK,IAAI,OACTA,KAAK,YAAY,eAEtB,IAAIgP,EAAIxP,EAAAA,YACH0I,MAAM,CAAC,EAAG7E,EAAS,EAAIqJ,EAAQE,OAAS,EAAIF,EAAQG,QAAS,IAElEmC,EAAEjH,OAAOF,EAAK3J,KAAI,SAAU8J,GACxB,OAAOA,EAAEkD,KACb,KAEA,IAAI+D,EAAYzP,EAAAA,WACXuI,OAAO,CACJvI,EAAAA,IAAO,CAAC,KAAMA,EAAAA,IAAOqI,EAAK3J,KAAI,SAAU8J,GACpC,GAAgC,IAA5BC,WAAWD,EAAEoD,WACjB,OAAOpD,EAAEoD,SACb,OAEA5L,EAAAA,IAAOqI,EAAK3J,KAAI,SAAU8J,GACtB,OAAOA,EAAEoD,SACb,OAEHlD,MAAM,CAAC,EAAE,KAEdxH,EAAIX,OAAO,KACNC,KAAK,QAAS,QACdA,KAAK,YAAa,gBAAkB,MAAQ0M,EAAQE,OAASF,EAAQG,QAAU,KAC/EE,UAAU,SACVC,KAAKnF,GACLsF,QACApN,OAAO,KACPmP,MAAK,SAAUlH,EAAE1G,GAGd9B,EAAAA,OAAUvC,MACL8P,UAAU,QACVC,KAAKhF,GAAGmF,QACRpN,OAAO,KACPmP,MAAK,SAAUC,EAAGC,GAGf,IAAIC,EAAWL,EAAEhH,EAAEkD,OAASwB,EAAQc,UAAY,EAC5C8B,EAAe9P,EAAAA,IAAO,GAAI,IAAMyP,EAAUE,EAAEjF,YAE5CkF,EAAE,EAAIpH,EAAE1K,SACJ0K,EAAEoH,GAAG/E,QAAUrC,EAAEoH,EAAE,GAAGjF,SACtB3K,EAAAA,OAAUvC,KAAKsS,YACVxP,OAAO,QACPC,KAAK,KAAMoJ,EAAEpB,EAAEoH,GAAG/E,SAClBrK,KAAK,KAAMqP,GACXrP,KAAK,KAAMoJ,EAAEpB,EAAEoH,EAAE,GAAGjF,WACpBnK,KAAK,KAAMqP,GACXrP,KAAK,SAAUsP,GAEftH,EAAEoH,GAAGjF,SAAWnC,EAAEoH,EAAE,GAAG/E,QAC5B7K,EAAAA,OAAUvC,KAAKsS,YACVxP,OAAO,QACPC,KAAK,KAAMoJ,EAAEpB,EAAEoH,EAAE,GAAG/E,SACpBrK,KAAK,KAAMqP,GACXrP,KAAK,KAAMoJ,EAAEpB,EAAEoH,GAAGjF,WAClBnK,KAAK,KAAMqP,GACXrP,KAAK,SAAUsP,IAI5B,IAAIE,EAAcxH,EAAEkD,MAAQ,gBAAkBuE,EAAwBN,EAAEjF,WAAU,mBAAArL,OAC3D6Q,EAAmBP,EAAEzE,YAAayE,EAAEnE,YAE1C,UAAb+C,IACAyB,GAAe,kBAAJ3Q,OAAsB6Q,EAAmBP,EAAErE,aAAcqE,EAAEnE,aAE1EwE,GAAe,WAAJ3Q,OAAe6Q,EAAmBP,EAAEvE,QAASuE,EAAEnE,YAG1DxL,EAAAA,OAAUvC,MACL+C,KAAK,aAAc,IAAM2N,EAAM,SAAWrM,EAAE,IAC5CvB,OAAO,QACPC,KAAK,QAASwP,GACdxP,KAAK,QAAQ,OACbA,KAAK,KAAK,SAAUgI,GACjB,OAAOoB,EAAEpB,EAAEmC,SACf,IACCnK,KAAK,IAAKgP,EAAEhH,EAAEkD,QACdlL,KAAK,SAAS,SAAUgI,GACrB,OAAOoB,EAAEpB,EAAEqC,OAASrC,EAAEmC,SAAW,EACrC,IACCnK,KAAK,SAAU0M,EAAQc,WACvBxN,KAAK,OAAQR,EAAAA,IAAO8P,GAC7B,GACR,IAGAzH,EAAKvK,OAAS,GACdL,KAAK0S,WAAWjP,EAAKgM,EAASpJ,EAAOD,EAAQiK,GAInC,IAAVF,GACAnQ,KAAK2S,cAAcpG,EAAW6B,GAAW,EAAMO,EAAM0B,GAIzDrQ,KAAK4S,WAAWxE,EACpB,I,EAAC,EAAAvO,IAAA,cAAAC,MAtXD,WACI,OAAO,CACX,GAAC,CAAAD,IAAA,OAAAC,MAED,WACI,MAAO,2DACX,GAAC,CAAAD,IAAA,YAAAC,MAED,WACI,MAAO,oBACX,GAAC,CAAAD,IAAA,UAAAC,MAED,SAAe3B,GACX,MAAO,aAAaA,EAAMsO,MAAMrB,MACpC,GAAC,CAAAvL,IAAA,WAAAC,MAED,SAAgB3B,GACZ,MAAO,sBAAsBA,EAAMsO,MAAM5K,EAC7C,I,4FAAC,CAnBM,I,sxBCmPcyG,EAhPd,WAkCN,O,EAbD,SAAAC,EAAYsK,EAAgB1U,I,4FAAOE,CAAA,KAAAkK,GAC/BvI,KAAKyM,MAAQtO,EAAMsO,MACnBzM,KAAK8S,UH4BO,CACZ9B,OAAQ,CACJ+B,eAAkB,eAClBC,iBAAkB,gBAEtB/B,OAAQ,CACJ8B,eAAkB,aAClBC,iBAAkB,cAEtB9B,OAAQ,CACJ6B,eAAkB,eAClBC,iBAAkB,cAEtB7B,QAAS,CACL4B,eAAkB,eAClBC,iBAAkB,gBAEtB5B,QAAS,CACL2B,eAAkB,aAClBC,iBAAkB,iBG/CgB7U,EAAM2S,WAC5C9Q,KAAKsM,cAAgBuG,EACE,UAAnB1U,EAAM2S,UACN9Q,KAAKiT,aAAejT,KAAKyM,MAAMpM,OAAS,EACd,WAAnBlC,EAAM2S,UACb9Q,KAAKiT,aAAmC,EAApBjT,KAAKyM,MAAMpM,OAE/BL,KAAKiT,aAAejT,KAAKyM,MAAMpM,OAEnCL,KAAKkT,QAAU,CAAC5I,IAAK,GAAIC,MAAO,GAAI4I,OAAQ,GAAIC,KAAM,MACtDpT,KAAKqT,SAASR,EAAexM,QAASwM,EAAezM,SACzD,E,EAAC,EAAAvG,IAAA,WAAAC,MAED,SAASuG,EAAOD,GACZpG,KAAKsT,OAASjN,EAAQrG,KAAKkT,QAAQE,KAAOpT,KAAKkT,QAAQ3I,MACvDvK,KAAKuT,QAAUnN,EAASpG,KAAKkT,QAAQ5I,IAAMtK,KAAKkT,QAAQC,OACxDnT,KAAKyD,IAAMlB,EAAAA,OAAUvC,KAAKsM,cAAc,IAAI3I,OAAO,MAAO,gBACrDZ,KAAK,QAAS/C,KAAKsT,OAAStT,KAAKkT,QAAQ3I,MAAQvK,KAAKkT,QAAQE,MAC9DrQ,KAAK,SAAU/C,KAAKuT,QAAUvT,KAAKkT,QAAQ5I,IAAMtK,KAAKkT,QAAQC,QAC9DrQ,OAAO,KACPC,KAAK,YAAY,aAAa/C,KAAKkT,QAAQE,KAAK,IAAIpT,KAAKkT,QAAQ5I,IAAI,KAC1EtK,KAAKwT,cACLxT,KAAKyT,wBACLzT,KAAK0T,cACL1T,KAAKqJ,MACT,GAAC,CAAAxJ,IAAA,OAAAC,MAED,WACIE,KAAK2T,kBACL3T,KAAK4T,kBACL5T,KAAK6T,WACT,GAAC,CAAAhU,IAAA,wBAAAC,MAED,WACIE,KAAK8T,SAAWvR,EAAAA,cACXuI,OAAO,CACJ,EACmD,KAAlDvI,EAAAA,IAAO,CAACvC,KAAKiT,aAAc1Q,EAAAA,IAAOvC,KAAK+T,WACzCC,OACF/I,MAAM,CAAC,EAAGjL,KAAKsT,SACpBtT,KAAKiU,MAAQ1R,EAAAA,MACRuI,OAAO9K,KAAK8T,SAAShJ,UACrBoJ,WAAWlU,KAAK8T,SAASrC,MAAM,IAFvBlP,CAE4BvC,KAAK+T,OAC9C/T,KAAKmU,SAAW5R,EAAAA,cACXuI,OAAO,CAAC,EAAGvI,EAAAA,IAAOvC,KAAKiU,OAAO,SAASlJ,GAAK,OAAOA,EAAE1K,MAAQ,MAC7D4K,MAAM,CAACjL,KAAKuT,QAAS,IAAIS,MAClC,GAAC,CAAAnU,IAAA,cAAAC,MAED,WACIE,KAAK+T,MAAQ5T,EAAAA,GAAAA,IAAMH,KAAKyM,MAAM7B,KAAMzK,EAAAA,GAAAA,SAAW,UACnD,GAAC,CAAAN,IAAA,sBAAAC,MAED,WACI,IAAIsU,EAAe5T,EAAEkF,QAAQW,QAC7BgO,QAAQC,IAAI,WAAWF,GACvB,IAAIG,EAAiBpU,EAAAA,GAAAA,SAAWA,EAAAA,GAAAA,MAAO,WAC/BiU,GAAgB5T,EAAEkF,QAAQW,UAC1BgO,QAAQC,IAAI,oBAAoBtU,KAAKuT,SACrCvT,KAAKqJ,OACL+K,EAAe5T,EAAEkF,QAAQW,QAEjC,GAAGrG,MAAO,KACVQ,EAAEkF,QAAQ8O,OAAOD,EACrB,GAAC,CAAA1U,IAAA,iBAAAC,MAED,SAAe6Q,GACX,IAAMc,EAAQzR,KAAK8T,SAASrC,QACtBb,EAASrO,EAAAA,OAAU,MACnBsO,EAAW,CAAEQ,WAAY,KAAMC,aAAc,MAEnD,OAAO,SAACvG,GACJ,GAAU,IAANA,GAAY0G,EAAMgD,SAAS1J,GAA/B,CAEA,GAA2B,OAAvB8F,EAASF,GACT,MAAO,GAAP/O,OAAUmJ,EAAC,KAAAnJ,OAAIiP,EAASF,IAExB,IAAMY,EAAYX,EAAO7F,GAEzB,MAAO,GAAPnJ,OAAU4Q,EAA0BjB,IAAU3P,OAAGiP,EAASF,GAPrB,CAS7C,CACJ,GAAC,CAAA9Q,IAAA,cAAAC,MAED,WACI,IAAI4U,EAAO1U,KACP2U,EAAQ,GACZ3U,KAAKiU,MAAMhT,KAAI,SAAU2T,GACrB,IAAIC,EAAa,GACjBD,EAAIE,UACJ,IAAIC,EAAKH,EAAIvU,OACbuU,EAAI3T,KAAI,SAAU8J,EAAE1G,GAChB,IAAI2Q,EAAKJ,EAAIvU,QAAUgE,EAAE,GACrB4Q,EAAY9U,EAAAA,GAAAA,UAAYuU,EAAKjI,MAAM7B,KAAM,CAACvK,OAAQ0K,IAClDJ,EAAS+J,EAAKjI,MAAM7B,KAAKqK,GAAWnI,KAAK,GAAGnC,OAC5CuK,EAAO,CACPpV,MAAOiL,EACPlJ,GAAI6S,EAAKjI,MAAM7B,KAAKqK,GAAWpT,GAC/B8I,OAAQA,EACRjI,IAAK,UAAUgS,EAAKjI,MAAMrB,OAAO,QAAQsJ,EAAKjI,MAAM7B,KAAKqK,GAAW7J,OACpE2J,GAAIA,EACJC,GAAID,GAAOC,EAAKD,EAChB9E,MAAOuC,EAA8B7H,EAAO+J,EAAKjI,MAAM7B,OAE3DiK,EAAW7G,KAAKkH,EACpB,IACA,IAAIA,EAAO,CAACnF,KAAM8E,EAAY1I,EAAGyI,EAAIO,GAAIC,GAAIR,EAAIS,GAAIhV,OAAQuU,EAAIvU,QACjEsU,EAAM3G,KAAKkH,EACf,IACAlV,KAAKsV,aAAeX,CACxB,GAAC,CAAA9U,IAAA,kBAAAC,MAED,WACI,IAAI4U,EAAO1U,KACDA,KAAKyD,IAAIqM,UAAU,QACxBC,KAAK/P,KAAKsV,cACVpF,QAAQpN,OAAO,KACfC,KAAK,QAAS,KACdA,KAAK,aAAa,SAASgI,GACxB,MAAO,cAAc2J,EAAKZ,SAAS/I,EAAEoB,GAAGuI,EAAKxB,QAAQE,MAAM,KAC/D,IAEAtD,UAAU,QACTC,MAAK,SAAUhF,GAAK,OAAOA,EAAEgF,IAAM,IACnCG,QAAQpN,OAAO,KACfC,KAAK,cAAc,SAASsB,GAAK,OAAOA,EAAE3B,GAAK,IAC/CI,OAAO,QACPC,KAAK,QAAQ,OACbA,KAAK,SAAS,SAASsB,GACpB,OAAOA,EAAExC,GAAFwC,iBAAyBmO,EAAwBnO,EAAEsG,QAAQ,eAAetG,EAAEvE,KACvF,IACCiD,KAAK,IAAK,GACVA,KAAK,KAAK,SAASsB,GAAK,OAAQqQ,EAAKP,SAAS9P,EAAE0Q,GAAM,IACtDhS,KAAK,QAAS2R,EAAKZ,SAAS9T,KAAKiU,MAAM,GAAGkB,IAAMT,EAAKZ,SAAS9T,KAAKiU,MAAM,GAAGkB,IAAM,GAClFpS,KAAK,UAAU,SAAUsB,GAAK,OAAOqQ,EAAKP,SAAS9P,EAAE2Q,IAAMN,EAAKP,SAAS9P,EAAE0Q,GAAK,IAChFhS,KAAK,QAAQ,SAASsB,GACnB,OAAOA,EAAE4L,KACb,GACR,GAAC,CAAApQ,IAAA,kBAAAC,MAED,WACI,IAAIyV,EAAavV,KAAKyD,IAAIX,OAAO,KAC5BC,KAAK,QAAQ,cACbA,KAAK,YAAY,cAAc/C,KAAKkT,QAAQE,KAAKpT,KAAK8T,SAAS9T,KAAKiT,eAAe,OAExFsC,EAAWzS,OAAO,QACbC,KAAK,IAAI,GACTA,KAAK,QAAQ,OACbA,KAAK,QAAQ,GACbA,KAAK,SAAS/C,KAAKuT,SACnBvQ,MAAM,OAAO,WAElBuS,EAAWzS,OAAO,QACbC,KAAK,KAAM,UACXA,KAAK,KAAM,IACXA,KAAK,IAAK,GACVA,KAAK,cAAc,SACnB8M,KAAK,SACL7M,MAAM,OAAO,QACbD,KAAK,YAAY,cAC1B,GAAC,CAAAlD,IAAA,YAAAC,MAED,WACI,IAAI0V,EAAOC,EAGPD,GAFJC,EAAMzV,KAAKmU,SAAS1C,QAAQpR,SACjB,EACC,EAEAoV,EAEZ,IAAI1E,EAAY/Q,KAAK0V,eAAe1V,KAAK8S,UAAUE,kBAC/C2C,EAASpT,EAAAA,QAAWvC,KAAK8T,UACxBrC,MAAM,IACNI,WAAWd,GACZ6E,EAASrT,EAAAA,SAAYvC,KAAKmU,UACzBvC,WAAW5R,KAAKmU,SAAS1C,MAAM+D,IAC/BK,cAAc,GACdhE,YAAW,SAAUlN,GAClB,GAAI8G,KAAKqK,MAAMnR,IAAMA,EAGrB,OAAOA,CACX,IACA8M,EAAQzR,KAAKmU,SAAS1C,QAC1B,IAAK,IAAIpN,KAAKoN,EACV,GAAIA,EAAMpN,GAAK,GAAK,EAAG,CACnBuR,EAAOhE,WAAWrP,EAAAA,MAAS,EAAGA,EAAAA,IAAOvC,KAAKiU,OAAO,SAASlJ,GAAK,OAAOA,EAAE1K,MAAQ,IAAG,IACnF,KACJ,CAEJ,IAAIqU,EAAO1U,KACP+V,EAAa/V,KAAKyD,IAAIX,OAAO,KAC5BC,KAAK,QAAS,gBACdA,KAAK,YAAa,aAAa/C,KAAKkT,QAAQE,KAAK,IAAIpT,KAAKuT,QAAQ,KAClEzB,KAAK6D,GAEVI,EAAWjG,UAAU,QAAQ/M,KAAK,MAAK,SAAUgI,GAC7C,IAAI0G,EAAQiD,EAAKZ,SAASrC,QAC1B,OAAItR,EAAAA,GAAAA,QAAUsR,EAAO1G,IAAM,EAChB,EAEA,CAEf,IAEAgL,EAAWjG,UAAU,QAAQ9M,MAAM,cAAc,OAC5CD,KAAK,IAAK,QACVA,KAAK,IAAK,OACVA,KAAK,KAAM,KACXA,KAAK,YAAY,eAEtB/C,KAAKyD,IAAIX,OAAO,KACXC,KAAK,QAAQ,gBACbA,KAAK,YAAY,aAAa/C,KAAKkT,QAAQE,KAAK,OAChDtB,KAAK8D,EACd,I,EAAC,EAAA/V,IAAA,cAAAC,MA5OD,WACI,OAAO,CACX,GAAC,CAAAD,IAAA,OAAAC,MAED,WACI,MAAO,+CACX,GAAC,CAAAD,IAAA,YAAAC,MAED,WACI,MAAO,qBACX,GAAC,CAAAD,IAAA,UAAAC,MAED,SAAe3B,GACX,MAAO,UAAUA,EAAMsO,MAAMrB,MACjC,GAAC,CAAAvL,IAAA,WAAAC,MAED,SAAgB3B,GACZ,MAAO,uBAAuBA,EAAMsO,MAAM5K,EAC9C,I,4FAAC,CAnBM,ICTX,IAAMmU,EAAe,SAACC,GAElB,OADAA,EAAW,GAAK,IAAMA,EAAW,GAAGC,UAAU,GACvCD,EAAWtV,MAAM,EAAG,EAC/B,EAEMwV,EAAe,SAACF,GAClB,OAA0B,IAAtBA,EAAW5V,QAIa,MAArB4V,EAAW,GAAG,IAAmC,MAArBA,EAAW,GAAG,IAAcA,EAAW,GAAG5V,SAAW4V,EAAW,GAAG5V,MAC1G,E,29CCGO,IA6EM+V,GAAiB,SAAAC,GAC1B,SAAAD,EAAYjY,GAAO,IAAAC,EAqBgB,O,4FArBhBC,CAAA,KAAA+X,IACfhY,EAAAE,EAAA,KAAA8X,EAAA,CAAMjY,KACDO,MAAQ,CACToB,MAAOU,EAAE,wBAAwB8V,OAAS,IAE9ClY,EAAK0B,MAAQ1B,EAAK0B,MAAMZ,KAAId,GAC5BA,EAAKmY,MAAQnY,EAAKmY,MAAMrX,KAAId,GAC5BA,EAAKoY,MAAQpY,EAAKoY,MAAMtX,KAAId,GAC5BA,EAAKqY,QAAUrY,EAAKqY,QAAQvX,KAAId,GAChCA,EAAKsY,SAAWtY,EAAKsY,SAASxX,KAAId,GAClCA,EAAKuY,SAAWvY,EAAKuY,SAASzX,KAAId,GAClCA,EAAKwY,YAAcxY,EAAKwY,YAAY1X,KAAId,GACxCA,EAAKyY,eAAiBzY,EAAKyY,eAAe3X,KAAId,GAC9CA,EAAK0Y,cAAgB1Y,EAAK0Y,cAAc5X,KAAId,GAC5CA,EAAK2Y,eAAiB3Y,EAAK2Y,eAAe7X,KAAId,GAC9CA,EAAKuD,KAAOvD,EAAKuD,KAAKzC,KAAId,GAC1BA,EAAK4Y,kBAAoB5Y,EAAK4Y,kBAAkB9X,KAAId,GACpDA,EAAK6Y,mBAAqB7Y,EAAK6Y,mBAAmB/X,KAAId,GACtDA,EAAK8Y,OAAS9Y,EAAK8Y,OAAOhY,KAAId,GAE9BA,EAAK+Y,aAAcxX,EAAAA,EAAAA,aACnBvB,EAAKgZ,aAAczX,EAAAA,EAAAA,aAAYvB,CACnC,CAGA,O,sRAAAwB,CAAAwW,EAAAC,G,EAAAD,E,EAAA,EAAAvW,IAAA,oBAAAC,MAEA,WACIU,EAAE,QAAQ0C,OAAM,WACZ1C,EAAE,wDAAwD2O,KAAK,OAAQ,CAAEkI,UAAW,OAAQC,YAAY,SAC5G,GACJ,GAAC,CAAAzX,IAAA,qBAAAC,MAED,WACIE,KAAK6W,iBACL7W,KAAKiX,qBACLjX,KAAK7B,MAAMoZ,kBAAkBvX,KAAKwX,iBAElC,IAAI7V,EAAO3B,KAAK2B,OACXA,GAAQA,IAAS3B,KAAKyX,QACvBzX,KAAKyX,MAAQ9V,EACb3B,KAAKkX,OAAOvV,GACZ3B,KAAK7B,MAAMuZ,sBAAsB/V,GAEzC,GAIA,CAAA9B,IAAA,QAAAC,MAQA,SAAMwW,GACF,OAAW,MAAPA,EAEOtW,KAAKtB,MAAMoB,OAGlBE,KAAKzB,SAAS,CACVuB,MAAOwW,IAEJtW,KAEf,GAAC,CAAAH,IAAA,gBAAAC,MAED,WAUI,OATiBE,KAAKF,QACCgM,MAAM,MACD6L,QAAO,SAACC,EAAOC,GACvC,OAAKA,EAAKC,WAAW,KAGdF,EAFIA,EAAQC,EAAKxX,MAG5B,GAAG,EAGP,GAEA,CAAAR,IAAA,QAAAC,MAKA,WACI,OAAOE,KAAKF,MAAM,IAAI0W,OAC1B,GAEA,CAAA3W,IAAA,QAAAC,MAGA,WAEI,OADAE,KAAK0W,WAAWF,QACTxW,IACX,GAEA,CAAAH,IAAA,UAAAC,MAGA,WACI,OAAQE,KAAKF,OACjB,GAGA,CAAAD,IAAA,WAAAC,MAEA,WACI,OAAOU,EAAER,KAAKmX,YAAY1W,QAC9B,GAAC,CAAAZ,IAAA,WAAAC,MAED,WACI,OAAOU,EAAER,KAAKoX,YAAY3W,QAC9B,GAAC,CAAAZ,IAAA,cAAAC,MAED,SAAYuO,GACRrO,KAAKF,MAAMuO,EAAI0J,OAAOjY,MAC1B,GAEA,CAAAD,IAAA,iBAAAC,MAQA,WACI,GAAKE,KAAKyW,UAWNzW,KAAK0W,WAAWsB,SAASV,YAAY,aACrCtX,KAAKiY,cAAgBzX,EAAE,kBACvBR,KAAKiY,cAAc1O,QAEnBvJ,KAAK2W,WAAWtH,SAAS,cAfR,CAIjB,IAAI6I,EAAelY,KAAK0W,WAAW,GAC/ByB,EAAwBD,EAAaE,YAAcF,EAAaG,YACpErY,KAAK2W,WAAW2B,IAAI,QAASH,EAAwB,IACrDnY,KAAK2W,WAAWW,YAAY,SAChC,CASJ,GAEA,CAAAzX,IAAA,gBAAAC,MAGA,WACIE,KAAK0W,WAAWsB,SAAS3I,SAAS,YACtC,GAEA,CAAAxP,IAAA,iBAAAC,MAGA,WACIE,KAAK0W,WAAWsB,SAASV,YAAY,YACzC,GAEA,CAAAzX,IAAA,OAAAC,MAOA,WACI,IAAIyY,EAAWvY,KAAKF,QAAQ0Y,OAG5B,IAAID,EAAST,WAAW,KAAxB,CAMA,IAJA,IAEInW,EAAM8W,EAFNC,EAAYH,EAASzM,MAAM,OAItBzH,EAAI,EAAGA,EAAIqU,EAAUrY,OAAQgE,IAIlC,GAHAoU,EAAMzY,KAAKgX,kBAAkB0B,EAAUrU,IAKvC,GAAK1C,GAIA,GAAI8W,IAAQ9W,EAEb,MAAO,aAJPA,EAAO8W,EAQf,OAAO9W,CAtB4C,CAuBvD,GAAC,CAAA9B,IAAA,qBAAAC,MAED,WACI,IAAIyY,EAAWvY,KAAKF,QAChB6Y,EDxRgB,SAACJ,GACzB,I,EAAIK,EAAkBL,EAASC,OAE/B,IAAKI,EAAgBd,WAAW,KAC5B,OAAOS,EAMX,IAHA,IAAMM,EAAgBD,EAAgB9M,MAAM,MACtCgN,EAAc,GAEXzU,EAAI,EAAGA,EAAIwU,EAAcxY,OAAQgE,GAAK,EAAG,CAC9C,IAAM4R,EAAa4C,EAAclY,MAAM0D,EAAGA,EAAI,GAC9C,IAAI8R,EAAaF,GAIb,OAAOsC,EAHPO,EAAY9K,KAAI+K,MAAhBD,E,+CAAoB9C,EAAaC,K,kjBAKzC,CAEA,OAAO6C,EAAYE,KAAK,KAC5B,CCmQ8BC,CAAaV,GAE/BA,IAAaI,IACb3Y,KAAKF,MAAM6Y,GACX3Y,KAAKkX,OAAO,SAEpB,GAEA,CAAArX,IAAA,oBAAAC,MAIA,SAAkByY,GAMd,MAHAA,GADAA,EAAWA,EAAShV,QAAQ,WAAY,KACpBA,QAAQ,SAAU,KAGzBlD,OAAS,IAAtB,CAMA,IADA,IAAI6Y,EAAoB,EACf7U,EAAI,EAAGA,EAAIkU,EAASlY,OAAQgE,IAC7BkU,EAASlU,GAAGrD,MAAM,cAClBkY,GAAqB,GAK7B,OAAOA,EADS,GAAMX,EAASlY,OACQ,aAAe,SAXtD,CAYJ,GAAC,CAAAR,IAAA,SAAAC,MAED,SAAO6B,GACH3B,KAAK+W,iBACLzV,aAAatB,KAAKmZ,sBAGdxX,IACAnB,EAAE,IAAMmB,EAAO,0BAA0ByN,KAAK,OAAQ,CAAEiI,UAAW,OAAQhI,SAAS,UAEpFrP,KAAKmZ,qBAAuBjZ,YAAW,WACnCM,EAAE,wDAAwD2O,KAAK,OAAQ,CAAEkI,UAAW,OAAQC,YAAY,SAC5G,GAAG,KAEU,UAAT3V,GACA3B,KAAK8W,gBAGjB,GAAC,CAAAjX,IAAA,SAAAC,MAED,WACI,OACI2B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,WAAUN,SAAA,EACrBD,EAAAA,EAAAA,KAAA,OACIO,UAAU,WAAUN,UACpBD,EAAAA,EAAAA,KAAA,YACIU,GAAG,WAAWK,IAAKlC,KAAKmX,YACxBzV,UAAU,kIACVX,KAAK,WAAWjB,MAAOE,KAAKtB,MAAMoB,MAClCsZ,KAAK,IACLC,SAAS,WACTC,YAAY,6FAEZC,WAAW,QAAQC,WAAS,EAC5BC,SAAUzZ,KAAK4W,iBAGvBzV,EAAAA,EAAAA,KAAA,OACIO,UAAU,gCACVQ,IAAKlC,KAAKoX,YAAYhW,UACtBK,EAAAA,EAAAA,MAAA,UACIE,KAAK,SACLD,UAAU,4DAA4DG,GAAG,qBACzER,MAAM,2BACNU,QAAS/B,KAAKuW,MAAMnV,SAAA,EACpBD,EAAAA,EAAAA,KAAA,QAAMU,GAAG,mBACTV,EAAAA,EAAAA,KAAA,KAAGO,UAAU,6BACbP,EAAAA,EAAAA,KAAA,QAAMO,UAAU,UAASN,SAAC,oCAK9C,I,4FAAC,CA9RyB,CAASkB,EAAAA,W,yjDCzFhC,IAAMoX,GAAO,SAAAxb,GAChB,SAAAwb,EAAYvb,GAAO,IAAAC,EAYwD,O,4FAZxDC,CAAA,KAAAqb,IACftb,EAAAE,GAAA,KAAAob,EAAA,CAAMvb,KAEDO,MAAQ,CACTib,UAAW,GACXC,YAAaxb,EAAKyb,qBAClBC,WAAY,YAGhB1b,EAAK2b,mBAAqB3b,EAAK2b,mBAAmB7a,KAAId,GACtDA,EAAK4b,kBAAoB5b,EAAK4b,kBAAkB9a,KAAId,GACpDA,EAAK6b,kBAAoB7b,EAAK6b,kBAAkB/a,KAAId,GACpDA,EAAK8b,wBAA0B9b,EAAK8b,wBAAwBhb,KAAId,GAAOA,CAC3E,CAAC,O,sRAAAwB,CAAA8Z,EAAAxb,G,EAAAwb,E,EAAA,EAAA7Z,IAAA,qBAAAC,MAGD,WACI,MAAO,CACHqa,gBAAiB,GACjBxP,OAAQ,GACRyP,KAAM,GAEd,GAAC,CAAAva,IAAA,qBAAAC,MAED,SAAmBua,GACf,GAAIA,EAAUC,oBAAsBta,KAAK7B,MAAMmc,kBAAmB,CAC9D,IAAIC,EAAiBva,KAAK7B,MAAMmc,kBAAiB,SAAY,CAACE,WAAY,IAEtEC,GADkBza,KAAK7B,MAAMmc,kBAAkB,gBAAkBC,GAAkB,CAACC,WAAY,KAC7DA,WAAWxB,KAAK,KAAKR,OACxDkC,EAAgB1a,KAAK0a,cAAcD,GACvCza,KAAKzB,SAAS,CAAEob,UAAWc,EAAkBb,YAAac,GAC9D,CACJ,GAAC,CAAA7a,IAAA,qBAAAC,MAED,SAAmB6Z,GACf,IAAIe,EAAgB1a,KAAK0a,cAAcf,EAAU9N,YAEjD7L,KAAKzB,SAAS,CACVob,UAAWA,EAAU9N,WACrB+N,YAAac,GAErB,GAAC,CAAA7a,IAAA,gBAAAC,MAED,SAAc6Z,GAIV,IAHA,IAAMgB,EAAQhB,EAAU7N,MAAM,KAC1B4O,EAAgB1a,KAAK6Z,qBAEhBxV,EAAI,EAAGA,EAAIsW,EAAMta,OAAQgE,GAAK,EAEnC,GAAIsW,EAAMtW,IACFsW,EAAMtW,GAAGyT,WAAW,KAAM,CAC1B,IAAM8C,EAAaD,EAAMtW,GAAG6R,UAAU,GAAGsC,OAErCmC,EAAMtW,EAAI,GAEVqW,EAAcE,GAAcD,EAAMtW,EAAI,GAGtCqW,EAAcE,GAAc,IAEpC,CAIR,OAAOF,CACX,GAAC,CAAA7a,IAAA,oBAAAC,MAED,WACI,OACIqB,EAAAA,EAAAA,KAAA,OAAKU,GAAG,kBAAkBH,UAAU,SAAQN,SACtCyZ,OAAOC,KAAK9a,KAAK7B,MAAMmc,mBAAmBja,OAAS,IAAKoB,EAAAA,EAAAA,MAAAY,EAAAA,SAAA,CAAAjB,SAAA,EACtDK,EAAAA,EAAAA,MAAA,OAAKC,UAAU,mDAAkDN,SAAA,EAC7DD,EAAAA,EAAAA,KAAA,MAAIO,UAAU,wCAAuCN,SAAC,cACtDD,EAAAA,EAAAA,KAAA,KAAGO,UAAU,0BAAyBN,SAAC,4DAE1CpB,KAAK+a,oBAItB,GAAC,CAAAlb,IAAA,gBAAAC,MAED,WAAgB,IAAAC,EAAA,KACZ,OACIoB,EAAAA,EAAAA,KAAA,MAAIO,UAAU,kBAAiBN,SAEvByZ,OAAOG,QAAQhb,KAAK7B,MAAMmc,mBAAmBrZ,KACzC,SAAAga,EAAgB9K,GAAU,IAAA+K,E,05BAAAtS,CAAAqS,EAAA,GAAxBpb,EAAGqb,EAAA,GAAEC,EAAMD,EAAA,GACLvB,EAAYwB,EAAOX,WAAWxB,KAAK,KAAKR,OACxC4C,EAAcD,EAAOC,aAAezB,EAExC,OACIlY,EAAAA,EAAAA,MAAA,SAAmBC,UAAS,4FAA8FN,SAAA,EACtHD,EAAAA,EAAAA,KAAA,SACIQ,KAAK,QACLZ,KAAK,mBACLjB,MAAO6Z,EACP0B,QAAS1B,IAAc5Z,EAAKrB,MAAMib,UAClCF,SAAU,WAAF,OAAQ1Z,EAAKga,mBAAmBJ,EAAU,KAEtDlY,EAAAA,EAAAA,MAAA,UAAQC,UAAU,OAAMN,SAAA,CAAEvB,EAAI,OAAU,IAAOub,IARvCjL,EAWpB,KAKpB,GAAC,CAAAtQ,IAAA,oBAAAC,MAED,WAAoB,IAAAyB,EAAA,KACZ+Z,EAAa,2GAMjB,OAJItb,KAAKtB,MAAMib,YACX2B,GAAc,mBAIb7Z,EAAAA,EAAAA,MAAA,OAAKC,UAAqC,aAA1B1B,KAAKtB,MAAMob,WAA4B,gBAAkB,SAAS1Y,SAAA,EAC/EK,EAAAA,EAAAA,MAAA,OAAKC,UAAU,iBAAgBN,SAAA,EAC3BD,EAAAA,EAAAA,KAAA,SAAOO,UAAU,yCAAyC6Z,QAAQ,WAAUna,SAAC,gBAI5EpB,KAAK7B,MAAMqd,cACR/Z,EAAAA,EAAAA,MAAA,UACIC,UAAU,yCACVC,KAAK,SACLI,QAAS/B,KAAKka,wBACd,cAAY,QAAQ,cAAY,QAAO9Y,SAAA,CAAC,eAExCD,EAAAA,EAAAA,KAAA,KAAGO,UAAU,2DAKzBP,EAAAA,EAAAA,KAAA,OAAKO,UAAU,wBAAuBN,UAClCD,EAAAA,EAAAA,KAAA,SAAOQ,KAAK,OAAOD,UAAW4Z,EAC1B7B,SAAU,SAAA9U,GAAC,OAAIpD,EAAKwY,mBAAmBpV,EAAEoT,OAAOjY,MAAM,EACtD+B,GAAG,WACHd,KAAK,WACLjB,MAAOE,KAAKtB,MAAMib,UAClBL,YAAY,yCACZjY,MAAM,4CAGdF,EAAAA,EAAAA,KAAA,OAAKO,UAAU,qBAAoBN,SAAC,sDAKhD,GAAC,CAAAvB,IAAA,0BAAAC,MAED,SAAwB6E,GAMpB,IALA,IACMjE,EAASV,KAAK7B,MAAMqd,YAAYC,cAChCC,EAAQpX,SAASqX,cAAc,yBAGrCC,EAAA,EAAAC,EALY,CAAC,SAAU,UAAW,SAAU,SAAU,WAKlCD,EAAAC,EAAAxb,OAAAub,IAAE,CAAjB,IAAM/Z,EAAEga,EAAAD,GACL/Z,IAAOnB,EACP4D,SAAS6B,eAAetE,GAAIia,UAAU3Y,OAAO,UAE7CmB,SAAS6B,eAAetE,GAAIia,UAAUC,IAAI,SAElD,CAEAL,EAAMM,WACV,GAAC,CAAAnc,IAAA,SAAAC,MAED,WACI,OACI2B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gEAA+DN,SAAA,CACzEpB,KAAKga,oBAELha,KAAKia,sBAGlB,I,iFAAC,CAlLe,CAAS3X,EAAAA,W,k9CCQ7B,SARgB,SAAA2Z,GAAA,SAAAC,IAAA,O,4FAAA7d,CAAA,KAAA6d,GAAA5d,GAAA,KAAA4d,EAAA1U,UAAA,Q,sRAAA5H,CAAAsc,EAAAD,G,EAAAC,G,EAAA,EAAArc,IAAA,SAAAC,MACZ,WAAW,GAAC,CAAAD,IAAA,qBAAAC,MAEZ,WACEuU,QAAQC,IAAI,eAAgBtU,KAAK7B,MACnC,M,8EAAC,CALW,CAASge,IAAAA,W,w8DCKzB,IAAMC,GAAYD,IAAAA,MAAW,kBAAM,8BAAsBE,MAAK,SAAAC,GAAG,MAAK,CAAEC,QAASD,EAAIF,UAAW,GAAE,IAC5FI,GAAgBL,IAAAA,MAAW,kBAAM,qDAA0B,IAQpDM,GAAI,SAAAve,GACb,SAAAue,EAAYte,GAAO,IAAAC,EAsBsC,OAtBtCC,GAAA,KAAAoe,IACfre,EAAAE,GAAA,KAAAme,EAAA,CAAMte,KACDO,MAAQ,CACTge,UAAW,GACXC,eAAgB,GAChBC,qBAAsB,GACtBC,eAAgB,CAAC,EACjBC,KAAM,CAAC,EACPC,wBAAyB,EACzBvB,YAAa,IAEjBpd,EAAK4e,cAAgB5e,EAAK4e,cAAc9d,KAAId,GAC5CA,EAAK6e,sBAAwB7e,EAAK6e,sBAAsB/d,KAAId,GAC5DA,EAAK8e,0BAA4B9e,EAAK8e,0BAA0Bhe,KAAId,GACpEA,EAAK+e,sBAAwB/e,EAAK+e,sBAAsBje,KAAId,GAC5DA,EAAKgf,0BAA4Bhf,EAAKgf,0BAA0Ble,KAAId,GACpEA,EAAKif,+BAAiCjf,EAAKif,+BAA+Bne,KAAId,GAC9EA,EAAKkf,kBAAoBlf,EAAKkf,kBAAkBpe,KAAId,GACpDA,EAAKmf,qBAAuBnf,EAAKmf,qBAAqBre,KAAId,GAC1DA,EAAKof,SAAU7d,EAAAA,EAAAA,aACfvB,EAAKqO,OAAQ9M,EAAAA,EAAAA,aACbvB,EAAKqf,QAAS9d,EAAAA,EAAAA,aACdvB,EAAKsf,eAAiBtf,EAAKsf,eAAexe,KAAId,GAAOA,CACzD,CAAC,OAAAwB,GAAA6c,EAAAve,GAAAyf,GAAAlB,EAAA,EAAA5c,IAAA,oBAAAC,MAED,WAOI,IAAI8d,EAASpP,SAASoP,OAAO9R,MAAM,QAAQ+R,OAAOC,SAC9CC,EAASC,eAAejW,QAAQ,UAChCgW,GACAH,EAAO9c,QAAQ,UAADc,OAAWmc,IAE7Bvd,GAAEyd,QAAQ,mBAADrc,OAAoBgc,EAAO5E,KAAK,MAAQ,SAAUjJ,GAAM,IAAAhQ,EAAA,KAI7DC,KAAKzB,SAAS,CACVue,KAAM/M,EAAW,KACjB2M,UAAW3M,EAAe,SAC1B4M,eAAgB5M,EAAqB,eACrC8M,eAAgB9M,EAAc,QAC9BmO,aAAcnO,EAAmB,aACjC6M,qBAAsB7M,EAAqB,gBAAK,KACjD,WACChQ,EAAKsd,+BAA+Btd,EAAKrB,MAAMke,sBAC/C7c,EAAKoe,yBACLpe,EAAKqe,iBACT,IAKIrO,EAAY,OACZ/P,KAAKyM,MAAMhM,QAAQX,MAAMiQ,EAAY,OAIzC7P,YAAW,WACPH,EAAKse,mBAAmBte,EAAKrB,MAAMie,eACvC,GAAG,GAEHzc,YAAW,WACPM,GAAE,eAAe0C,OACrB,GAAG,IACP,EAAEhE,KAAKc,OAGPQ,GAAE8D,UAAUkB,GAAG,WAAW,SAACb,GACvB,IAAI2Z,EAAU9d,GAAE,YACX8d,EAAQC,GAAG,cACZ5Z,EAAE6Z,SAAqB,UAAV7Z,EAAE9E,KACfye,EAAQG,QAAQ,QAExB,GACJ,GAAC,CAAA5e,IAAA,yBAAAC,MAED,WACI,IAAM4e,EAA+C,MAA7B1e,KAAKtB,MAAMie,eAAyB3c,KAAKtB,MAAMie,eAAe,GAAGhb,KAAO,KAC5F+c,GACA1e,KAAKod,0BAA0BsB,EAEvC,GAAC,CAAA7e,IAAA,kBAAAC,MAED,WACI,IAAMnB,EAAUqB,KAAKid,wBACjBte,EAAQ0B,OAAS,GACjBL,KAAKzB,SAAS,CAAEid,YAAa7c,EAAQ,IAE7C,GAAC,CAAAkB,IAAA,qBAAAC,MAED,SAAmB6c,GAAgB,IAAApb,EAAA,KAC3Bob,GACAA,EAAegC,SAAQ,SAAAC,GACnB,IAAMC,EAAgBtd,EAAKic,QAAQ/c,QAAQkb,cAAc,kCAAD/Z,OAAmCgd,EAAG/c,GAAE,OAC5Fgd,IACAA,EAAc3b,QACd2b,EAAcxD,SAAU,EAEhC,GAER,GAAC,CAAAxb,IAAA,gBAAAC,MAED,WACI,OAAQK,EAAAA,GAAAA,QAAUH,KAAKtB,MAAMoe,KACjC,GAAC,CAAAjd,IAAA,uBAAAC,MAED,SAAqBuO,GACjBA,EAAIC,iBACJ,IAAMwQ,EAAO9e,KAAKwd,QAAQ/c,QAE1B6D,SAAS6B,eAAe,WAAWnD,MAAM+b,QAAU,QAEnD,IAAMC,EAAW,IAAIC,SAASH,GAC9BE,EAASlc,OAAO,SAAU9C,KAAKyd,OAAOhd,QAAQ/B,MAAMC,QAAQ,IAE5DugB,MAAMxZ,OAAO8I,SAASvM,KAAM,CACxBvB,OAAQ,OACRye,KAAMH,IACP3C,MAAK,SAAA+C,GAEJ9a,SAAS6B,eAAe,WAAWnD,MAAM+b,QAAU,OAE/CK,EAAIC,YAAcD,EAAI1c,KAGtBxC,YAAW,WACPwF,OAAO4Z,KAAKF,EAAI1c,IAAKlC,GAAE,iBAAiB+d,GAAG,YAAc,SAAW,QACxE,GAAG,EAEX,GACJ,GAAC,CAAA1e,IAAA,wBAAAC,MAED,WACI,IAAIyf,EAAgBvf,KAAKwf,aACrBC,EAAgBzf,KAAK0f,aAEzB,GAAI1f,KAAKyM,MAAMhM,QAAQgW,UACnB,MAAO,GAIX,OAAQ8I,GACR,IAAK,UACD,OAAQE,GACR,UAAKhY,EACD,MAAO,CAAC,SAAU,UACtB,IAAK,UACD,MAAO,CAAC,UACZ,IAAK,aACD,MAAO,CAAC,UAEZ,MACJ,IAAK,aACD,OAAQgY,GACR,UAAKhY,EACD,MAAO,CAAC,UAAW,SAAU,WACjC,IAAK,UACD,MAAO,CAAC,WACZ,IAAK,aACD,MAAO,CAAC,SAAU,YAK1B,MAAO,EACX,GAAC,CAAA5H,IAAA,wBAAAC,MAED,SAAsBid,GACfA,IAA4B/c,KAAKtB,MAAMqe,yBACtC/c,KAAKzB,SAAS,CAAEwe,wBAAyBA,GACjD,GAAC,CAAAld,IAAA,4BAAAC,MAED,SAA0B6B,GACtB3B,KAAK0f,aAAe/d,EACpB3B,KAAK0d,gBACT,GAAC,CAAA7d,IAAA,4BAAAC,MAED,SAA0B6B,GACtB3B,KAAKwf,aAAe7d,EACpB3B,KAAK0d,gBACT,GAAC,CAAA7d,IAAA,iBAAAC,MAED,WACIE,KAAKyd,OAAOhd,QAAQlC,SAAS,CACzBK,UAAWoB,KAAKyM,MAAMhM,QAAQgW,UAC9B5X,eAAgBmB,KAAKwf,aACrB7gB,QAASqB,KAAKid,yBAEtB,GAAC,CAAApd,IAAA,iCAAAC,MAED,SAA+B6f,GACtBxf,EAAAA,GAAAA,QAAUwf,EAAa3f,KAAKtB,MAAMke,uBACnC5c,KAAKzB,SAAS,CAAEqe,qBAAsB+C,GAC9C,GAAC,CAAA9f,IAAA,oBAAAC,MAED,SAAkB8f,GACVA,KAAQ5f,KAAKtB,MAAMme,eACnB7c,KAAKzB,SAAS,CAAEid,YAAaoE,IAG7B5f,KAAKzB,SAAS,CAAEid,YAAa,IAErC,GAAC,CAAA3b,IAAA,wBAAAC,MAED,WACI,OAAOE,KAAKtB,MAAMke,qBAAqBjF,QAAO,SAACkI,EAAKjB,GAAE,OAAKiB,EAAMzT,SAASwS,EAAGkB,YAAa,GAAG,GAAE,EACnG,GAAC,CAAAjgB,IAAA,SAAAC,MAED,WACI,OACI2B,EAAAA,EAAAA,MAAA,OAAAL,SAAA,EACID,EAAAA,EAAAA,KAAA,OAAKU,GAAG,UAAUmB,MAAO,CAAEqH,SAAU,WAAYC,IAAK,EAAG8I,KAAM,EAAG/M,MAAO,QAASD,OAAQ,QAAS2Z,WAAY,qBAAsBhB,QAAS,OAAQiB,OAAQ,OAE9Jve,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yCAAyC,wBAAmBG,GAAG,gBAAeT,SAAA,EACzFD,EAAAA,EAAAA,KAAC8e,GAAiB,KAClB9e,EAAAA,EAAAA,KAAC+e,GAAsB,KACvB/e,EAAAA,EAAAA,KAACgf,GAAmB,KACpBhf,EAAAA,EAAAA,KAACif,GAAiB,QAGtB3e,EAAAA,EAAAA,MAAA,QAAMI,GAAG,QAAQK,IAAKlC,KAAKwd,QAAS6C,SAAUrgB,KAAKud,qBAAqBnc,SAAA,EACpED,EAAAA,EAAAA,KAAA,SAAOQ,KAAK,SAASZ,KAAK,QAAQjB,MAAOwE,SAASqX,cAAc,sBAAsB2E,WACtF7e,EAAAA,EAAAA,MAAA,OAAKC,UAAU,OAAMN,SAAA,EACjBD,EAAAA,EAAAA,KAACiV,GAAiB,CAAClU,IAAKlC,KAAKyM,MAAOiL,sBAAuB1X,KAAKkd,0BAA2B3F,kBAAmBvX,KAAKmd,wBAElHnd,KAAKgd,iBACF7b,EAAAA,EAAAA,KAACof,EAAAA,SAAQ,CAACC,UAAUrf,EAAAA,EAAAA,KAAA,OAAAC,SAAK,eAAiBA,UACtCD,EAAAA,EAAAA,KAACqb,GAAa,CACVE,UAAW1c,KAAKtB,MAAMge,UAAWI,KAAM9c,KAAKtB,MAAMoe,KAClDH,eAAgB3c,KAAKtB,MAAMie,eAC3B8D,sBAAuBzgB,KAAKod,0BAC5BsD,2BAA4B1gB,KAAKqd,oCAGzClc,EAAAA,EAAAA,KAACof,EAAAA,SAAQ,CAACC,UAAUrf,EAAAA,EAAAA,KAAA,OAAAC,SAAK,eAAiBA,UACtCD,EAAAA,EAAAA,KAACib,GAAS,CAACM,UAAW1c,KAAKtB,MAAMge,UAC7BC,eAAgB3c,KAAKtB,MAAMie,eAC3B8D,sBAAuBzgB,KAAKod,0BAC5BsD,2BAA4B1gB,KAAKqd,oCAI7Clc,EAAAA,EAAAA,KAACuY,GAAO,CAAC8B,YAAaxb,KAAKtB,MAAM8c,YAAalB,kBAAmBta,KAAKtB,MAAMme,eAAe7c,KAAKtB,MAAM8c,cAAgB,CAAC,EAAGmF,YAAa3gB,KAAKtB,MAAMwf,cAAgB,CAAC,GAAGle,KAAKtB,MAAM8c,mBAIrLra,EAAAA,EAAAA,KAAA,OAAKO,UAAU,SAAa,KAE5BD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sIAAqIN,SAAA,EAChJD,EAAAA,EAAAA,KAAC+a,GAAU,CACPa,wBAAyB/c,KAAKtB,MAAMqe,wBAAyB6D,0BAA2B5gB,KAAKtB,MAAMke,qBAAqBvc,OAAQwgB,sBAAuB7gB,KAAK6gB,wBAC5JC,mBAAoB9gB,KAAKtB,MAAM8c,eAGnC/Z,EAAAA,EAAAA,MAAA,SAAOC,UAAU,iEAAgEN,SAAA,EAC7ED,EAAAA,EAAAA,KAAA,SAAOQ,KAAK,WAAWE,GAAG,iBAAiB,+BAE/CV,EAAAA,EAAAA,KAAClD,EAAY,CAACiE,IAAKlC,KAAKyd,OAAQld,cAAeP,KAAKsd,4BAMxE,IAAC,CA7QY,CAAShb,EAAAA,WAkRpB6d,GAAmB,SAAA9J,GAAA,SAAA8J,IAAA,OAAA9hB,GAAA,KAAA8hB,GAAA7hB,GAAA,KAAA6hB,EAAA3Y,UAAA,QAAA5H,GAAAugB,EAAA9J,GAAAsH,GAAAwC,EAAA,EAAAtgB,IAAA,SAAAC,MACrB,WACI,OACIqB,EAAAA,EAAAA,KAAA,OACI,YAAU,eACVU,GAAG,gCACHmB,MAAO,CAAE+b,QAAS,QAAS3d,UAC3BD,EAAAA,EAAAA,KAAA,OACIO,UAAU,4DAA2DN,SAAC,uCAKtF,IAAC,CAboB,CAASkB,EAAAA,WAgB5B4d,GAAsB,SAAAa,GAAA,SAAAb,IAAA,OAAA7hB,GAAA,KAAA6hB,GAAA5hB,GAAA,KAAA4hB,EAAA1Y,UAAA,QAAA5H,GAAAsgB,EAAAa,GAAApD,GAAAuC,EAAA,EAAArgB,IAAA,SAAAC,MACxB,WACI,OAAQqB,EAAAA,EAAAA,KAAA,OACJ,YAAU,eACVU,GAAG,mCACHmB,MAAO,CAAE+b,QAAS,QAAS3d,UAC3BD,EAAAA,EAAAA,KAAA,OACIO,UAAU,4DAA2DN,SAAC,uCAKlF,IAAC,CAZuB,CAASkB,EAAAA,WAe/B2d,GAAiB,SAAAe,GAAA,SAAAf,IAAA,OAAA5hB,GAAA,KAAA4hB,GAAA3hB,GAAA,KAAA2hB,EAAAzY,UAAA,QAAA5H,GAAAqgB,EAAAe,GAAArD,GAAAsC,EAAA,EAAApgB,IAAA,SAAAC,MACnB,WACI,OAAQqB,EAAAA,EAAAA,KAAA,OACJ,YAAU,eACVU,GAAG,8BACHmB,MAAO,CAAE+b,QAAS,QAAS3d,UAC3BD,EAAAA,EAAAA,KAAA,OACIO,UAAU,4DAA2DN,SAAC,0DAKlF,IAAC,CAZkB,CAASkB,EAAAA,WAe1B8d,GAAiB,SAAAa,GAAA,SAAAb,IAAA,OAAA/hB,GAAA,KAAA+hB,GAAA9hB,GAAA,KAAA8hB,EAAA5Y,UAAA,QAAA5H,GAAAwgB,EAAAa,GAAAtD,GAAAyC,EAAA,EAAAvgB,IAAA,SAAAC,MACnB,WACI,OACIqB,EAAAA,EAAAA,KAAA,OACI,YAAU,eACVU,GAAG,8BACHmB,MAAO,CAAE+b,QAAS,QAAS3d,UAC3BD,EAAAA,EAAAA,KAAA,OACIO,UAAU,yCAAwCN,SAAC,gEAKnE,IAAC,CAbkB,CAASkB,EAAAA,U,4BCzUrB9B,E,uCAJX0gB,EAAAA,EAAO1gB,EAAIA,KAIAA,EA6FT2gB,GAvFIC,GAAGC,QAAU,WACX,OAAOrhB,KAAKshB,KAAK,YAAY,GAAMjS,SAAS,WAChD,EAQA7O,EAAE4gB,GAAGG,OAAS,WACV,OAAOvhB,KAAKshB,KAAK,YAAY,GAAOhK,YAAY,WACpD,EAOA9W,EAAE4gB,GAAGI,MAAQ,WACT,OAAOxhB,KAAKshB,KAAK,WAAW,EAChC,EAOA9gB,EAAE4gB,GAAGK,QAAU,WACX,OAAOzhB,KAAKshB,KAAK,WAAW,EAChC,EAKA9gB,EAAE8D,UAAUod,QAAQ,CAChBrX,SAAU,CACNsX,GAAI,mBACJC,GAAI,aACJC,MAAO,SAAUxX,EAAUyX,GACvBthB,EAAER,MAAMsY,IAAIjO,GACZ7J,EAAE,SACG6O,SAAS,SACTA,SAASyS,EAASC,UAClB1S,SAASyS,EAASE,YAClBC,SAASjiB,KAClB,GAEJkiB,MAAO,sBACP9S,MAAM,EACND,MAAM,EACNmR,QAAS,WACL,IAAIjf,EAAQb,EAAER,MAAM+C,KAAK,SACzB,QAAK1B,GACYb,EAAE2hB,UAAU9gB,EAEjC,IAMJb,EAAE4hB,YAAc,WACZ,IAAIC,GAAS,EAQb,OAPA7hB,EAAE,UAAUyR,MAAK,WACb,IAAIyJ,EAAQlb,EAAER,MAAM+P,KAAK,YACzB,GAAI2L,EAEA,QADA2G,EAAS3G,EAAM4G,QAGvB,IACOD,CACX,EAQA7hB,EAAE4gB,GAAG9gB,OAAS,WACVN,KAAKuiB,SAASC,OAAO,SAAU,CAC3BnL,UAAW,OACXoL,SAAU,GACVC,MAAO,GACR,IACP,C,s5YC7EAviB,GAAI,IAAAwiB,OAAM,GAEdxiB,EAAEA,EAAIA,EAEN,S","sources":["webpack://SequenceServer/./public/js/search_button.js","webpack://SequenceServer/./public/js/exporter.js","webpack://SequenceServer/./public/js/svgExporter.js","webpack://SequenceServer/./public/js/collapse_preferences.js","webpack://SequenceServer/./public/js/grapher.js","webpack://SequenceServer/./public/js/visualisation_helpers.js","webpack://SequenceServer/./public/js/utils.js","webpack://SequenceServer/./public/js/hits_overview.js","webpack://SequenceServer/./public/js/length_distribution.js","webpack://SequenceServer/./public/js/fastq_to_fasta.js","webpack://SequenceServer/./public/js/query.js","webpack://SequenceServer/./public/js/options.js","webpack://SequenceServer/./public/js/null_plugins/query_stats.js","webpack://SequenceServer/./public/js/form.js","webpack://SequenceServer/./public/js/jquery_world.js","webpack://SequenceServer/./node_modules/underscore/modules/index-default.js"],"sourcesContent":["import React, { Component, createRef } from 'react';\nimport _ from 'underscore';\n\n/**\n * SearchButton widget.\n */\nexport class SearchButton extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            methods: [],\n            hasQuery: false,\n            hasDatabases: false,\n            dropdownVisible: false,\n            messageTooltip: \"\",\n            titleTooltip: \"\",\n            hideMessageTooltip: false\n        };\n        this.changeAlgorithm = this.changeAlgorithm.bind(this);\n        this.decorate = this.decorate.bind(this);\n        this.setMessageTooltipButton = this.setMessageTooltipButton.bind(this);\n        this.setTitleTooltipButton = this.setTitleTooltipButton.bind(this);\n        this.renderButton = this.renderButton.bind(this);\n        this.inputGroup = this.inputGroup.bind(this);\n        this.handleMouseOver = this.handleMouseOver.bind(this)\n        this.handeMouseOut = this.handeMouseOut.bind(this)\n        this.inputGroupRef = createRef();\n    }\n\n    componentDidMount() {\n        this.timeout = setTimeout(() => this.setState({ hideMessageTooltip: true}), 3000)\n    }\n\n    shouldComponentUpdate(props, state) {\n        return !_.isEqual(state.methods, this.state.methods) ||\n            state.dropdownVisible !== this.state.dropdownVisible ||\n            state.messageTooltip !== this.state.messageTooltip ||\n            state.titleTooltip !== this.state.titleTooltip ||\n            state.hideMessageTooltip !== this.state.hideMessageTooltip;\n    }\n\n    componentDidUpdate(_prevProps, prevState) {\n        if (!_.isEqual(prevState.methods, this.state.methods)) {\n            if (this.state.methods.length > 0) {\n                this.inputGroup().wiggle();\n                this.props.onAlgoChanged(this.state.methods[0]);\n            } else {\n                this.props.onAlgoChanged('');\n            }\n        }\n    }\n\n    inputGroup() {\n        return $(this.inputGroupRef.current);\n    }\n\n    /**\n * Change selected algorithm.\n *\n * NOTE: Called on click on dropdown menu items.\n */\n    changeAlgorithm(method) {\n        var methods = this.state.methods.slice();\n        methods.splice(methods.indexOf(method), 1);\n        methods.unshift(method);\n        this.setState({\n            methods: methods,\n            dropdownVisible: false,\n        });\n    }\n\n    /**\n * Given, for example 'blastp', returns blast<strong>p</strong>.\n */\n    decorate(name) {\n        return name\n            .match(/(.?)(blast)(.?)/)\n            .slice(1)\n            .map(function (token, _) {\n                if (token) {\n                    if (token !== 'blast') {\n                        return <strong key={token}>{token}</strong>;\n                    } else {\n                        return token;\n                    }\n                }\n            });\n    }\n\n    toggleDropdownVisibility = () => {\n        this.setState(prevState => ({\n            dropdownVisible: !prevState.dropdownVisible\n        }));\n    }\n    \n    setMessageTooltipButton() {\n        if (!this.state.hasQuery && !this.state.hasDatabases) {\n            this.setState({ messageTooltip: 'You must enter a query sequence and select one or more databases above before you can run a search!' });\n        } else if (this.state.hasQuery && !this.state.hasDatabases) {\n            this.setState({ messageTooltip: 'You must select one or more databases above before you can run a search!' });\n        } else if (!this.state.hasQuery && this.state.hasDatabases) {\n            this.setState({ messageTooltip: 'You must enter a query sequence above before you can run a search!' });\n        }\n    }\n\n    setTitleTooltipButton() {\n        var title = 'Click to BLAST or press Ctrl+Enter.';\n\n        this.setState({ titleTooltip: title });\n\n        if (this.state.methods.length > 1) {\n            this.setState({\n                titleTooltip: title +=\n                    ' Click dropdown button on the right for other' +\n                    ' BLAST algorithms that can be used.'\n             });\n        }\n    }\n\n    handeMouseOut() {\n        clearTimeout(this.timeout);\n        this.setState({ hideMessageTooltip: false });\n    }\n\n    handleMouseOver() {\n        this.setMessageTooltipButton();\n        this.setTitleTooltipButton();\n        this.timeout = setTimeout(() => this.setState({ hideMessageTooltip: true}), 3000)\n    }\n\n    renderButton(method, multi, methods) {\n        return (\n            <div className=\"flex\">\n                <button\n                    type=\"submit\"\n                    className={`${method ? 'hover:bg-seqorange focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-seqorange ' : 'opacity-50 cursor-not-allowed '}uppercase w-full md:w-auto flex text-xl justify-center py-2 px-16 border border-transparent rounded-md shadow-sm text-white bg-seqblue`}\n                    id=\"method\"\n                    name=\"method\"\n                    value={method}\n                    disabled={!method}\n                >\n                    {this.decorate(method || 'blast')}\n                </button>\n\n                {multi && (\n                    <div className=\"ui--multi-dropdown\">\n                        <button\n                            className=\"text-xl bg-seqblue rounded-r-md text-white p-2 border border-seqblue hover:bg-seqorange focus:outline-none focus:ring-1 focus:ring-seqorange -ml-8\"\n                            type=\"button\"\n                            onClick={this.toggleDropdownVisibility}\n                        >\n                            <i className=\"fas fa-caret-down w-6 h-6 fill-current\"></i>\n                            <span className=\"sr-only\">Other methods</span>\n                        </button>\n\n                        <div id=\"dropdown\"\n                            className={`z-10 my-2 uppercase bg-blue-300 divide-y divide-gray-100 rounded-lg shadow absolute left-0 bottom-12 w-full text-xl text-center ${this.state.dropdownVisible ? '' : 'hidden'}`}>\n                            <ul className=\"text-gray-700\" aria-labelledby=\"dropdownDefaultButton\">\n                                {_.map(\n                                    methods.slice(1),\n                                    _.bind(function (method) {\n                                        return (\n                                            <li\n                                                key={method}\n                                                onClick={_.bind(function () {\n                                                    this.changeAlgorithm(method);\n                                                }, this)}\n                                            >\n                                                <a href=\"#\" className=\"block px-4 py-2 hover:bg-blue-400 rounded-lg\">{method}</a>\n                                            </li>\n                                        );\n                                    }, this)\n                                )}\n                            </ul>\n                        </div>\n                    </div>\n                )}\n            </div>\n        )\n    }\n\n    render() {\n        var methods = this.state.methods;\n        var method = methods[0];\n        var multi = methods.length > 1;\n\n        return (\n            <div\n                className=\"my-4 md:my-2 flex justify-end w-full md:w-auto relative\"\n                id=\"methods\"\n                ref={this.inputGroupRef}\n                onMouseOver={this.handleMouseOver}\n                onMouseOut={this.handeMouseOut}\n            >\n                <div className=\"relative flex flex-col items-center group\">\n                    <div className=\"flex items-center w-full\">\n                        {this.renderButton(method, multi, methods)}\n                        { !this.state.dropdownVisible &&\n                            <div className=\"absolute hidden bottom-11 items-center flex-col-reverse group-hover:flex w-full\">\n                                <div className=\"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mt-1 -mr-px tooltip-arrow-rotate\"></div>\n                                <span className=\"relative z-10 p-2 search-button-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md\">\n                                    { !this.state.hasQuery || !this.state.hasDatabases ? (\n                                        this.state.hideMessageTooltip ?  <>{this.state.titleTooltip}</> : this.state.messageTooltip\n                                    ) : <> {this.state.titleTooltip}</>}\n                                </span>\n                            </div>\n                        }\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","var d3 = require('d3');\n\nexport function download_url(url, filename) {\n    var a = d3.select('body').append('a')\n    .attr('download', filename)\n    .style('display', 'none')\n    .attr('href', url);\n\n    a.node().click();\n    setTimeout(function() {\n        a.remove();\n    }, 100);\n}\n\nexport function generate_blob_url(blob) {\n    const url = window.URL.createObjectURL(blob);\n    return url;\n}\n\nexport function download_blob(blob, filename) {\n    if (typeof window.navigator.msSaveOrOpenBlob !== 'undefined') {\n        window.navigator.msSaveOrOpenBlob(blob, filename);\n    }else{\n        download_url(generate_blob_url(blob), filename);\n    }\n}\n\nexport function sanitize_filename(str) {\n    var san = str.replace(/[^a-zA-Z0-9=_\\-]/g, '_');\n    // Replace runs of underscores with single one.\n    san = san.replace(/_{2,}/g, '_');\n    // Remove any leading or trailing underscores.\n    san = san.replace(/^_/, '').replace(/_$/, '');\n    return san;\n}\n","/**\n * svgExporter.js\n *\n * Exports <svg> as .svg or .png.\n *\n * Borrowed and modified from Kablammo which in turn is based on\n * https://github.com/NYTimes/svg-crowbar.\n *\n */\nimport * as Exporter from './exporter';\nimport * as d3 from 'd3';\n\n/**\n * Exports the given <svg> DOM node as a .svg file.\n */\nvar export_as_svg = function (svg, filename) {\n    var blob = new Blob([serialize_svg(svg)], { type: 'text/xml' });\n    filename = Exporter.sanitize_filename(filename) + '.svg';\n    Exporter.download_blob(blob, filename);\n};\n\n/**\n * Exports the given <svg> DOM node as a .png file.\n */\nvar export_as_png = function (svg, filename) {\n    if (typeof window.navigator.msSaveOrOpenBlob !== 'undefined') {\n        alert('Exporting PNG images is not supported in Internet Explorer. Please use Chrome or Firefox.');\n        return;\n    }\n\n    var raster_scale_factor = 5;\n\n    var canvas = document.getElementById('png-exporter');\n    var $svg = $(svg);\n\n    canvas.height = $svg.height() * raster_scale_factor;\n    canvas.width = $svg.width() * raster_scale_factor;\n\n    var img = new Image();\n    img.onload = function() {\n        var context = canvas.getContext('2d');\n        context.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n        filename = Exporter.sanitize_filename(filename) + '.png';\n        Exporter.download_url(canvas.toDataURL('image/png'), filename);\n    };\n\n    var svgString = serialize_svg(svg);\n    var encodedSvg = encodeURIComponent(svgString).replace(/%([0-9A-F]{2})/gi, function(match, p1) {\n        return String.fromCharCode('0x' + p1);\n    });\n    img.src = 'data:image/svg+xml;base64,' + window.btoa(encodedSvg);\n};\n\nvar serialize_svg = function(svg) {\n    // Clone svg first so that none of our changes to affect the actual SVG.\n    svg = svg.cloneNode(true);\n\n    d3.select(svg).attr('version', '1.1')\n        .insert('defs', ':first-child')\n        .append('style')\n        .attr('class', 'exported-css')\n        .attr('type', 'text/css')\n        .node()\n        .textContent = get_styles();\n\n    svg.removeAttribute('xmlns');\n    svg.removeAttribute('xlink');\n    svg.setAttributeNS(d3.namespaces.xmlns, 'xmlns', d3.namespaces.svg);\n    svg.setAttributeNS(d3.namespaces.xmlns, 'xmlns:xlink', d3.namespaces.xlink);\n\n    var source = (new XMLSerializer()).serializeToString(svg);\n    var doctype = '<?xml version=\"1.0\" standalone=\"no\"?><!DOCTYPE svg PUBLIC ' +\n        '\"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">';\n    return doctype + source;\n};\n\nvar get_styles = function () {\n    var styles = '';\n\n    for (var i = 0; i < document.styleSheets.length; i++) {\n        (function process_ss(ss) {\n            // See if we can access ss.cssRules. Note that cssRules respects\n            // same-origin policy, as per\n            // https://code.google.com/p/chromium/issues/detail?id=49001#c10.\n            try {\n                // In IE and Chrome, if stylesheet originates from a different\n                // domain, ss.cssRules simply won't exist. In Firefox, if\n                // stylesheet originates from a different domain, trying\n                // to access ss.cssRules will throw a SecurityError.\n                // Hence, we must use // try/catch to detect this\n                // condition in Firefox.\n                if (!ss.cssRules)\n                    return;\n            } catch (e) {\n                // Rethrow exception if it's not a SecurityError.\n                if (e.name !== 'SecurityError')\n                    throw e;\n                return;\n            }\n\n            // Stylesheet should be included in SVG and has accessible cssRules, so\n            // serialize rules into string.\n            for (var i = 0; i < ss.cssRules.length; i++) {\n                let rule = ss.cssRules[i];\n                if (rule.type === CSSRule.IMPORT_RULE) {\n                    process_ss(rule.styleSheet);\n                } else {\n                    // TODO: Illustrator will crash on descendant selectors. To\n                    // circumvent this, we should ignore such selectors.\n\n                    let selectorText = rule.selectorText;\n                    if (selectorText && selectorText.indexOf('svg') !== -1)\n                        styles += '\\n' + rule.cssText;\n                }\n            }\n        })(document.styleSheets[i]);\n    }\n\n    return styles;\n};\n\nvar handle_click = function (export_callback) {\n    return function () {\n        var $svg = $(this).parents('.grapher').find('svg');\n        export_callback($svg[0], $svg.attr('data-name'));\n        return false;\n    };\n};\n\nvar $body = $('body');\n$body.on('click', '.export-to-svg', handle_click(export_as_svg));\n$body.on('click', '.export-to-png', handle_click(export_as_png));\n","export default class CollapsePreferences {\n    constructor(component, defaultCollapsed = false) {\n        this.component = component;\n        this.defaultCollapsed = defaultCollapsed;\n        this.storageKey = 'sequenceServerCollapseStates';\n        this.collapseStates = JSON.parse(localStorage.getItem(this.storageKey)) || {};\n    }\n\n    toggleCollapse() {\n        let currentlyCollapsed = this.component.state.collapsed;\n        this.component.setState({ collapsed: !currentlyCollapsed });\n\n        this.collapseStates[this.component.name] = !currentlyCollapsed;\n        localStorage.setItem(this.storageKey, JSON.stringify(this.collapseStates));\n    }\n\n    preferenceStoredAsCollapsed() {\n        if (this.component.name in this.collapseStates) {\n            return this.collapseStates[this.component.name];\n        }\n        return this.defaultCollapsed;\n    }\n\n    renderCollapseIcon() {\n        return this.component.state.collapsed ? this.plusIcon() : this.minusIcon();\n    }\n\n    minusIcon() {\n        return <i className=\"print:!hidden fa-regular fa-square-minus\"></i>;\n    }\n\n    plusIcon() {\n        return <i className=\"print:!hidden fa-regular fa-square-plus\"></i>;\n    }\n}\n","import _ from 'underscore';\nimport React, { createRef, useState, useEffect, useCallback } from 'react';\n\nimport './svgExporter'; // create handlers for SVG and PNG download buttons\nimport CollapsePreferences from './collapse_preferences';\nimport useDetectPrint from \"react-detect-print\";\n\n// Grapher is a function that takes a Graph class and returns a React component.\n// This React component provides HTML boilerplate to add heading, to make the\n// graphs collapsible, to redraw graphs when window is resized, and SVG and PNG\n// export buttons and functionality.\nexport default function Grapher(Graph) {\n    return function Component(props) {\n        const alwaysShowName = Graph.alwaysShowName === undefined ? false : Graph.alwaysShowName();\n        const printing = useDetectPrint();\n        const name = Graph.name(props);\n        const [width, setWidth] = useState(window.innerWidth);\n        const [collapsed, setCollapsed] = useState(false);\n        const svgContainerRef = createRef();\n        let graph = null;\n\n        const graphId = () => Graph.graphId(props)\n\n        const graphLinksJSX = () => {\n            return (\n                <div className=\"hit-links float-right text-right text-blue-300 h-4 print:hidden\">\n                    <a href=\"#\" className=\"btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer export-to-svg\">\n                        <i className=\"fa fa-download\" /> SVG\n                    </a>\n                    <span className=\"line px-1\">|</span>\n                    <a href=\"#\" className=\"btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer export-to-png\">\n                        <i className=\"fa fa-download\" /> PNG\n                    </a>\n                </div>\n            );\n        }\n\n        const header = () => {\n            if(Graph.canCollapse()) {\n                return <div className=\"grapher-header pr-px\">\n                    <h4\n                        className=\"inline-block pl-px m-0 caption cursor-pointer text-sm\"\n                        onClick={() => collapsePreferences.toggleCollapse()}\n                    >\n                        {collapsePreferences.renderCollapseIcon()}\n                        <span className=\"print:hidden\">&nbsp;</span>{Graph.name(props)}\n                    </h4>\n                    {!collapsed && graphLinksJSX()}\n                </div>;\n            } else if (alwaysShowName) {\n                return <div className=\"grapher-histogram-header\" style={{ position: 'relative' }}>\n                    <h4 className=\"caption\">&nbsp;{Graph.name(props)}</h4>\n                    <div className=\"pull-right\" style={{ position: 'absolute', top: 0, right: 0 }}>\n                        {!collapsed && graphLinksJSX()}\n                    </div>\n                </div>;\n            } else {\n                return <div className=\"pr-px\">\n                    {!collapsed && graphLinksJSX()}\n                </div>;\n            }\n        }\n\n        const svgContainerJSX = () => {\n            var cssClasses = Graph.className() + ' svg-container hidden';\n            if (!collapsed) cssClasses += ' !block';\n            return (\n                <div\n                    ref={svgContainerRef}\n                    id={graphId()}\n                    className={cssClasses}\n                ></div>\n            );\n        }\n\n        const svgContainer = () => {\n            return $(svgContainerRef.current);\n        }\n\n        const draw = (printing = false) => {\n            let graphWidth = 'auto';\n            if (printing) graphWidth = '900';\n            // Clean slate.\n            svgContainer().empty();\n            graph = null;\n\n            // Draw if uncollapsed.\n            if (collapsed) return;\n\n            svgContainer().width(graphWidth);\n            graph = new Graph(svgContainer(), props);\n            svgContainer()\n                .find('svg')\n                .attr('data-name', Graph.dataName(props));\n        }\n\n        useEffect(() => {\n            // Attach a debounced listener to handle window resize events \n            // Updates the width state with the current window width, throttled to run at most once every 125ms\n            const handleResize = _.debounce(() => setWidth(window.innerWidth), 125);\n            window.addEventListener(\"resize\", handleResize);\n\n            const isCollapsed = collapsePreferences.preferenceStoredAsCollapsed();\n            setCollapsed(Graph.canCollapse() && (props.collapsed || isCollapsed))\n            draw();\n\n            return () => window.removeEventListener(\"resize\", handleResize)\n        }, [])\n\n        useEffect(() => {\n            draw(printing);\n        }, [printing, width])\n\n        const setState = (state) => {\n            setCollapsed(state.collapsed)\n        }\n\n        const collapsePreferences = new CollapsePreferences({name: name, state: { collapsed: collapsed }, setState: setState});\n\n        if (Graph.name(props) === null) {\n            return(null);\n        } else {\n            const printCss = collapsed ? 'print:hidden' : '';\n            const cssClasses = Graph.className() + ' grapher' + printCss;\n            return (\n                <div className={cssClasses}>\n                    {header()}\n                    {svgContainerJSX()}\n                </div>\n            )\n        }\n    }\n}\n","import _ from 'underscore';\nimport * as d3 from 'd3';\nexport function get_colors_for_evalue(evalue, hits) {\n    var colors = d3.scaleLog()\n        .domain([\n            d3.min([1e-5, d3.min(hits.map(function (d) {\n                if (parseFloat(d.evalue) === 0.0) return undefined;\n                return d.evalue;\n            }))]),\n            d3.max(hits.map(function (d) {\n                return d.evalue;\n            }))\n        ])\n        .range([0,0.8]);\n    var rgb = colors(evalue);\n    return d3.hsl(20, 0.82 , rgb);\n}\n\nexport function toLetters(num) {\n    var mod = num % 26,\n        pow = num / 26 | 0,\n        out = mod ? String.fromCharCode(96 + mod) : (--pow, 'z');\n    return pow ? toLetters(pow) + out : out;\n}\n\nexport function getPrefix(str) {\n    if (str.length === 0) return '';\n\n    var lastChar = str.charAt(str.length - 1);\n    return /[a-zA-Z]/.test(lastChar) ? lastChar : '';\n}\n\n/**\n* Defines how ticks will be formatted.\n *\n * Examples: 200 aa, 2.4 kbp, 7.6 Mbp.\n *\n * Borrowed from Kablammo. Modified by Priyam based on https://github.com/mbostock/d3/issues/1722.\n */\nexport function tick_formatter(scale, seq_type) {\n    const prefix = d3.format('~s')\n    const suffixes = {amino_acid: 'aa', nucleic_acid: 'bp'};\n\n    return function (d) {\n        const formatted = prefix(d);\n\n        return `${formatNumberUnits(formatted)}${suffixes[seq_type]}`;\n    };\n}\n\nexport function formatNumberUnits(number) {\n    const suffix = number.replace(/[0-9.]/g, '');\n    const numericPart = parseFloat(number).toFixed(2);\n    // Round to 1 decimal place\n    const rounded = Math.round(numericPart * 10) / 10;\n\n    return `${rounded % 1 === 0 ? rounded.toFixed(0) : rounded} ${suffix}`;\n}\n\nexport function get_seq_type(algorithm) {\n    var SEQ_TYPES = {\n        blastn: {\n            query_seq_type:   'nucleic_acid',\n            subject_seq_type: 'nucleic_acid'\n        },\n        blastp: {\n            query_seq_type:   'amino_acid',\n            subject_seq_type: 'amino_acid'\n        },\n        blastx: {\n            query_seq_type:   'nucleic_acid',\n            subject_seq_type: 'amino_acid'\n        },\n        tblastx: {\n            query_seq_type:   'nucleic_acid',\n            subject_seq_type: 'nucleic_acid'\n        },\n        tblastn: {\n            query_seq_type:   'amino_acid',\n            subject_seq_type: 'nucleic_acid'\n        }\n    };\n    return SEQ_TYPES[algorithm];\n}\n\nexport function prettify_evalue(evalue) {\n    var matches = evalue.toString().split('e');\n    var base  = matches[0];\n    var power = matches[1];\n\n    if (power)\n    {\n        var s = parseFloat(base).toFixed(2);\n        var element = '<span>'+s+' &times; 10<sup>'+power+'</sup></span>';\n        return element;\n    }\n    else {\n        if (!(base % 1==0))\n            return parseFloat(base).toFixed(2);\n        else\n            return base;\n    }\n}\n","import React from 'react';\n\nvar Utils = {\n    /***********************************\n     * Formatters for hits & hsp table *\n     ***********************************/\n\n    // Formats an array of two elements as \"first (last)\".\n    format_2_tuple: function (tuple) {\n        return (tuple[0] + ' (' + tuple[tuple.length - 1] + ')');\n    },\n\n    /**\n     * Returns fraction as percentage\n     */\n    inPercentage: function (num, den) {\n        var x = (num * 100.0 / den).toFixed(1);\n        if (x % 1 == 0) {\n            x = parseInt(x, 10);\n            return `${x}%`;\n        }\n        else {\n            return `${x}%`;\n        }\n    },\n\n    /**\n     * Returns fractional representation as String.\n     */\n    inFraction: function (num , den) {\n        return num + '/' + den;\n    },\n\n    /**\n     * Returns given Float as String formatted to two decimal places.\n     */\n    inTwoDecimal: function (num) {\n        return num.toFixed(2);\n    },\n\n    /**\n     * Returns zero if num is zero. Returns two decimal representation of num\n     * if num is between [1..10). Returns num in scientific notation otherwise.\n     */\n    inExponential: function (num) {\n        // Nothing to do if num is 0.\n        if (num === 0) {\n            return 0;\n        }\n\n        // Round to two decimal places if in the rane [1..10).\n        if (num >= 1 && num < 10)\n        {\n            return this.inTwoDecimal(num);\n        }\n\n        // Return numbers in the range [0..1) and [10..Inf] in\n        // scientific format.\n        var exp = num.toExponential(2);\n        var parts = exp.split('e');\n        var base  = parts[0];\n        var power = parts[1];\n        return <span>{base}&times;10<sup>{power}</sup></span>;\n    }\n};\n\nexport default Utils;\n","import * as d3 from 'd3';\nimport _ from 'underscore';\nimport Grapher from 'grapher';\nimport * as Helpers from './visualisation_helpers';\nimport Utils from './utils';\n\nclass Graph {\n    static canCollapse() {\n        return true;\n    }\n\n    static name() {\n        return 'Graphical overview of aligning hit sequences to the query';\n    }\n\n    static className() {\n        return 'alignment-overview';\n    }\n\n    static graphId(props) {\n        return 'alignment_'+props.query.number;\n    }\n\n    static dataName(props) {\n        return 'Alignment-Overview-'+props.query.id;\n    }\n\n    constructor($svgContainer, props) {\n        this.svg_container = $svgContainer;\n        var $queryDiv = $svgContainer.parents('.resultn');\n        var hits = this.extractData(props.query.hits, props.query.number);\n        this.graphIt($queryDiv, $svgContainer, 0, 20, null, hits);\n    }\n\n    extractData(query_hits, number) {\n        var hits = [];\n        query_hits.map(function (hit) {\n            var _hsps = [];\n            var hsps = hit.hsps;\n            _.each(hsps, function (hsp) {\n                var _hsp = {};\n                _hsp.hspEvalue = hsp.evalue;\n                _hsp.hspStart = hsp.qstart;\n                _hsp.hspEnd = hsp.qend;\n                _hsp.hspFrame = hsp.sframe;\n                _hsp.hspId = 'Query_' + number + '_hit_' + hit.number + '_hsp_' + hsp.number;\n                _hsp.hspIdentity = hsp.identity;\n                _hsp.hspGaps = hsp.gaps;\n                _hsp.hspPositives = hsp.positives;\n                _hsp.hspLength = hsp.length;\n                _hsps.push(_hsp);\n            });\n            _hsps.hitId = hit.id;\n            _hsps.hitDef = 'Query_'+number+'_hit_'+hit.number;\n            _hsps.hitEvalue = hit.hsps[0].evalue;\n            hits.push(_hsps);\n        });\n        return hits;\n    }\n\n    setupClick($graphDiv) {\n        $('a', $graphDiv).click(function (evt) {\n            evt.preventDefault();\n            evt.stopPropagation();\n            window.location.hash = $(this).attr('href');\n        });\n    }\n\n    graphControls($queryDiv, $graphDiv, isInit, opts, hits) {\n        var MIN_HITS_TO_SHOW = 20;\n\n        var totalHits, shownHits, lessButton, moreButton;\n\n        var countHits = function () {\n            totalHits = hits.length;\n            shownHits = $queryDiv.find('.ghit > g').length;\n        };\n\n        var setupButtons = function($queryDiv, $graphDiv) {\n            $graphDiv\n                .append(\n                    $('<button/>')\n                        .addClass('btn btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer more')\n                        .attr('type', 'button')\n                        .attr('data-parent-query', $queryDiv.attr('id'))\n                        .html('View More&nbsp;')\n                        .append(\n                            $('<i/>')\n                                .html('&nbsp;&nbsp;')\n                                .addClass('fa fa-angle-double-down')\n                        ),\n                    $('<button/>')\n                        .addClass('btn btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer less')\n                        .attr('type', 'button')\n                        .attr('data-parent-query', $queryDiv.attr('id'))\n                        .html('View Less&nbsp;')\n                        .append(\n                            $('<i/>')\n                                .html('&nbsp;&nbsp;')\n                                .addClass('fa fa-angle-double-up')\n                        )\n                );\n\n            lessButton = $('.less', $graphDiv);\n            moreButton = $('.more', $graphDiv);\n        };\n\n        var initButtons = function () {\n            countHits();\n            if (totalHits === MIN_HITS_TO_SHOW ||\n            shownHits < MIN_HITS_TO_SHOW) {\n                lessButton.hide();\n                moreButton.hide();\n            }\n            else if (shownHits === totalHits) {\n                moreButton.hide();\n                lessButton.show();\n            }\n            else if (shownHits === MIN_HITS_TO_SHOW) {\n                lessButton.hide();\n                moreButton.show();\n            }\n            else {\n                lessButton.show();\n                moreButton.show();\n            }\n        };\n\n        // Setup view buttons' state properly if called for first time.\n        if (isInit === true) {\n            setupButtons($queryDiv, $graphDiv);\n            initButtons();\n        }\n\n        moreButton.on('click', _.bind(function (e) {\n            countHits();\n            this.graphIt($queryDiv, $graphDiv, shownHits, MIN_HITS_TO_SHOW, opts, hits);\n            initButtons();\n            e.stopPropagation();\n        },this));\n\n        lessButton.on('click', _.bind(function (e) {\n            countHits();\n            var diff = shownHits - MIN_HITS_TO_SHOW;\n\n            // Decrease number of shown hits by defined constant.\n            if (diff >= MIN_HITS_TO_SHOW) {\n                this.graphIt($queryDiv, $graphDiv, shownHits, -MIN_HITS_TO_SHOW, opts, hits);\n                initButtons();\n            }\n            else if (diff !== 0) {\n            // Ensure a certain number of hits always stay in graph.\n                this.graphIt($queryDiv, $graphDiv, shownHits, MIN_HITS_TO_SHOW - shownHits, opts, hits);\n                initButtons();\n            }\n            e.stopPropagation();\n        },this));\n    }\n\n    drawLegend(svg, options, width, height, hits) {\n        var svg_legend = svg.append('g')\n            .attr('transform',\n                'translate(0,' + (height - 1.75 * options.margin) + ')');\n\n        svg_legend.append('rect')\n            .attr('x', 7.5 * (width - 2 * options.margin) / 10)\n            .attr('width', 2 * (width - 4 * options.margin) / 10)\n            .attr('height', options.legend)\n            .attr('fill', 'url(#legend-grad)');\n\n        svg_legend.append('text')\n            .attr('class',' legend-text')\n            .attr('transform', 'translate(0, ' +options.legend +')')\n            .attr('x', 9.5 * (width - 2 * options.margin) / 10 + options.margin / 2)\n            .text('Weaker hits');\n        // .text(function() {\n        //   return Helpers.prettify_evalue(hits[hits.length-1].hitEvalue);\n        // })\n\n        svg_legend.append('text')\n            .attr('class',' legend-text')\n            .attr('transform', 'translate(0, ' + options.legend + ')')\n            .attr('x', 6.7 * (width - 2 * options.margin) / 10 - options.margin / 2)\n            .text('Stronger hits');\n        // .text(function () {\n        //   return Helpers.prettify_evalue(hits[0].hitEvalue);\n        // })\n\n        svg.append('linearGradient')\n            .attr('id', 'legend-grad')\n            .selectAll('stop')\n            .data([\n                {offset: '0%', color: '#000'},\n                {offset: '45%', color: '#c74f14'},\n                {offset: '100%', color: '#f6bea2'}\n            ])\n            .enter()\n            .append('stop')\n            .attr('offset', function (d) {\n                return d.offset;\n            })\n            .attr('stop-color', function (d) {\n                return d.color;\n            });\n    }\n\n    graphIt($queryDiv, $graphDiv, index, howMany, opts, inhits) {\n    /* barHeight: Height of each hit track.\n     * legend: Height reserved for the overview legend.\n     * margin: Margin around the svg element.\n     */\n        var defaults = {\n                barHeight: 4,\n                legend: inhits.length > 1 ? 3 : 0,\n                margin: 20\n            },\n            options = $.extend(defaults, opts);\n        var hits = inhits.slice(0 , index + howMany);\n\n        // Don't draw anything when no hits are obtained.\n        if (hits.length < 1) return false;\n\n        if (index !== 0) {\n        // Currently, we have no good way to extend pre-existing graph\n        // and hence, are removing the old one and redrawing.\n            $graphDiv.find('svg').remove();\n        }\n\n        var queryLen = $queryDiv.data().queryLen;\n        var q_i = $queryDiv.attr('id');\n\n        var width = $graphDiv.width();\n        var height = hits.length * (options.barHeight) +\n                     2 * options.legend + 4 * options.margin;\n\n        // var height = $graphDiv.height();\n\n        var SEQ_TYPES = {\n            blastn: 'nucleic_acid',\n            blastp: 'amino_acid',\n            blastx: 'nucleic_acid',\n            tblastx: 'nucleic_acid',\n            tblastn: 'amino_acid'\n        };\n\n        var svg = d3.select($graphDiv[0])\n            .selectAll('svg')\n            .data([hits])\n            .enter()\n            .insert('svg', ':first-child')\n            .attr('width', width)\n            .attr('height', height)\n            .append('g')\n            .attr('transform', 'translate(' + options.margin / 2 + ', ' + (1.5 * options.margin) + ')');\n\n        var x = d3.scaleLinear().range([0, width - options.margin]);\n\n        x.domain([1, queryLen]);\n\n        var algorithm = $queryDiv.data().algorithm;\n        var formatter = Helpers.tick_formatter(x, SEQ_TYPES[algorithm]);\n\n        var _tValues = x.ticks(11);\n        _tValues.pop();\n\n        var xAxis = d3.axisBottom(x)\n            .tickValues(_tValues.concat([1, queryLen]))\n            .tickFormat(formatter);\n\n        // Attach the axis to DOM (<svg> element)\n        var container = svg.append('g')\n            .attr('transform', 'translate(0, ' + options.margin + ')')\n            .append('g')\n            .attr('class', 'x axis')\n            .call(xAxis);\n\n        // Vertical alignment of ticks\n        container.selectAll('text')\n            .attr('x','25px')\n            .attr('y','2px')\n            .attr('transform','rotate(-90)');\n\n        var y = d3.scaleBand()\n            .range([0, height - 3 * options.margin - 2 * options.legend], 0.3);\n\n        y.domain(hits.map(function (d) {\n            return d.hitId;\n        }));\n\n        var gradScale = d3.scaleLog()\n            .domain([\n                d3.min([1e-5, d3.min(hits.map(function (d) {\n                    if (parseFloat(d.hitEvalue) === 0.0) return undefined;\n                    return d.hitEvalue;\n                }))\n                ]),\n                d3.max(hits.map(function (d) {\n                    return d.hitEvalue;\n                }))\n            ])\n            .range([0,0.8]);\n\n        svg.append('g')\n            .attr('class', 'ghit')\n            .attr('transform', 'translate(0, ' + 1.65 * (options.margin - options.legend) + ')')\n            .selectAll('.hits')\n            .data(hits)\n            .enter()\n            .append('g')\n            .each(function (d,i) {\n                // TODO: Avoid too many variables and improve naming.\n\n                d3.select(this)\n                    .selectAll('.hsp')\n                    .data(d).enter()\n                    .append('a')\n                    .each(function (v, j) {\n                    // Drawing the HSPs connector line using the same\n                    // color as that of the hit track (using lookahead).\n                        var yHspline = y(d.hitId) + options.barHeight / 2;\n                        var hsplineColor = d3.hsl(20, 0.82, gradScale(v.hspEvalue));\n\n                        if (j+1 < d.length) {\n                            if (d[j].hspEnd <= d[j+1].hspStart) {\n                                d3.select(this.parentNode)\n                                    .append('line')\n                                    .attr('x1', x(d[j].hspEnd))\n                                    .attr('y1', yHspline)\n                                    .attr('x2', x(d[j+1].hspStart))\n                                    .attr('y2', yHspline)\n                                    .attr('stroke', hsplineColor);\n                            }\n                            else if (d[j].hspStart > d[j+1].hspEnd) {\n                                d3.select(this.parentNode)\n                                    .append('line')\n                                    .attr('x1', x(d[j+1].hspEnd))\n                                    .attr('y1', yHspline)\n                                    .attr('x2', x(d[j].hspStart))\n                                    .attr('y2', yHspline)\n                                    .attr('stroke', hsplineColor);\n                            }\n                        }\n\n                        var alt_tooltip = d.hitId + '<br>E value: ' + Helpers.prettify_evalue(v.hspEvalue) +\n                            `<br>Identities: ${Utils.inPercentage(v.hspIdentity, v.hspLength)}`;\n                        // if chosen algorithm was blastn, the tooltip won't show the Positives% value in the tooltip\n                        if (algorithm != 'blastn'){\n                            alt_tooltip += `<br>Positives: ${Utils.inPercentage(v.hspPositives, v.hspLength)}`;\n                        }\n                        alt_tooltip += `, Gaps: ${Utils.inPercentage(v.hspGaps, v.hspLength)}`;\n\n                        // Draw the rectangular hit tracks itself.\n                        d3.select(this)\n                            .attr('xlink:href', '#' + q_i + '_hit_' + (i+1))\n                            .append('rect')\n                            .attr('title', alt_tooltip)\n                            .attr('class','bar')\n                            .attr('x', function (d) {\n                                return x(d.hspStart);\n                            })\n                            .attr('y', y(d.hitId))\n                            .attr('width', function (d) {\n                                return x(d.hspEnd - d.hspStart + 1);\n                            })\n                            .attr('height', options.barHeight)\n                            .attr('fill', d3.rgb(hsplineColor));\n                    });\n            });\n\n        // Draw legend only when more than one hit present\n        if (hits.length > 1) {\n            this.drawLegend(svg, options, width, height, inhits);\n        }\n        // Bind listener events once all the graphical elements have\n        // been drawn for first time.\n        if (index === 0) {\n            this.graphControls($queryDiv, $graphDiv, true, opts, inhits);\n        }\n        // Ensure clicking on 'rect' takes user to the relevant hit on all\n        // browsers.\n        this.setupClick($graphDiv);\n    }\n}\n\nvar HitsOverview = Grapher(Graph);\nexport default HitsOverview;\n","import * as d3 from 'd3';\nimport _ from 'underscore';\nimport Grapher from 'grapher';\nimport * as Helpers from './visualisation_helpers';\n\n/**\n * Renders Length Distribution of all hits per query\n */\n\nclass Graph {\n    static canCollapse() {\n        return true;\n    }\n\n    static name() {\n        return 'Length distribution of matching hit sequences';\n    }\n\n    static className() {\n        return 'length-distribution';\n    }\n\n    static graphId(props) {\n        return 'length_'+props.query.number;\n    }\n\n    static dataName(props) {\n        return 'length-distribution-'+props.query.id;\n    }\n\n    constructor($svg_container, props) {\n        this.query = props.query;\n        this._seq_type = Helpers.get_seq_type(props.algorithm);\n        this.svg_container = $svg_container;\n        if (props.algorithm == 'blastx') {\n            this.query_length = this.query.length / 3;\n        } else if (props.algorithm == 'tblastn') {\n            this.query_length = this.query.length * 3;\n        } else {\n            this.query_length = this.query.length;\n        }\n        this._margin = {top: 30, right: 25, bottom: 55, left: 12.5};\n        this.initiate($svg_container.width(), $svg_container.height());\n    }\n\n    initiate(width, height) {\n        this._width = width - this._margin.left - this._margin.right;\n        this._height = height - this._margin.top - this._margin.bottom;\n        this.svg = d3.select(this.svg_container[0]).insert('svg', ':first-child')\n            .attr('width', this._width + this._margin.right + this._margin.left)\n            .attr('height', this._height + this._margin.top + this._margin.bottom)\n            .append('g')\n            .attr('transform','translate('+this._margin.left+','+this._margin.top+')');\n        this.hit_lengths();\n        this.define_scale_and_bins();\n        this.update_data();\n        this.draw();\n    }\n\n    draw() {\n        this.draw_rectangles();\n        this.draw_query_line();\n        this.draw_axes();\n    }\n\n    define_scale_and_bins() {\n        this._scale_x = d3.scaleLinear()\n            .domain([\n                0,\n                (d3.max([this.query_length, d3.max(this._data)]) * 1.01)\n            ]).nice()\n            .range([0, this._width]);\n        this._bins = d3.bin()\n            .domain(this._scale_x.domain())\n            .thresholds(this._scale_x.ticks(50))(this._data);\n        this._scale_y = d3.scaleLinear()\n            .domain([0, d3.max(this._bins, function(d) { return d.length; })])\n            .range([this._height, 0]).nice();\n    }\n\n    hit_lengths() {\n        this._data = _.map(this.query.hits, _.iteratee('length'));\n    }\n\n    setupResponsiveness() {\n        var currentWidth = $(window).width();\n        console.log('cureent '+currentWidth);\n        var debounced_draw = _.debounce(_.bind(function () {\n            if (currentWidth != $(window).width()) {\n                console.log('redraw initiated '+this._height);\n                this.draw();\n                currentWidth = $(window).width();\n            }\n        }, this), 125);\n        $(window).resize(debounced_draw);\n    }\n\n    tick_formatter(seq_type) {\n        const ticks = this._scale_x.ticks();\n        const prefix = d3.format('~s');\n        const suffixes = { amino_acid: 'aa', nucleic_acid: 'bp' };\n\n        return (d) => {\n            if (d === 0 || !ticks.includes(d)) return;\n\n            if (suffixes[seq_type] === 'aa') {\n                return `${d} ${suffixes[seq_type]}`;\n            } else {\n                const formatted = prefix(d);\n\n                return `${Helpers.formatNumberUnits(formatted)}${suffixes[seq_type]}`;\n            }\n        };\n    }\n\n    update_data() {\n        var self = this;\n        var data2 = [];\n        this._bins.map(function (bin) {\n            var inner_data = [];\n            bin.reverse();\n            var y0 = bin.length;\n            bin.map(function (d,i) {\n                var y1 = bin.length - (i+1);\n                var len_index = _.findIndex(self.query.hits, {length: d});\n                var evalue = self.query.hits[len_index].hsps[0].evalue;\n                var item = {\n                    value: d,\n                    id: self.query.hits[len_index].id,\n                    evalue: evalue,\n                    url: '#Query_'+self.query.number+'_hit_'+self.query.hits[len_index].number,\n                    y0: y0,\n                    y1: y0 += (y1 - y0),\n                    color: Helpers.get_colors_for_evalue(evalue,self.query.hits)\n                };\n                inner_data.push(item);\n            });\n            var item = {data: inner_data, x: bin.x0, dx: bin.x1, length: bin.length};\n            data2.push(item);\n        });\n        this._update_data = data2;\n    }\n\n    draw_rectangles() {\n        var self = this;\n        var bar = this.svg.selectAll('.bar')\n            .data(this._update_data)\n            .enter().append('g')\n            .attr('class', 'g')\n            .attr('transform', function(d) {\n                return 'translate('+(self._scale_x(d.x)+self._margin.left)+',0)';\n            });\n\n        bar.selectAll('rect')\n            .data(function (d) { return d.data; })\n            .enter().append('a')\n            .attr('xlink:href', function(i) { return i.url; })\n            .append('rect')\n            .attr('class','bar')\n            .attr('title', function(i) {\n                return i.id+' '+'<br>E value: '+Helpers.prettify_evalue(i.evalue)+'<br>Length: '+i.value;\n            })\n            .attr('x', 1)\n            .attr('y', function(i) { return (self._scale_y(i.y0)); })\n            .attr('width', self._scale_x(this._bins[1].x0) - self._scale_x(this._bins[0].x0) - 1)\n            .attr('height', function (i) { return self._scale_y(i.y1) - self._scale_y(i.y0); })\n            .attr('fill', function(i) {\n                return i.color;\n            });\n    }\n\n    draw_query_line() {\n        var query_line = this.svg.append('g')\n            .attr('class','query_line')\n            .attr('transform','translate('+(this._margin.left+this._scale_x(this.query_length))+',0)');\n\n        query_line.append('rect')\n            .attr('x',1)\n            .attr('class','bar')\n            .attr('width',4)\n            .attr('height',this._height)\n            .style('fill','#c74f14');\n\n        query_line.append('text')\n            .attr('dy', '0.75em')\n            .attr('y', -10)\n            .attr('x', 2)\n            .attr('text-anchor','start')\n            .text('Query')\n            .style('fill','#000')\n            .attr('transform','rotate(-45)');\n    }\n\n    draw_axes() {\n        var space, len;\n        len = this._scale_y.ticks().length;\n        if (len >= 5) {\n            space = 5;\n        } else {\n            space = len;\n        }\n        var formatter = this.tick_formatter(this._seq_type.subject_seq_type);\n        var x_axis = d3.axisTop(this._scale_x)\n            .ticks(50)\n            .tickFormat(formatter);\n        var y_axis = d3.axisLeft(this._scale_y)\n            .tickValues(this._scale_y.ticks(space))\n            .tickSizeOuter(0)\n            .tickFormat(function (e) {\n                if (Math.floor(e) != e) {\n                    return ;\n                }\n                return e;\n            });\n        var ticks = this._scale_y.ticks();\n        for (var i in ticks) {\n            if (ticks[i] % 1 != 0) {\n                y_axis.tickValues(d3.range(0, d3.max(this._bins, function(d) { return d.length; })+1));\n                break;\n            }\n        }\n        var self = this;\n        var xContainer = this.svg.append('g')\n            .attr('class', 'axis axis--x')\n            .attr('transform', 'translate('+this._margin.left+','+this._height+')')\n            .call(x_axis);\n\n        xContainer.selectAll('line').attr('y2',function (d) {\n            var ticks = self._scale_x.ticks();\n            if (_.indexOf(ticks, d) >= 0) {\n                return 7;\n            } else {\n                return 4;\n            }\n        });\n\n        xContainer.selectAll('text').style('text-anchor','end')\n            .attr('x', '-8px')\n            .attr('y', '3px')\n            .attr('dy', '0')\n            .attr('transform','rotate(-90)');\n\n        this.svg.append('g')\n            .attr('class','axis axis--y')\n            .attr('transform','translate('+this._margin.left+',0)')\n            .call(y_axis);\n    }\n}\n\nvar LengthDistribution = Grapher(Graph);\nexport default LengthDistribution;\n","const convertChunk = (fastqChunk) => {\n    fastqChunk[0] = '>' + fastqChunk[0].substring(1);\n    return fastqChunk.slice(0, 2);\n};\n\nconst isValidFastq = (fastqChunk) => {\n    if (fastqChunk.length !== 4) {\n        return false;\n    }\n\n    return fastqChunk[0][0] === '@' && fastqChunk[2][0] === '+' && fastqChunk[1].length === fastqChunk[3].length;\n};\n\nexport const fastqToFasta = (sequence) => {\n    let trimmedSequence = sequence.trim();\n    // return unmodified if sequence does not look like fastq\n    if (!trimmedSequence.startsWith('@')) {\n        return sequence;\n    }\n\n    const sequenceLines = trimmedSequence.split('\\n');\n    const fastaChunks = [];\n\n    for (let i = 0; i < sequenceLines.length; i += 4) {\n        const fastqChunk = sequenceLines.slice(i, i + 4);\n        if (isValidFastq(fastqChunk)) {\n            fastaChunks.push(...convertChunk(fastqChunk));\n        } else {\n            // return unmodified sequence if it does not look like valid fastq\n            return sequence;\n        }\n    }\n\n    return fastaChunks.join('\\n');\n};","import React, { Component, createRef } from 'react';\nimport _ from 'underscore';\n\nimport HitsOverview from './hits_overview';\nimport LengthDistribution from './length_distribution'; // length distribution of hits\nimport Utils from './utils';\nimport { fastqToFasta } from './fastq_to_fasta';\nimport CollapsePreferences from './collapse_preferences';\nimport './jquery_world';\n\n/**\n * Query component displays query defline, graphical overview, length\n * distribution, and hits table.\n */\nexport class ReportQuery extends Component {\n    // Each update cycle will cause all previous queries to be re-rendered.\n    // We avoid that by implementing shouldComponentUpdate life-cycle hook.\n    // The trick is to simply check if the components has recieved props\n    // before.\n    shouldComponentUpdate() {\n        // If the component has received props before, query property will\n        // be set on it. If it is, we return false so that the component\n        // is not re-rendered. If the query property is not set, we return\n        // true: this must be the first time react is trying to render the\n        // component.\n        return !this.props.query;\n    }\n    // Kind of public API //\n\n    /**\n     * Returns the id of query.\n     */\n    domID() {\n        return 'Query_' + this.props.query.number;\n    }\n\n    queryLength() {\n        return this.props.query.length;\n    }\n\n    /**\n     * Returns number of hits.\n     */\n    numhits() {\n        return this.props.query.hits.length;\n    }\n    headerJSX() {\n        var meta = `Length: ${this.queryLength().toLocaleString()}`;\n\n        if (this.props.showQueryCrumbs) {\n            meta = `query ${this.props.query.number}. ${meta}`;\n        }\n        return <div className=\"section-header border-b border-seqorange justify-between w-full flex flex-col sm:flex-row gap-4\">\n            <h3 className=\"text-base cursor-pointer flex flex-col sm:flex-row items-start\">\n                <strong>Query=<span className=\"ml-1\">{this.props.query.id}</span></strong>\n                <span className=\"ml-1\">{this.props.query.title}</span>\n            </h3>\n            <span className=\"label first-letter:capitalize text-sm text-right font-normal text-inherit pt-0 px-0\">{meta}</span>\n        </div>;\n    }\n\n    hitsListJSX() {\n        return <div className=\"pt-0 px-0 pb-px\">\n            <HitsOverview key={'GO_' + this.props.query.number} query={this.props.query} program={this.props.program} collapsed={this.props.veryBig} />\n            <LengthDistribution key={'LD_' + this.props.query.id} query={this.props.query} algorithm={this.props.program} />\n            <HitsTable key={'HT_' + this.props.query.number} query={this.props.query} imported_xml={this.props.imported_xml} />\n        </div>;\n    }\n\n    noHitsJSX() {\n        return <div className=\"pt-0 px-0 pb-px\">\n            <strong> ****** No BLAST hits found ****** </strong>\n        </div>;\n    }\n\n    render() {\n        return (\n            <div className=\"resultn mt-1.5\" id={this.domID()}\n                data-query-len={this.props.query.length}\n                data-algorithm={this.props.program}>\n                {this.headerJSX()}\n                {this.numhits() && this.hitsListJSX() || this.noHitsJSX()}\n            </div>\n        );\n    }\n}\n\n\n/**\n * Query widget for Search component.\n */\nexport class SearchQueryWidget extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            value: $('input#input_sequence').val() || ''\n        };\n        this.value = this.value.bind(this);\n        this.clear = this.clear.bind(this);\n        this.focus = this.focus.bind(this);\n        this.isEmpty = this.isEmpty.bind(this);\n        this.textarea = this.textarea.bind(this);\n        this.controls = this.controls.bind(this);\n        this.handleInput = this.handleInput.bind(this);\n        this.hideShowButton = this.hideShowButton.bind(this);\n        this.indicateError = this.indicateError.bind(this);\n        this.indicateNormal = this.indicateNormal.bind(this);\n        this.type = this.type.bind(this);\n        this.guessSequenceType = this.guessSequenceType.bind(this);\n        this.preProcessSequence = this.preProcessSequence.bind(this);\n        this.notify = this.notify.bind(this);\n\n        this.textareaRef = createRef();\n        this.controlsRef = createRef();\n    }\n\n\n    // LIFECYCLE Methods\n\n    componentDidMount() {\n        $('body').click(function () {\n            $('[data-notifications] [data-role=notification].active').hide('drop', { direction: 'up' }).removeClass('active');\n        });\n    }\n\n    componentDidUpdate() {\n        this.hideShowButton();\n        this.preProcessSequence();\n        this.props.onSequenceChanged(this.residuesCount());\n\n        var type = this.type();\n        if (!type || type !== this._type) {\n            this._type = type;\n            this.notify(type);\n            this.props.onSequenceTypeChanged(type);\n        }\n    }\n\n    // Kind of public API. //\n\n    /**\n     * Returns query sequence if no argument is provided (or null or undefined\n     * is provided as argument). Otherwise, sets query sequence to the given\n     * value and returns `this`.\n     *\n     * Default/initial state of query sequence is an empty string. Caller must\n     * explicitly provide empty string as argument to \"reset\" query sequence.\n     */\n    value(val) {\n        if (val == null) {\n            // i.e., val is null or undefined\n            return this.state.value;\n        }\n        else {\n            this.setState({\n                value: val\n            });\n            return this;\n        }\n    }\n\n    residuesCount() {\n        const sequence = this.value();\n        const lines = sequence.split('\\n');\n        const residuesCount = lines.reduce((count, line) => {\n            if (!line.startsWith('>')) {\n                return count + line.length;\n            }\n            return count;\n        }, 0);\n\n        return residuesCount;\n    }\n\n    /**\n     * Clears textarea. Returns `this`.\n     *\n     * Clearing textarea also causes it to be focussed.\n     */\n    clear() {\n        return this.value('').focus();\n    }\n\n    /**\n     * Focuses textarea. Returns `this`.\n     */\n    focus() {\n        this.textarea().focus();\n        return this;\n    }\n\n    /**\n     * Returns true if query is absent ('', undefined, null), false otherwise.\n     */\n    isEmpty() {\n        return !this.value();\n    }\n\n\n    // Internal helpers. //\n\n    textarea() {\n        return $(this.textareaRef.current);\n    }\n\n    controls() {\n        return $(this.controlsRef.current);\n    }\n\n    handleInput(evt) {\n        this.value(evt.target.value);\n    }\n\n    /**\n     * Hides or shows 'clear sequence' button.\n     *\n     * Rendering the 'clear sequence' button takes into account presence or\n     * absence of a scrollbar.\n     *\n     * Called by `componentDidUpdate`.\n     */\n    hideShowButton() {\n        if (!this.isEmpty()) {\n            // Calculation below is based on -\n            // http://chris-spittles.co.uk/jquery-calculate-scrollbar-width/\n            // FIXME: can reflow be avoided here?\n            var textareaNode = this.textarea()[0];\n            var sequenceControlsRight = textareaNode.offsetWidth - textareaNode.clientWidth;\n            this.controls().css('right', sequenceControlsRight + 17);\n            this.controls().removeClass('hidden');\n        }\n        else {\n            // FIXME: what are lines 1, 2, & 3 doing here?\n            this.textarea().parent().removeClass('has-error');\n            this.$sequenceFile = $('#sequence-file');\n            this.$sequenceFile.empty();\n\n            this.controls().addClass('hidden');\n        }\n    }\n\n    /**\n     * Put red border around textarea.\n     */\n    indicateError() {\n        this.textarea().parent().addClass('has-error');\n    }\n\n    /**\n     * Put normal blue border around textarea.\n     */\n    indicateNormal() {\n        this.textarea().parent().removeClass('has-error');\n    }\n\n    /**\n     * Returns type of the query sequence (nucleotide, protein, mixed).\n     *\n     * Query widget supports executing a callback when the query type changes.\n     * Components interested in query type should register a callback instead\n     * of directly calling this method.\n     */\n    type() {\n        let sequence = this.value().trim();\n        // FASTQ detected, but we don't know if conversion has succeeded yet\n        // will notify separately if it does\n        if (sequence.startsWith('@') ) { return undefined; }\n\n        var sequences = sequence.split(/>.*/);\n\n        var type, tmp;\n\n        for (var i = 0; i < sequences.length; i++) {\n            tmp = this.guessSequenceType(sequences[i]);\n\n            // could not guess the sequence type; try the next sequence\n            if (!tmp) { continue; }\n\n            if (!type) {\n                // successfully guessed the type of atleast one sequence\n                type = tmp;\n            }\n            else if (tmp !== type) {\n                // user has mixed different type of sequences\n                return 'mixed';\n            }\n        }\n\n        return type;\n    }\n\n    preProcessSequence() {\n        var sequence = this.value();\n        var updatedSequence = fastqToFasta(sequence);\n\n        if (sequence !== updatedSequence) {\n            this.value(updatedSequence);\n            this.notify('fastq');\n        }\n    }\n\n    /**\n     * Guesses and returns the type of the given sequence (nucleotide,\n     * protein).\n     */\n    guessSequenceType(sequence) {\n        // remove 'noisy' characters\n        sequence = sequence.replace(/[^A-Z]/gi, ''); // non-letter characters\n        sequence = sequence.replace(/[NX]/gi, ''); // ambiguous  characters\n\n        // can't determine the type of ultrashort queries\n        if (sequence.length < 10) {\n            return undefined;\n        }\n\n        // count the number of putative NA\n        var putative_NA_count = 0;\n        for (var i = 0; i < sequence.length; i++) {\n            if (sequence[i].match(/[ACGTU]/i)) {\n                putative_NA_count += 1;\n            }\n        }\n\n        var threshold = 0.9 * sequence.length;\n        return putative_NA_count > threshold ? 'nucleotide' : 'protein';\n    }\n\n    notify(type) {\n        this.indicateNormal();\n        clearTimeout(this.notification_timeout);\n        // $('[data-notifications] [data-role=notification].active').hide().removeClass('active');\n\n        if (type) {\n            $('#' + type + '-sequence-notification').show('drop', { direction: 'up' }).addClass('active');\n\n            this.notification_timeout = setTimeout(function () {\n                $('[data-notifications] [data-role=notification].active').hide('drop', { direction: 'up' }).removeClass('active');\n            }, 5000);\n\n            if (type === 'mixed') {\n                this.indicateError();\n            }\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"relative\">\n                <div\n                    className=\"sequence\">\n                    <textarea\n                        id=\"sequence\" ref={this.textareaRef}\n                        className=\"block w-full p-4 text-gray-900 border border-gray-300 rounded-l-lg rounded-tr-lg bg-gray-50 text-sm font-mono min-h-52 resize-y\"\n                        name=\"sequence\" value={this.state.value}\n                        rows=\"6\"\n                        required=\"required\"\n                        placeholder=\"Paste query sequence(s) or drag file\n                        containing query sequence(s) in FASTA format here ...\"\n                        spellCheck=\"false\" autoFocus\n                        onChange={this.handleInput}>\n                    </textarea>\n                </div>\n                <div\n                    className=\"hidden absolute top-2 right-2\"\n                    ref={this.controlsRef}>\n                    <button\n                        type=\"button\"\n                        className=\"border border-gray-300 rounded bg-white hover:bg-gray-200\" id=\"btn-sequence-clear\"\n                        title=\"Clear query sequence(s).\"\n                        onClick={this.clear}>\n                        <span id=\"sequence-file\"></span>\n                        <i className=\"fa fa-times w-6 h-6 p-1\"></i>\n                        <span className=\"sr-only\">Clear query sequence(s).</span>\n                    </button>\n                </div>\n            </div>\n        );\n    }\n}\n\n\n/**\n * Renders summary of all hits per query in a tabular form.\n */\n\nclass HitsTable extends Component {\n    constructor(props) {\n        super(props);\n        this.name = 'Hit sequences producing significant alignments';\n        this.collapsePreferences = new CollapsePreferences(this);\n        this.state = {\n            collapsed: this.collapsePreferences.preferenceStoredAsCollapsed()\n        };\n    }\n\n    tableJSX() {\n        var hasName = _.every(this.props.query.hits, function (hit) {\n            return hit.sciname !== '';\n        });\n\n        // Width of sequence column is 55% when species name is not shown and\n        // query coverage is.\n        var seqwidth = 55;\n        // If we are going to show species name, then reduce the width of\n        // sequence column by the width of species column.\n        if (hasName) seqwidth -= 15;\n        // If we are not going to show query coverage (i.e. for imported XML),\n        // then increase the width of sequence column by the width of coverage\n        // column.\n        if (this.props.imported_xml) seqwidth += 15;\n\n        return <table\n            className=\"table table-hover table-condensed tabular-view text-sm min-w-full mb-0\">\n            <thead>\n                <tr className=\"text-neutral-500\">\n                    <th className=\"text-left font-normal\">#</th>\n                    <th style={{ width: `${seqwidth}%` }} className=\"text-left font-normal\">Similar sequences</th>\n                    {hasName && <th className=\"text-left font-normal w-2/12\">Species</th>}\n                    {!this.props.imported_xml && <th className=\"text-right font-normal w-2/12\">Query coverage (%)</th>}\n                    <th className=\"text-right font-normal w-1/12\">Total score</th>\n                    <th className=\"text-right font-normal w-1/12\">E value</th>\n                    <th className=\"text-right font-normal w-1/12\">Identity (%)</th>\n                </tr>\n            </thead>\n            <tbody>\n                {\n                    _.map(this.props.query.hits, _.bind(function (hit) {\n                        return (\n                            <tr key={hit.number}>\n                                <td className=\"text-left\">{hit.number + '.'}</td>\n                                <td>\n                                    <a href={'#Query_' + this.props.query.number + '_hit_' + hit.number}\n                                        className=\"text-sm text-seqblue hover:text-seqorange cursor-pointer pe-1 line-clamp-1 tooltip-item\" title={`${hit.id} ${hit.title}`}>{hit.id} {hit.title}</a>\n                                </td>\n                                {hasName &&\n                                    <td className=\"pe-1 line-clamp-1 tooltip-item\" title={hit.sciname}>\n                                        {hit.sciname}\n                                    </td>\n                                }\n                                {!this.props.imported_xml && <td className=\"text-right\">{hit.qcovs}</td>}\n                                <td className=\"pe-1 text-right\">{hit.total_score}</td>\n                                <td className=\"pe-1 text-right\">{Utils.inExponential(hit.hsps[0].evalue)}</td>\n                                <td className=\"pe-1 text-right\">{Utils.inPercentage(hit.hsps[0].identity, hit.hsps[0].length)}</td>\n                            </tr>\n                        );\n                    }, this))\n                }\n            </tbody>\n        </table>;\n    }\n\n    render() {\n        return (\n            <div className={`table-hit-overview ${this.state.collapsed ? 'print:hidden' : ''}`}>\n                <div className=\"grapher-header pr-px\">\n                    <h4 className=\"inline-block pl-px m-0 caption cursor-pointer text-sm caption\" onClick={() => this.collapsePreferences.toggleCollapse()}>\n                        {this.collapsePreferences.renderCollapseIcon()}\n                        <span> {this.name}</span>\n                    </h4>\n                </div>\n                <div id={'Query_' + this.props.query.number + 'HT_' + this.props.query.number} className=\"overflow-auto md:overflow-hidden\">\n                    {!this.state.collapsed && this.tableJSX()}\n                </div>\n            </div>\n        );\n    }\n}\n","import React, { Component } from 'react';\n// Component for the advanced params input field.\nexport class Options extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            textValue: '',\n            objectValue: this.defaultObjectValue(),\n            paramsMode: 'advanced'\n        };\n\n        this.onTextValueChanged = this.onTextValueChanged.bind(this);\n        this.optionsPresetsJSX = this.optionsPresetsJSX.bind(this);\n        this.advancedParamsJSX = this.advancedParamsJSX.bind(this);\n        this.showAdvancedOptionsHelp = this.showAdvancedOptionsHelp.bind(this);\n    }\n\n\n    defaultObjectValue() {\n        return {\n            max_target_seqs: '',\n            evalue: '',\n            task: ''\n        };\n    };\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.predefinedOptions !== this.props.predefinedOptions) {\n            let defaultOptions = this.props.predefinedOptions.default || {attributes: []};\n            let advancedOptions = this.props.predefinedOptions['last search'] || defaultOptions || {attributes: []};\n            let initialTextValue = advancedOptions.attributes.join(' ').trim();\n            let parsedOptions = this.parsedOptions(initialTextValue);\n            this.setState({ textValue: initialTextValue, objectValue: parsedOptions});\n        }\n    }\n\n    onTextValueChanged(textValue) {\n        let parsedOptions = this.parsedOptions(textValue.toString());\n\n        this.setState({\n            textValue: textValue.toString(),\n            objectValue: parsedOptions\n        });\n    }\n\n    parsedOptions(textValue) {\n        const words = textValue.split(\" \");\n        let parsedOptions = this.defaultObjectValue();\n        // Iterate through the words in steps of 2, treating each pair as an option and its potential value\n        for (let i = 0; i < words.length; i += 2) {\n            // Ensure there is a pair available\n            if (words[i]) {\n                if (words[i].startsWith(\"-\")) {\n                    const optionName = words[i].substring(1).trim();\n\n                    if (words[i + 1]) {\n                        // Use the second word as the value for this option\n                        parsedOptions[optionName] = words[i + 1];\n                    } else {\n                        // No value found for this option, set it to null or a default value\n                        parsedOptions[optionName] = null;\n                    }\n                }\n            }\n        }\n\n        return parsedOptions;\n    }\n\n    optionsPresetsJSX() {\n        return (\n            <div id=\"options-presets\" className=\"w-full\">\n                { Object.keys(this.props.predefinedOptions).length > 1 && <>\n                    <div className=\"flex items-center border-b border-seqorange mb-2\">\n                        <h3 className=\"text-base md:text-lg font-medium pr-1\">Settings</h3>\n                        <p className=\"text-base text-gray-500\">Choose a predefined setting or customize parameters.</p>\n                    </div>\n                    {this.presetListJSX()}\n                </>}\n            </div>\n        );\n    }\n\n    presetListJSX() {\n        return (\n            <ul className=\"md:text-lg my-1\">\n                {\n                    Object.entries(this.props.predefinedOptions).map(\n                        ([key, config], index) => {\n                            let textValue = config.attributes.join(' ').trim();\n                            let description = config.description || textValue;\n\n                            return (\n                                <label key={index} className={`block w-full px-2 py-1 text-seqblue hover:bg-gray-200 hover:text-seqorange cursor-pointer`}>\n                                    <input\n                                        type=\"radio\"\n                                        name=\"predefinedOption\"\n                                        value={textValue}\n                                        checked={textValue === this.state.textValue}\n                                        onChange={() => this.onTextValueChanged(textValue)}\n                                    />\n                                    <strong className=\"ml-2\">{key}:</strong>&nbsp;{description}\n                                </label>\n                            );\n                        }\n                    )\n                }\n            </ul>\n        )\n    }\n\n    advancedParamsJSX() {\n        let classNames = 'flex-grow block px-4 py-1 text-gray-900 border border-gray-300 rounded-lg bg-gray-50 text-base font-mono';\n\n        if (this.state.textValue) {\n            classNames += ' bg-yellow-100';\n        }\n\n        return(\n             <div className={this.state.paramsMode !== 'advanced' ? 'w-full hidden' : 'w-full'}>\n                <div className=\"flex items-end\">\n                    <label className=\"flex items-center text-base md:text-lg\" htmlFor=\"advanced\">\n                        Parameters:\n                    </label>\n\n                    {this.props.blastMethod &&\n                        <button\n                            className=\"text-seqblue text-base md:text-lg ml-2\"\n                            type=\"button\"\n                            onClick={this.showAdvancedOptionsHelp}\n                            data-toggle=\"modal\" data-target=\"#help\">\n                            See options\n                            <i className=\"fa fa-question-circle ml-1 w-3 h-4 fill-current\"></i>\n                        </button>\n                    }\n                </div>\n\n                <div className='flex-grow flex w-full'>\n                    <input type=\"text\" className={classNames}\n                        onChange={e => this.onTextValueChanged(e.target.value)}\n                        id=\"advanced\"\n                        name=\"advanced\"\n                        value={this.state.textValue}\n                        placeholder=\"eg: -evalue 1.0e-5 -num_alignments 100\"\n                        title=\"View, and enter advanced parameters.\"\n                    />\n                </div>\n                <div className=\"mt-1 text-gray-700\">\n                    Options as they would appear in a command-line.\n                </div>\n            </div>\n        )\n    }\n\n    showAdvancedOptionsHelp(e) {\n        const ids = ['blastn', 'tblastn', 'blastp', 'blastx', 'tblastx'];\n        const method = this.props.blastMethod.toLowerCase();\n        const modal = document.querySelector(\"dialog.advanced-modal\");\n\n        // hide options for other algorithms and only show for selected algorithm\n        for (const id of ids) {\n            if (id === method) {\n                document.getElementById(id).classList.remove('hidden');\n            } else {\n                document.getElementById(id).classList.add('hidden');\n            }\n        }\n\n        modal.showModal();\n    }\n\n    render() {\n        return (\n            <div className=\"flex-grow flex flex-col items-start sm:items-center space-y-4\">\n                {this.optionsPresetsJSX()}\n\n                {this.advancedParamsJSX()}\n            </div>\n        );\n    }\n\n}\n","import React from 'react';\n\nclass QueryStats extends React.Component{\n    render () {}\n\n    componentDidUpdate() {\n      console.log(\"Query stats:\", this.props)\n    }\n}\n\nexport default QueryStats;","import React, { Component, createRef, Suspense } from 'react';\nimport { SearchButton } from './search_button';\nimport { SearchQueryWidget } from './query';\nimport _ from 'underscore';\nimport { Options } from 'options';\nimport QueryStats from 'query_stats';\n\nconst Databases = React.lazy(() => import('./databases').then(mod => ({ default: mod.Databases })));\nconst DatabasesTree = React.lazy(() => import('./databases_tree'));\n\n/**\n * Search form.\n *\n * Top level component that initialises and holds all other components, and\n * facilitates communication between them.\n */\nexport class Form extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            databases: [],\n            preSelectedDbs: [],\n            currentlySelectedDbs: [],\n            preDefinedOpts: {},\n            tree: {},\n            residuesInQuerySequence: 0,\n            blastMethod: ''\n        };\n        this.useTreeWidget = this.useTreeWidget.bind(this);\n        this.determineBlastMethods = this.determineBlastMethods.bind(this);\n        this.handleSequenceTypeChanged = this.handleSequenceTypeChanged.bind(this);\n        this.handleSequenceChanged = this.handleSequenceChanged.bind(this);\n        this.handleDatabaseTypeChanged = this.handleDatabaseTypeChanged.bind(this);\n        this.handleDatabaseSelectionChanged = this.handleDatabaseSelectionChanged.bind(this);\n        this.handleAlgoChanged = this.handleAlgoChanged.bind(this);\n        this.handleFormSubmission = this.handleFormSubmission.bind(this);\n        this.formRef = createRef();\n        this.query = createRef();\n        this.button = createRef();\n        this.setButtonState = this.setButtonState.bind(this);\n    }\n\n    componentDidMount() {\n        /**\n        * Fetch data to initialise the search interface from the server. These\n        * include list of databases to search against, advanced options to\n        * apply when an algorithm is selected, and a query sequence that\n        * the user may want to search in the databases.\n        */\n        var search = location.search.split(/\\?|&/).filter(Boolean);\n        var job_id = sessionStorage.getItem('job_id');\n        if (job_id) {\n            search.unshift(`job_id=${job_id}`);\n        }\n        $.getJSON(`searchdata.json?${search.join('&')}`, function (data) {\n            /* Update form state (i.e., list of databases and predefined\n             * advanced options.\n             */\n            this.setState({\n                tree: data['tree'],\n                databases: data['database'],\n                preSelectedDbs: data['preSelectedDbs'],\n                preDefinedOpts: data['options'],\n                blastTaskMap: data['blastTaskMap'],\n                currentlySelectedDbs: data['preSelectedDbs'] || [],\n            }, () => {\n                this.handleDatabaseSelectionChanged(this.state.currentlySelectedDbs);\n                this.handleFirstSelectionDB();\n                this.setBlastMethods();\n            });\n\n            /* Pre-populate the form with server sent query sequences\n             * (if any).\n             */\n            if (data['query']) {\n                this.query.current.value(data['query']);\n            }\n\n            // DB selection\n            setTimeout(() => {\n                this.preselectDatabases(this.state.preSelectedDbs);\n            }, 0);\n\n            setTimeout(function () {\n                $('.jstree_div').click();\n            }, 1000);\n        }.bind(this));\n\n        /* Enable submitting form on Cmd+Enter */\n        $(document).on('keydown', (e) => {\n            var $button = $('#method');\n            if (!$button.is(':disabled') &&\n                e.ctrlKey && e.key === 'Enter') {\n                $button.trigger('click');\n            }\n        });\n    }\n\n    handleFirstSelectionDB() {\n        const firstSelectedDb = this.state.preSelectedDbs != null ? this.state.preSelectedDbs[0].type : null;\n        if (firstSelectedDb) {\n            this.handleDatabaseTypeChanged(firstSelectedDb);\n        }\n    }\n    \n    setBlastMethods() {\n        const methods = this.determineBlastMethods();\n        if (methods.length > 0) {\n            this.setState({ blastMethod: methods[0] });\n        }\n    }\n\n    preselectDatabases(preSelectedDbs) {\n        if (preSelectedDbs) {\n            preSelectedDbs.forEach(db => {\n                const matchCheckbox = this.formRef.current.querySelector(`input.checkbox-database[value=\"${db.id}\"]`);\n                if (matchCheckbox) {\n                    matchCheckbox.click();\n                    matchCheckbox.checked = true;\n                }\n            });\n        }\n    }\n\n    useTreeWidget() {\n        return !_.isEmpty(this.state.tree);\n    }\n\n    handleFormSubmission(evt) {\n        evt.preventDefault();\n        const form = this.formRef.current;\n\n        document.getElementById('overlay').style.display = 'block';\n\n        const formData = new FormData(form);\n        formData.append('method', this.button.current.state.methods[0]);\n\n        fetch(window.location.href, {\n            method: 'POST',\n            body: formData\n        }).then(res => {\n            //remove overlay when form is submitted\n            document.getElementById('overlay').style.display = 'none';\n            // redirect\n            if (res.redirected && res.url) {\n                // setTimeout is needed here as a workaround because safari doesnt allow async calling of window.open\n                // so setTimeout makes the method get called on the main thread.\n                setTimeout(() => {\n                    window.open(res.url, $('#toggleNewTab').is(':checked') ? '_blank' : '_self');\n                }, 0);\n            }\n        });\n    }\n\n    determineBlastMethods() {\n        var database_type = this.databaseType;\n        var sequence_type = this.sequenceType;\n\n        if (this.query.current.isEmpty()) {\n            return [];\n        }\n\n        //database type is always known\n        switch (database_type) {\n        case 'protein':\n            switch (sequence_type) {\n            case undefined:\n                return ['blastp', 'blastx'];\n            case 'protein':\n                return ['blastp'];\n            case 'nucleotide':\n                return ['blastx'];\n            }\n            break;\n        case 'nucleotide':\n            switch (sequence_type) {\n            case undefined:\n                return ['tblastn', 'blastn', 'tblastx'];\n            case 'protein':\n                return ['tblastn'];\n            case 'nucleotide':\n                return ['blastn', 'tblastx'];\n            }\n            break;\n        }\n\n        return [];\n    }\n\n    handleSequenceChanged(residuesInQuerySequence) {\n        if(residuesInQuerySequence !== this.state.residuesInQuerySequence)\n            this.setState({ residuesInQuerySequence: residuesInQuerySequence});\n    }\n\n    handleSequenceTypeChanged(type) {\n        this.sequenceType = type;\n        this.setButtonState();\n    }\n\n    handleDatabaseTypeChanged(type) {\n        this.databaseType = type;\n        this.setButtonState();\n    }\n\n    setButtonState() {\n        this.button.current.setState({\n            hasQuery: !this.query.current.isEmpty(),\n            hasDatabases: !!this.databaseType,\n            methods: this.determineBlastMethods()\n        });\n    }\n\n    handleDatabaseSelectionChanged(selectedDbs) {\n        if (!_.isEqual(selectedDbs, this.state.currentlySelectedDbs))\n            this.setState({ currentlySelectedDbs: selectedDbs });\n    }\n\n    handleAlgoChanged(algo) {\n        if (algo in this.state.preDefinedOpts) {\n            this.setState({ blastMethod: algo });\n        }\n        else {\n            this.setState({ blastMethod: ''});\n        }\n    }\n\n    residuesInSelectedDbs() {\n        return this.state.currentlySelectedDbs.reduce((sum, db) => sum + parseInt(db.ncharacters, 10), 0);\n    }\n\n    render() {\n        return (\n            <div>\n                <div id=\"overlay\" style={{ position: 'absolute', top: 0, left: 0, width: '100vw', height: '100vw', background: 'rgba(0, 0, 0, 0.2)', display: 'none', zIndex: 99 }} />\n\n                <div className=\"fixed top-0 left-0 w-full max-h-8 px-8\" data-notifications id=\"notifications\">\n                    <FastqNotification />\n                    <NucleotideNotification />\n                    <ProteinNotification />\n                    <MixedNotification />\n                </div>\n\n                <form id=\"blast\" ref={this.formRef} onSubmit={this.handleFormSubmission}>\n                    <input type=\"hidden\" name=\"_csrf\" value={document.querySelector('meta[name=\"_csrf\"]').content} />\n                    <div className=\"px-4\">\n                        <SearchQueryWidget ref={this.query} onSequenceTypeChanged={this.handleSequenceTypeChanged} onSequenceChanged={this.handleSequenceChanged}/>\n\n                        {this.useTreeWidget() ?\n                            <Suspense fallback={<div>Loading...</div>}>\n                                <DatabasesTree\n                                    databases={this.state.databases} tree={this.state.tree}\n                                    preSelectedDbs={this.state.preSelectedDbs}\n                                    onDatabaseTypeChanged={this.handleDatabaseTypeChanged}\n                                    onDatabaseSelectionChanged={this.handleDatabaseSelectionChanged} />\n                            </Suspense>\n                            :\n                            <Suspense fallback={<div>Loading...</div>}>\n                                <Databases databases={this.state.databases}\n                                    preSelectedDbs={this.state.preSelectedDbs}\n                                    onDatabaseTypeChanged={this.handleDatabaseTypeChanged}\n                                    onDatabaseSelectionChanged={this.handleDatabaseSelectionChanged} />\n                            </Suspense>\n                        }\n\n                        <Options blastMethod={this.state.blastMethod} predefinedOptions={this.state.preDefinedOpts[this.state.blastMethod] || {}} blastTasks={(this.state.blastTaskMap || {})[this.state.blastMethod]} />\n\n                    </div>\n\n                    <div className=\"py-6\"></div> {/* add a spacer so that the sticky action bar does not hide any contents */}\n\n                    <div className=\"pb-4 pt-2 px-4 sticky bottom-0 md:flex flex-row md:space-x-4 items-center justify-end bg-gradient-to-t to-gray-100/90 from-white/90\">\n                        <QueryStats\n                            residuesInQuerySequence={this.state.residuesInQuerySequence} numberOfDatabasesSelected={this.state.currentlySelectedDbs.length} residuesInSelectedDbs={this.residuesInSelectedDbs()}\n                            currentBlastMethod={this.state.blastMethod}\n                        />\n\n                        <label className=\"text-seqblue hover:seqorange cursor-pointer block my-4 md:my-2\">\n                            <input type=\"checkbox\" id=\"toggleNewTab\" /> Open results in new tab\n                        </label>\n                        <SearchButton ref={this.button} onAlgoChanged={this.handleAlgoChanged} />\n                    </div>\n\n                </form>\n            </div>\n        );\n    }\n\n}\n\n\nclass ProteinNotification extends Component {\n    render() {\n        return (\n            <div\n                data-role=\"notification\"\n                id=\"protein-sequence-notification\"\n                style={{ display: 'none' }}>\n                <div\n                    className=\"bg-blue-100 border rounded border-blue-800 px-4 py-2 my-2\">\n                    Detected: amino-acid sequence(s).\n                </div>\n            </div>\n        );\n    }\n}\n\nclass NucleotideNotification extends Component {\n    render() {\n        return (<div\n            data-role=\"notification\"\n            id=\"nucleotide-sequence-notification\"\n            style={{ display: 'none' }}>\n            <div\n                className=\"bg-blue-100 border rounded border-blue-800 px-4 py-2 my-2\">\n                Detected: nucleotide sequence(s).\n            </div>\n        </div>\n        );\n    }\n}\n\nclass FastqNotification extends Component {\n    render() {\n        return (<div\n            data-role=\"notification\"\n            id=\"fastq-sequence-notification\"\n            style={{ display: 'none' }}>\n            <div\n                className=\"bg-blue-100 border rounded border-blue-800 px-4 py-2 my-2\">\n                Detected FASTQ and automatically converted to FASTA.\n            </div>\n        </div>\n        );\n    }\n}\n\nclass MixedNotification extends Component {\n    render() {\n        return (\n            <div\n                data-role=\"notification\"\n                id=\"mixed-sequence-notification\"\n                style={{ display: 'none' }}>\n                <div\n                    className=\"alert-danger col-md-10 col-md-offset-1\">\n                    Error: mixed nucleotide and amino-acid sequences detected.\n                </div>\n            </div>\n        );\n    }\n}\n","import $ from 'jquery';\nimport 'jquery-ui-dist/jquery-ui';\n\nglobal.$ = $;\n/**\n * Simple, small jQuery extensions for convenience.\n */\n(function ($) {\n    /**\n     * Disable an element.\n     *\n     * Sets `disabled` property to `true` and adds `disabled` class.\n     */\n    $.fn.disable = function () {\n        return this.prop('disabled', true).addClass('disabled');\n    };\n\n    /**\n     * Enable an element.\n     *\n     * Sets `disabled` property to `false` and removes `disabled` class\n     * if present.\n     */\n    $.fn.enable = function () {\n        return this.prop('disabled', false).removeClass('disabled');\n    };\n\n    /**\n     * Check an element.\n     *\n     * Sets `checked` property to `true`.\n     */\n    $.fn.check = function () {\n        return this.prop('checked', true);\n    };\n\n    /**\n     * Un-check an element.\n     *\n     * Sets `checked` property to `false`.\n     */\n    $.fn.uncheck = function () {\n        return this.prop('checked', false);\n    };\n\n    /**\n     * Tooltip\n     */\n    $(document).tooltip({\n        position: {\n            my: 'center bottom-20',\n            at: 'center top',\n            using: function( position, feedback ) {\n                $(this).css(position);\n                $('<div>')\n                    .addClass('arrow')\n                    .addClass(feedback.vertical)\n                    .addClass(feedback.horizontal)\n                    .appendTo(this);\n            }\n        },\n        items: 'rect, .tooltip-item',\n        show: false,\n        hide: false,\n        content: function() {\n            var title = $(this).attr('title');\n            if (!title) return false;\n            var parsedHTML = $.parseHTML(title);\n            return parsedHTML;\n        }\n    });\n\n    /**\n     * Returns true / false if any modal is active.\n     */\n    $.modalActive = function () {\n        var active = false;\n        $('.modal').each(function () {\n            var modal = $(this).data('bs.modal');\n            if (modal) {\n                active = modal.isShown;\n                return !active;\n            }\n        });\n        return active;\n    };\n\n\n    /**\n     * Wiggle an element.\n     *\n     * Used for wiggling BLAST button.\n     */\n    $.fn.wiggle = function () {\n        this.finish().effect('bounce', {\n            direction: 'left',\n            distance: 24,\n            times: 4,\n        }, 250);\n    };\n}(jQuery));\n","// Default Export\n// ==============\n// In this module, we mix our bundled exports into the `_` object and export\n// the result. This is analogous to setting `module.exports = _` in CommonJS.\n// Hence, this module is also the entry point of our UMD bundle and the package\n// entry point for CommonJS and AMD users. In other words, this is (the source\n// of) the module you are interfacing with when you do any of the following:\n//\n// ```js\n// // CommonJS\n// var _ = require('underscore');\n//\n// // AMD\n// define(['underscore'], function(_) {...});\n//\n// // UMD in the browser\n// // _ is available as a global variable\n// ```\nimport * as allExports from './index.js';\nimport { mixin } from './index.js';\n\n// Add all of the Underscore functions to the wrapper object.\nvar _ = mixin(allExports);\n// Legacy Node.js API.\n_._ = _;\n// Export the Underscore API.\nexport default _;\n"],"names":["SearchButton","_Component","props","_this","_classCallCheck","_callSuper","setState","prevState","dropdownVisible","state","methods","hasQuery","hasDatabases","messageTooltip","titleTooltip","hideMessageTooltip","changeAlgorithm","bind","decorate","setMessageTooltipButton","setTitleTooltipButton","renderButton","inputGroup","handleMouseOver","handeMouseOut","inputGroupRef","createRef","_inherits","key","value","_this2","this","timeout","setTimeout","_","_prevProps","length","wiggle","onAlgoChanged","$","current","method","slice","splice","indexOf","unshift","name","match","map","token","_jsx","children","title","clearTimeout","_this3","multi","_jsxs","className","type","concat","id","disabled","onClick","toggleDropdownVisibility","href","ref","onMouseOver","onMouseOut","_Fragment","Component","d3","require","download_url","url","filename","a","select","append","attr","style","node","click","remove","sanitize_filename","str","san","replace","serialize_svg","svg","cloneNode","insert","textContent","get_styles","removeAttribute","setAttributeNS","xmlns","xlink","XMLSerializer","serializeToString","styles","i","document","styleSheets","process_ss","ss","cssRules","e","rule","CSSRule","IMPORT_RULE","styleSheet","selectorText","cssText","handle_click","export_callback","$svg","parents","find","$body","on","blob","window","navigator","msSaveOrOpenBlob","URL","createObjectURL","generate_blob_url","Exporter","Blob","canvas","getElementById","height","width","img","Image","onload","getContext","drawImage","toDataURL","svgString","encodedSvg","encodeURIComponent","p1","String","fromCharCode","src","btoa","alert","CollapsePreferences","component","defaultCollapsed","arguments","undefined","storageKey","collapseStates","JSON","parse","localStorage","getItem","currentlyCollapsed","collapsed","setItem","stringify","plusIcon","minusIcon","Grapher","Graph","alwaysShowName","printing","useDetectPrint","_useState2","_slicedToArray","useState","innerWidth","setWidth","_useState4","setCollapsed","svgContainerRef","graphLinksJSX","svgContainer","draw","graphWidth","empty","dataName","useEffect","handleResize","addEventListener","isCollapsed","collapsePreferences","preferenceStoredAsCollapsed","canCollapse","removeEventListener","printCss","cssClasses","toggleCollapse","renderCollapseIcon","position","top","right","graphId","svgContainerJSX","get_colors_for_evalue","evalue","hits","rgb","domain","d","parseFloat","range","colors","formatNumberUnits","number","suffix","numericPart","toFixed","rounded","Math","round","prettify_evalue","matches","toString","split","base","power","num","den","x","parseInt","$svgContainer","svg_container","$queryDiv","extractData","query","graphIt","query_hits","hit","_hsps","hsps","hsp","_hsp","hspEvalue","hspStart","qstart","hspEnd","qend","hspFrame","sframe","hspId","hspIdentity","identity","hspGaps","gaps","hspPositives","positives","hspLength","push","hitId","hitDef","hitEvalue","$graphDiv","evt","preventDefault","stopPropagation","location","hash","isInit","opts","totalHits","shownHits","lessButton","moreButton","MIN_HITS_TO_SHOW","countHits","initButtons","hide","show","addClass","html","setupButtons","diff","options","svg_legend","margin","legend","text","selectAll","data","offset","color","enter","index","howMany","inhits","defaults","barHeight","extend","queryLen","q_i","seq_type","prefix","suffixes","algorithm","formatter","blastn","blastp","blastx","tblastx","tblastn","amino_acid","nucleic_acid","formatted","_tValues","ticks","pop","xAxis","tickValues","tickFormat","call","y","gradScale","each","v","j","yHspline","hsplineColor","parentNode","alt_tooltip","Helpers","Utils","drawLegend","graphControls","setupClick","$svg_container","_seq_type","query_seq_type","subject_seq_type","query_length","_margin","bottom","left","initiate","_width","_height","hit_lengths","define_scale_and_bins","update_data","draw_rectangles","draw_query_line","draw_axes","_scale_x","_data","nice","_bins","thresholds","_scale_y","currentWidth","console","log","debounced_draw","resize","includes","self","data2","bin","inner_data","reverse","y0","y1","len_index","item","x0","dx","x1","_update_data","query_line","space","len","tick_formatter","x_axis","y_axis","tickSizeOuter","floor","xContainer","convertChunk","fastqChunk","substring","isValidFastq","SearchQueryWidget","_Component2","val","clear","focus","isEmpty","textarea","controls","handleInput","hideShowButton","indicateError","indicateNormal","guessSequenceType","preProcessSequence","notify","textareaRef","controlsRef","direction","removeClass","onSequenceChanged","residuesCount","_type","onSequenceTypeChanged","reduce","count","line","startsWith","target","parent","$sequenceFile","textareaNode","sequenceControlsRight","offsetWidth","clientWidth","css","sequence","trim","tmp","sequences","updatedSequence","trimmedSequence","sequenceLines","fastaChunks","apply","join","fastqToFasta","putative_NA_count","notification_timeout","rows","required","placeholder","spellCheck","autoFocus","onChange","Options","textValue","objectValue","defaultObjectValue","paramsMode","onTextValueChanged","optionsPresetsJSX","advancedParamsJSX","showAdvancedOptionsHelp","max_target_seqs","task","prevProps","predefinedOptions","defaultOptions","attributes","initialTextValue","parsedOptions","words","optionName","Object","keys","presetListJSX","entries","_ref","_ref2","config","description","checked","classNames","htmlFor","blastMethod","toLowerCase","modal","querySelector","_i","_ids","classList","add","showModal","_React$Component","QueryStats","React","Databases","then","mod","default","DatabasesTree","Form","databases","preSelectedDbs","currentlySelectedDbs","preDefinedOpts","tree","residuesInQuerySequence","useTreeWidget","determineBlastMethods","handleSequenceTypeChanged","handleSequenceChanged","handleDatabaseTypeChanged","handleDatabaseSelectionChanged","handleAlgoChanged","handleFormSubmission","formRef","button","setButtonState","_createClass","search","filter","Boolean","job_id","sessionStorage","getJSON","blastTaskMap","handleFirstSelectionDB","setBlastMethods","preselectDatabases","$button","is","ctrlKey","trigger","firstSelectedDb","forEach","db","matchCheckbox","form","display","formData","FormData","fetch","body","res","redirected","open","database_type","databaseType","sequence_type","sequenceType","selectedDbs","algo","sum","ncharacters","background","zIndex","FastqNotification","NucleotideNotification","ProteinNotification","MixedNotification","onSubmit","content","Suspense","fallback","onDatabaseTypeChanged","onDatabaseSelectionChanged","blastTasks","numberOfDatabasesSelected","residuesInSelectedDbs","currentBlastMethod","_Component3","_Component4","_Component5","global","jQuery","fn","disable","prop","enable","check","uncheck","tooltip","my","at","using","feedback","vertical","horizontal","appendTo","items","parseHTML","modalActive","active","isShown","finish","effect","distance","times","mixin"],"sourceRoot":""}