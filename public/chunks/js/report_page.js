/*! For license information please see report_page.js.LICENSE.txt */
(self.webpackChunkSequenceServer=self.webpackChunkSequenceServer||[]).push([[741,432],{4606:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}t=r.nmd(t);var i=r(756),a=Math.PI,o=a/2;function s(t){return"function"==typeof t?t:function(){return t}}function l(t){return t.source}function c(t){return t.target}function u(t){return t.radius}function h(t){return t.startAngle}function d(t){return t.endAngle}var p,f=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1};"function"!=typeof Object.assign&&(Object.assign=function(t){"use strict";var e,r,n;if(null===t)throw new TypeError("Cannot convert undefined or null to object");for(t=Object(t),e=1;e<arguments.length;){if(null!==(n=arguments[e]))for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);e++}return t}),(p=function(t){return new p.Core(t)}).Core=function(t){return this.tracks={heatmaps:{},histograms:{},chords:{},scatters:{},lines:{},stacks:{},highlights:{},texts:{}},this.conf=p.mixConf(t,this.defaultConf),this},p.Core.prototype.removeTracks=function(t){var e,r,a,o,s,l,c,u;for(u in l=i.select(this.conf.container),o=this.tracks)if(s=o[u],"object"===n(t))for(r=0,a=t.length;r<a;r++)(e=t[r])in s&&(l.select("."+e).remove(),delete s[e]);else if("string"==typeof t)t in s&&(l.select("."+t).remove(),delete s[t]);else if(void 0===t)for(c in s)l.select("."+c).remove(),delete s[c];return this},p.Core.prototype.layout=function(t,e){return this._layout=new p.Layout(t,e),this},p.log=function(t,e,r,n){var i;i=["Permanent log","Error","Warning","Info"],console.log("CircosJS: ",i[t]+" ["+e+"] ",r,n)},p.mixConf=function(t,e){var r,i,a;for(r in i={},e)a=e[r],r in t?"[object Array]"===Object.prototype.toString.call(a)?i[r]=t[r]:"object"===n(a)&&null!=a?null!=a&&0===Object.keys(a).length?i[r]=t[r]:i[r]=p.mixConf(t[r],a):i[r]=t[r]:i[r]=a;return i},p.Core.prototype.smartBorders=function(){var t,e,r,n,i,a,o,s,l,c,u,h;for(u in h=this.conf.defaultTrackWidth,i={in:this._layout.conf.innerRadius,out:this._layout.conf.outerRadius},e=[],o=this.tracks)for(c in s=o[u])(l=s[c]).conf.innerRadius&&e.push({in:l.conf.innerRadius,out:l.conf.outerRadius});for(r=i,n=0,a=(e=e.sort((function(t,e){return t.out,e.out,t.out,e.out,0}))).length;n<a;n++){if((t=e[n]).out<r.in-h)return{in:r.in-h,out:r.in};r=t}return r.in>h?{in:r.in-h,out:r.in}:{in:e[0].out,out:e[0].out+h}},null!==t&&(t.exports=p),p.checkParent=function(t,e,r,n){return t in r||(p.log(1,"datum","unknown parent id",{line:e+1,value:t,header:n,layoutSummary:r}),!1)},p.checkNumber=function(t,e){var r,n;for(r in t)if(n=t[r],isNaN(n))return p.log(1,"datum","not a number",{line:e+1,value:n,header:r}),!1;return!0},p.parseChordData=function(t,e){var r;return"source_id"in(r=t[0])&&"source_start"in r&&"target_id"in r&&"target_start"in r&&"target_end"in r&&(t=t.map((function(t){var e;return e=[t.source_id,t.source_start,t.source_end,t.target_id,t.target_start,t.target_end],null!=t.value&&e.push(t.value),e}))),{data:t=t.filter((function(t,r){return p.checkParent(t[0],r,e,"source_id")})).filter((function(t,r){return p.checkParent(t[3],r,e,"target_id")})).filter((function(t,e){return p.checkNumber({source_start:t[1],source_end:t[2],target_start:t[4],target_end:t[5],value:t[6]||1},e)})).map((function(t){return{source:{id:t[0],start:Math.max(0,parseFloat(t[1])),end:Math.min(e[t[0]],parseFloat(t[2]))},target:{id:t[3],start:Math.max(0,parseFloat(t[4])),end:Math.min(e[t[3]],parseFloat(t[5]))},value:parseFloat(t[6]),hsp:t[7]}})),meta:{min:i.min(t,(function(t){return t.value})),max:i.max(t,(function(t){return t.value}))}}},p.Layout=function(t,e){var r,n,i,a,o,s,l,c;for(i in null==e&&p.log(2,"no layout data",""),this.conf=p.mixConf(t,JSON.parse(JSON.stringify(this.defaultConf))),this.data=e,this.blocks={},this.size=0,a=0,o=this.data)c=o[i],this.blocks[c.id]={label:c.label,len:c.len,color:c.color,offset:a},c.offset=a,a+=c.len;for(i in this.size=a,n=this.conf.gap,l=this.size,r=this.data.length,s=this.data)c=s[i],this.blocks[c.id].start=c.offset/l*(2*Math.PI-r*n)+i*n,this.blocks[c.id].end=(c.offset+c.len)/l*(2*Math.PI-r*n)+i*n,c.start=c.offset/l*(2*Math.PI-r*n)+i*n,c.end=(c.offset+c.len)/l*(2*Math.PI-r*n)+i*n;return this.getAngle=function(t,e){var r;return r=this.blocks[t].start/this._size,"deg"===e?360*r:"rad"===e?2*r*Math.PI:null},this.summary=function(){var t,e,r,n,i;for(r={},e=0,n=(i=this._data).length;e<n;e++)r[(t=i[e]).id]=t.len;return r},this},p.Core.prototype.chord=function(t,e,r){var n;return(n=new p.Chord).build(this,e,r),this.tracks.chords[t]=n,this},p.Chord=function(){var t;return p.Track.call(this),this.parseData=p.parseChordData,this.applyRules=function(t,e){var r,n,i,a,o;for(t=t||[],a=[],n=0,i=e.length;n<i;n++)r=e[n],a.push(function(){var e,n,i;for(i=[],n=0,e=t.length;n<e;n++)(o=t[n]).condition(r)?i.push(r[o.parameter]=o.value):i.push(void 0);return i}());return a},this.getSource=function(t,e){var r,n,i;return t=t.source,i=(r=e.blocks[t.id]).start+t.start/r.len*(r.end-r.start),n=r.start+t.end/r.len*(r.end-r.start),{radius:e.conf.innerRadius,startAngle:i,endAngle:n}},this.getTarget=function(t,e){var r,n,i;return t=t.target,i=(r=e.blocks[t.id]).start+t.start/r.len*(r.end-r.start),n=r.start+t.end/r.len*(r.end-r.start),{radius:e.conf.innerRadius,startAngle:i,endAngle:n}},this.dimChords=function(t,e,r,n){t.selectAll("path").style("opacity",(function(t,r){return e===t?1:0}))},this.resetChords=function(t,e){t.selectAll("path").style("opacity",e.opacity)},this.renderChords=function(t,e,r,n,i,p,f,m){var y,b,v;return y=(b=t.append("g").attr("class",r.colorPalette)).selectAll(".chord").data(n).enter().append("path").attr("class","chord").attr("d",function(){var t=l,e=c,r=u,n=h,i=d;function p(r,n){var i,a,o=f(this,t,r,n),s=f(this,e,r,n);return result="M"+o.p0+m(o.r,o.p1,o.a1-o.a0)+(a=s,((i=o).a0==a.a0&&i.a1==a.a1?y(o.p0):y(s.p0)+m(s.r,s.p1,s.a1-s.a0)+y(o.p0))+"Z"),result}function f(t,e,a,s){var l=e.call(t,a,s),c=r.call(t,l,s),u=n.call(t,l,s)-o,h=i.call(t,l,s)-o;return{r:c,a0:u,a1:h,p0:[c*Math.cos(u),c*Math.sin(u)],p1:[c*Math.cos(h),c*Math.sin(h)]}}function m(t,e,r){return"A"+t+","+t+" 0 "+ +(r>a)+",1 "+e}function y(t){return"Q 0,0 "+t}return p.radius=function(t){return arguments.length?(r=s(t),p):r},p.source=function(e){return arguments.length?(t=s(e),p):t},p.target=function(t){return arguments.length?(e=s(t),p):e},p.startAngle=function(t){return arguments.length?(n=s(t),p):n},p.endAngle=function(t){return arguments.length?(i=s(t),p):i},p}().source((function(t){return f(t,i)})).target((function(t){return m(t,i)}))).attr("opacity",(function(t){return r.opacity})).attr("id",(function(t){return t.source.id+"_"+t.target.id})).on("mouseover",(v=this,function(t,e){return v.dimChords(b,e,r),v.dispatch.call("mouseover",t,e)})).on("mouseout",function(t){return function(e,n){return t.resetChords(b,r),t.dispatch.call("mouseout",e,n)}}(this)),r.usePalette?y.attr("class",(function(t){return"q"+p(t.value,r.cmin,r.cmax,r.colorPaletteSize,r.colorPaletteReverse,r.logScale)+"-"+r.colorPaletteSize})):y.attr("fill",(function(t){return t.color||r.color})),y},this.render=(t=this,function(e,r,n){var i,a;if(r.select("."+n).remove(),a=r.append("g").attr("class",n).attr("z-index",t.conf.zIndex),i=t.renderChords(a,n,t.conf,t.data,e._layout,t.ratio,t.getSource,t.getTarget),null!=t.conf.tooltipContent)return p.registerTooltip(e,t,i,t.conf)}),this},p.Track=function(){var t;return this.build=function(t,e,r){return this.dispatch=i.dispatch("mouseover","mouseout"),this.loadData(r,t),this.conf=this.processConf(e,this.defaultConf,this.meta,t,this),this.applyRules(e.rules,this.data)},this.loadData=function(t,e){var r,n,i,a,o,s;for(i={},n=0,a=(o=e._layout.data).length;n<a;n++)i[(r=o[n]).id]=r.len;return s=this.parseData(t,i),this.data=s.data,this.meta=s.meta},this.processConf=function(t,e,r,n,i){var a;return t=p.mixConf(t,Object.assign({},e)),0===(t=i.computeMinMax(t,r)).innerRadius&&0===t.outerRadius&&(a=n.smartBorders(),t.innerRadius=a.in,t.outerRadius=a.out),t},this.applyRules=function(t,e){var r,n,i,a,o,s;for(i in t=t||[],a=[],e)s=e[i],a.push(function(){var e,i;for(n in i=[],e=s.values)r=e[n],i.push(function(){var e,i,a;for(a=[],e=0,i=t.length;e<i;e++)(o=t[e]).condition(s.key,r,n)?a.push(r[o.parameter]=o.value):a.push(void 0);return a}());return i}());return a},this.computeMinMax=function(t,e){return t.cmin="smart"===t.min?e.min:t.min,t.cmax="smart"===t.max?e.max:t.max,t},this.ratio=function(t,e,r,n,i,a){var o,s,l;return s=a?2.3:1,e===r||t===e&&!i||t===r&&i?0:t===r||t===e&&i?n-1:(o=(t-e)/(r-e),l=Math.exp(1/s*Math.log(o)),i&&(l=1-l),Math.floor(n*l))},this.render=(t=this,function(e,r,n){var i,a,o,s;return r.select("."+n).remove(),s=r.append("g").attr("class",n).attr("z-index",t.conf.zIndex),i=t.renderDatumContainer(e,s,n,t.data,t.conf),(null!=(a=t.conf.axes)?a.display:void 0)&&t.renderAxes(i,t.conf,e._layout,t.data),o=t.renderDatum(i,t.conf,e._layout,t),null!=t.conf.tooltipContent&&p.registerTooltip(e,t,o,t.conf),o.on("mouseover",(function(e,r,n){return t.dispatch.mouseover(e,r,n)})),o.on("mouseout",(function(e,r,n){return t.dispatch.mouseout(e,r,n)}))}),this.renderBlock=function(t,e,r,n){var a,o;return o=n.outerRadius-n.innerRadius,a=t.selectAll(".block").data(e).enter().append("g").attr("class","block").attr("transform",(function(t){return"rotate("+360*r.blocks[t.key].start/(2*Math.PI)+")"})),n.backgrounds&&a.selectAll(".background").data(n.backgrounds).enter().append("path").attr("class","background").attr("fill",(function(t){return t.color})).attr("opacity",(function(t){return t.opacity||1})).attr("d",i.arc().innerRadius((function(t){return"in"===n.direction?n.outerRadius-o*t.start:n.innerRadius+o*t.start})).outerRadius((function(t){return"in"===n.direction?n.outerRadius-o*t.end:n.innerRadius+o*t.end})).startAngle((function(t,e,r){return 0})).endAngle((function(t,n,i){return r.blocks[e[i].key].end-r.blocks[e[i].key].start}))),a},this.renderAxes=function(t,e,r,n){var a,o,s;return"pixel"===e.axes.minor.spacingType&&(a=function(){var t,r,n,i;for(i=[],s=t=e.innerRadius,r=e.outerRadius,n=e.axes.minor.spacing;n>0?t<=r:t>=r;s=t+=n)i.push(s);return i}()),o=i.arc().innerRadius((function(t){return t})).outerRadius((function(t){return t})).startAngle(0).endAngle((function(t,e,i){var a;return(a=r.blocks[n[i].key]).end-a.start})),console.log("axis",o),t.selectAll(".axis").data(a).enter().append("path").attr("opacity",e.opacity).attr("class","axis").attr("d",o).attr("stroke-width",(function(t,r){return r%e.axes.major.spacing==0?e.axes.major.thickness:e.axes.minor.thickness})).attr("stroke",(function(t,r){return r%e.axes.major.spacing==0?e.axes.major.color:e.axes.minor.color}))},this.theta=function(t,e){return t/e.len*(e.end-e.start)},this.x=function(t){return function(e,r,n){var i,a,o;return a=t.ratio(e.value,n.cmin,n.cmax,n.outerRadius-n.innerRadius,!1,n.logscale),o="in"===n.direction?n.outerRadius-a:n.innerRadius+a,i=t.theta(e.position,r.blocks[e.block_id])-Math.PI/2,o*Math.cos(i)}}(this),this.y=function(t){return function(e,r,n){var i,a,o;return a=t.ratio(e.value,n.cmin,n.cmax,n.outerRadius-n.innerRadius,!1,n.logscale),o="in"===n.direction?n.outerRadius-a:n.innerRadius+a,i=t.theta(e.position,r.blocks[e.block_id])-Math.PI/2,o*Math.sin(i)}}(this),this.ratio=function(t,e,r,n,i,a){var o,s,l;return s=a?2.3:1,e===r||t===e&&!i||t===r&&i?0:t===r||t===e&&i?n-1:(o=(t-e)/(r-e),l=Math.exp(1/s*Math.log(o)),i&&(l=1-l),Math.floor(n*l))},this},p.renderLayout=function(t,e,r){var n,i,a,o;if(i=r._layout.conf,e.select(".cs-layout").remove(),n=(o=e.append("g").attr("class","cs-layout").attr("z-index",i.zIndex).on("click",i.onClick)).selectAll("g").data(r._layout.data).enter().append("g").attr("class",(function(t){return t.id})).attr("opacity",i.opacity),a=t.arc().innerRadius(i.innerRadius).outerRadius(i.outerRadius).cornerRadius(i.cornerRadius).startAngle((function(t){return t.start})).endAngle((function(t){return t.end})),n.append("path").attr("d",a).attr("fill",(function(t){return t.color})).attr("id",(function(t){return t.id})),i.labels.display&&p.renderLayoutLabels(i,t,n),i.ticks.display)return p.renderLayoutTicks(i,o,t,r)},p.renderLayoutLabels=function(t,e,r){var n,i;return i=t.innerRadius+t.labels.radialOffset,n=e.arc().innerRadius(i).outerRadius(i).startAngle((function(t,e){return t.start})).endAngle((function(t,e){return t.end})),r.append("path").attr("fill","none").attr("stroke","none").attr("d",n).attr("id",(function(t){return"arc-label"+t.id})),r.append("text").attr("font-size",t.labels.size).attr("text-anchor","middle").append("textPath").attr("startOffset","25%").attr("xlink:href",(function(t){return"#arc-label"+t.id})).style("fill",t.labels.color).text((function(t){var e=t.end-t.start;return t.label.slice(0,Math.floor(21*e))+".."}))},p.renderLayoutTicks=function(t,e,r,n){var i,a;return i=function(e){var n,i;n=(e.end-e.start)/e.len,e.end-e.start>1.57?i=8:e.end-e.start>.785?i=4:e.end-e.start>.3925?i=2:e.end-e.start>0&&(i=0);var a=[],o={angle:0*n+e.start,label:0};a.push(o);var s=r.scaleLinear().domain([1,e.len]).range([e.start,e.end]),l=s.ticks(i).length;return s.ticks(i).map((function(r,i){e.start,e.len,e.start;var o={angle:r*n+e.start,label:r/t.ticks.labelDenominator+t.ticks.labelSuffix};a.push(o)})),a.splice(l,1),o={angle:e.len*n+e.start-.006,label:e.len/t.ticks.labelDenominator+t.ticks.labelSuffix},a.push(o),a},(a=e.append("g").selectAll("g").data(n._layout.data).enter().append("g").selectAll("g").data(i).enter().append("g").attr("transform",(function(e){return"rotate("+(180*e.angle/Math.PI-90)+")translate("+t.outerRadius+",0)"}))).append("line").attr("x1",0).attr("y1",1).attr("x2",(function(e,r){return t.ticks.size.major})).attr("y2",1).style("stroke",t.ticks.color),a.append("text").attr("x",8).attr("dy",".35em").attr("transform",(function(t){return t.angle>Math.PI?"rotate(180)translate(-16)":null})).attr("text-anchor",(function(t){return t.angle>Math.PI?"end":null})).attr("font-size",t.ticks.labelSize).style("fill",t.ticks.labelColor).text((function(t){return t.label}))},p.Core.prototype.render=function(t,e){var r,n,a,o,s,l,c,u,h;if(void 0===t&&(o=!0,t=[]),e)for(u in n=this.tracks)for(r in c=n[u])l=c[r],s.select("."+r).remove();for(u in(h=(s=i.select(this.conf.container)).select(".all")).empty()&&(h=(h=s.append("svg").attr("width",this.conf.width).attr("height",this.conf.height)).append("g").attr("class","all").attr("transform","translate("+parseInt(this.conf.width/2)+","+parseInt(this.conf.height/2)+")")),a=this.tracks)for(r in c=a[u])l=c[r],(o||f.call(t,r)>=0)&&l.render(this,h,r);(o||f.call(t,"layout")>=0)&&p.renderLayout(i,h,this)},p.Core.prototype.defaultConf={width:700,height:700,container:"circos",defaultTrackWidth:10},p.Layout.prototype.defaultConf={innerRadius:250,outerRadius:300,cornerRadius:5,gap:.04,opacity:1,labels:{position:"center",display:!0,size:14,color:"#000",radialOffset:20},ticks:{display:!0,color:"grey",spacing:1e7,labels:!0,labelSpacing:10,labelSuffix:"Mb",labelDenominator:1e6,labelDisplay0:!0,labelSize:10,labelColor:"#000",labelFont:"default",majorSpacing:5,size:{minor:2,major:5}},onClick:null,onMouseOver:null,zIndex:100},p.axes={display:!1,minor:{spacing:5,spacingType:"pixel",color:"#d3d3d3",thickness:2},major:{spacing:5,color:"#000000",thickness:2}},p.Chord.prototype.defaultConf={colorPaletteSize:9,colorPalette:"PuBuGn",usePalette:!0,colorPaletteReverse:!1,color:"#fd6a62",opacity:.7,min:"smart",max:"smart",logScale:!1,rules:[],backgrounds:[],zIndex:1,tooltipContent:null},p.registerTooltip=function(t,e,r,n){return e.tip=i.tip().direction("s").offset([20,0]).html(n.tooltipContent),r.call(e.tip),e.dispatch.on("mouseover",(function(t,r,n){return e.tip.attr("class","d3-tip appear").show(t)})),e.dispatch.on("mouseout",(function(t,r,n){return e.tip.attr("class","d3-tip").show(t),e.tip.hide()}))}},151:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>gr});var n=r(6540),i=r.n(n),a=r(4848);const o=function(){return(0,a.jsx)("div",{className:"grid grid-cols-6 gap-4",children:(0,a.jsxs)("div",{className:"col-start-1 col-end-7 text-center pt-3",children:[(0,a.jsxs)("h1",{className:"mb-8 text-4xl",children:[(0,a.jsx)("i",{className:"fa fa-cog fa-spin"}),"  BLAST-ing"]}),(0,a.jsx)("div",{className:"mb-5 w-full",children:(0,a.jsx)("p",{className:"m-auto w-full md:w-6/12 text-sm",children:"This can take some time depending on the size of your query and database(s). The page will update automatically when BLAST is done."})}),(0,a.jsx)("p",{className:"mb-9 text-sm",children:"You can bookmark the page and come back to it later or share the link with someone."}),(0,a.jsx)("p",{className:"text-sm",children:!1})]})})},s=function(t){var e=t.downloadLinks,r=void 0===e?[]:e;return(0,a.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"grid grid-cols-6 gap-4",children:(0,a.jsxs)("div",{className:"col-start-1 col-end-7 text-center",children:[(0,a.jsxs)("h1",{className:"mb-4 text-4xl",children:[(0,a.jsx)("i",{className:"fa fa-exclamation-triangle"}),"  Warning"]}),(0,a.jsx)("p",{className:"mb-2",children:"The BLAST result might be too large to load in the browser. If you have a powerful machine you can try loading the results anyway. Otherwise, you can download the results and view them locally."}),(0,a.jsx)("p",{className:"mb-2 space-x-2",children:r.map((function(t,e){return(0,a.jsx)("a",{href:t.url,className:"btn btn-secondary",children:t.name},"download_link_".concat(e))}))}),(0,a.jsx)("p",{children:(0,a.jsx)("a",{href:location.pathname+"?bypass_file_size_warning=true",className:"py-2 px-3 border border-transparent rounded-md shadow-sm text-white bg-seqblue hover:bg-seqorange focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-seqorange",children:"View results in browser anyway"})})]})})})};const l=function(t,e){!function(t,e,r){var n=[200,400,800,1200,2e3,3e3,5e3];function i(t){var e=t;try{e=JSON.parse(t)}catch(t){console.error("Error parsing JSON:",t)}return e}!function a(){fetch(t).then((function(t){if(!t.ok)throw t;return t.text().then((function(e){return e&&(e=i(e)),console.log({status:t.status,data:e}),{status:t.status,data:e}}))})).then((function(t){var r=t.status,i=t.data;switch(r){case 202:var o;o=1===n.length?n[0]:n.shift(),setTimeout(a,o);break;case 200:console.log(".then2",i),e(i)}})).catch((function(t){t.text?t.text().then((function(e){switch(e=i(e),t.status){case 400:case 422:case 500:console.log(".catch",e,r),r(e);break;default:console.error("Unhandled error:",t.status)}})):console.error("Network error:",t)}))}()}(location.pathname+".json"+location.search,t,e)};var c=r(6860),u=r(756);function h(t,e){var r=u.select("body").append("a").attr("download",e).style("display","none").attr("href",t);r.node().click(),setTimeout((function(){r.remove()}),100)}function d(t){return window.URL.createObjectURL(t)}function p(t,e){void 0!==window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(t,e):h(d(t),e)}function f(t){var e=t.replace(/[^a-zA-Z0-9=_\-]/g,"_");return(e=e.replace(/_{2,}/g,"_")).replace(/^_/,"").replace(/_$/,"")}var m=r(756),y=r(4692),b=function(t){return t=t.cloneNode(!0),m.select(t).attr("version","1.1").insert("defs",":first-child").append("style").attr("class","exported-css").attr("type","text/css").node().textContent=v(),t.removeAttribute("xmlns"),t.removeAttribute("xlink"),t.setAttributeNS(m.namespaces.xmlns,"xmlns",m.namespaces.svg),t.setAttributeNS(m.namespaces.xmlns,"xmlns:xlink",m.namespaces.xlink),'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+(new XMLSerializer).serializeToString(t)},v=function(){for(var t="",e=0;e<document.styleSheets.length;e++)!function e(r){try{if(!r.cssRules)return}catch(t){if("SecurityError"!==t.name)throw t;return}for(var n=0;n<r.cssRules.length;n++){var i=r.cssRules[n];if(i.type===CSSRule.IMPORT_RULE)e(i.styleSheet);else{var a=i.selectorText;a&&-1!==a.indexOf("svg")&&(t+="\n"+i.cssText)}}}(document.styleSheets[e]);return t},g=function(t){return function(){var e=y(this).parents(".grapher").find("svg");return t(e[0],e.attr("data-name")),!1}},x=y("body");function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,j(n.key),n)}}function j(t){var e=function(t){if("object"!=_(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_(e)?e:e+""}x.on("click",".export-to-svg",g((function(t,e){p(new Blob([b(t)],{type:"text/xml"}),e=f(e)+".svg")}))),x.on("click",".export-to-png",g((function(t,e){if(void 0===window.navigator.msSaveOrOpenBlob){var r=document.getElementById("png-exporter"),n=y(t);r.height=5*n.height(),r.width=5*n.width();var i=new Image;i.onload=function(){r.getContext("2d").drawImage(i,0,0,r.width,r.height),e=f(e)+".png",h(r.toDataURL("image/png"),e)};var a=b(t),o=encodeURIComponent(a).replace(/%([0-9A-F]{2})/gi,(function(t,e){return String.fromCharCode("0x"+e)}));i.src="data:image/svg+xml;base64,"+window.btoa(o)}else alert("Exporting PNG images is not supported in Internet Explorer. Please use Chrome or Firefox.")})));var S=function(){return t=function t(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.component=e,this.defaultCollapsed=r,this.storageKey="sequenceServerCollapseStates",this.collapseStates=JSON.parse(localStorage.getItem(this.storageKey))||{}},(e=[{key:"toggleCollapse",value:function(){var t=this.component.state.collapsed;this.component.setState({collapsed:!t}),this.collapseStates[this.component.name]=!t,localStorage.setItem(this.storageKey,JSON.stringify(this.collapseStates))}},{key:"preferenceStoredAsCollapsed",value:function(){return this.component.name in this.collapseStates?this.collapseStates[this.component.name]:this.defaultCollapsed}},{key:"renderCollapseIcon",value:function(){return this.component.state.collapsed?this.plusIcon():this.minusIcon()}},{key:"minusIcon",value:function(){return(0,a.jsx)("i",{className:"print:!hidden fa-regular fa-square-minus"})}},{key:"plusIcon",value:function(){return(0,a.jsx)("i",{className:"print:!hidden fa-regular fa-square-plus"})}}])&&w(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),k=r(2326),q=r(4692);function O(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return P(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?P(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function N(t){return function(e){var r=void 0!==t.alwaysShowName&&t.alwaysShowName(),i=(0,k.A)(),o=t.name(e),s=O((0,n.useState)(window.innerWidth),2),l=s[0],u=s[1],h=O((0,n.useState)(!1),2),d=h[0],p=h[1],f=(0,n.createRef)(),m=function(){return(0,a.jsxs)("div",{className:"hit-links float-right text-right text-blue-300 h-4 print:hidden",children:[(0,a.jsxs)("a",{href:"#",className:"btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer export-to-svg",children:[(0,a.jsx)("i",{className:"fa fa-download"})," SVG"]}),(0,a.jsx)("span",{className:"line px-1",children:"|"}),(0,a.jsxs)("a",{href:"#",className:"btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer export-to-png",children:[(0,a.jsx)("i",{className:"fa fa-download"})," PNG"]})]})},y=function(){return q(f.current)},b=function(){var r="auto";arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(r="900"),y().empty(),d||(y().width(r),new t(y(),e),y().find("svg").attr("data-name",t.dataName(e)))};(0,n.useEffect)((function(){var r=c.Ay.debounce((function(){return u(window.innerWidth)}),125);window.addEventListener("resize",r);var n=v.preferenceStoredAsCollapsed();return p(t.canCollapse()&&(e.collapsed||n)),b(),function(){return window.removeEventListener("resize",r)}}),[]),(0,n.useEffect)((function(){b(i)}),[i,l]);var v=new S({name:o,state:{collapsed:d},setState:function(t){p(t.collapsed)}});if(null===t.name(e))return null;var g=d?"print:hidden":"",x=t.className()+" grapher"+g;return(0,a.jsxs)("div",{className:x,children:[t.canCollapse()?(0,a.jsxs)("div",{className:"grapher-header pr-px",children:[(0,a.jsxs)("h4",{className:"inline-block pl-px m-0 caption cursor-pointer text-sm",onClick:function(){return v.toggleCollapse()},children:[v.renderCollapseIcon(),(0,a.jsx)("span",{className:"print:hidden",children:" "}),t.name(e)]}),!d&&m()]}):r?(0,a.jsxs)("div",{className:"grapher-histogram-header",style:{position:"relative"},children:[(0,a.jsxs)("h4",{className:"caption",children:[" ",t.name(e)]}),(0,a.jsx)("div",{className:"pull-right",style:{position:"absolute",top:0,right:0},children:!d&&m()})]}):(0,a.jsx)("div",{className:"pr-px",children:!d&&m()}),function(){var r=t.className()+" svg-container hidden";return d||(r+=" !block"),(0,a.jsx)("div",{ref:f,id:t.graphId(e),className:r})}()]})}}function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function E(t){var e=function(t){if("object"!=C(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==C(e)?e:e+""}const I=N(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"canCollapse",value:function(){return!1}},{key:"name",value:function(){return null}},{key:"className",value:function(){return null}},{key:"dataName",value:function(t){return null}},{key:"graphId",value:function(){return null}}],null&&A(t.prototype,null),e&&A(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}());function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function T(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,H(n.key),n)}}function H(t){var e=function(t){if("object"!=R(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==R(e)?e:e+""}r(9663);const L=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.parent=e},(e=[{key:"init",value:function(t){}},{key:"queryResult",value:function(t){return null}},{key:"generateStats",value:function(){return(0,a.jsx)(I,{})}}])&&T(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function F(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function M(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?F(Object(r),!0).forEach((function(e){Q(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Q(t,e,r){return(e=function(t){var e=function(t){if("object"!=D(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==D(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return B(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}const U=function(t){var e=z((0,n.useState)({collapsed:null}),2),r=e[0],i=e[1],o=z((0,n.useState)(void 0===t.renderable||t.renderable),2),s=o[0],l=(o[1],new S({name:t.name,state:M({},r),setState:i},t.defaultCollapsed));return null===r.collapsed&&i({collapsed:l.preferenceStoredAsCollapsed()}),s?(0,a.jsxs)("div",{className:"".concat(r.collapsed?"print:!hidden":""),children:[(0,a.jsxs)("h3",{className:"caption font-bold border-b-2 border-seqorange",onClick:function(){return l.toggleCollapse()},children:[l.renderCollapseIcon(),(0,a.jsxs)("span",{children:[" ",t.name]})]}),(0,a.jsx)("div",{className:"mx-1 print:mx-0",children:!r.collapsed&&t.renderContent()})]}):null},J=function(t){return(0,a.jsx)(U,{name:"Run Summary",renderContent:function(){return(0,a.jsxs)("div",{className:"overview mr-0 mb-0",children:[(0,a.jsxs)("p",{className:"m-0 text-sm",children:[(0,a.jsxs)("strong",{children:["SequenceServer ",t.seqserv_version]})," using"," ",(0,a.jsx)("strong",{children:t.program_version}),t.submitted_at&&", query submitted on ".concat(t.submitted_at)]}),(0,a.jsxs)("p",{className:"m-0 text-sm",children:[(0,a.jsx)("strong",{children:" Databases: "}),t.querydb.map((function(t){return t.title})).join(", ")," ","(",t.stats.nsequences," sequences, ",t.stats.ncharacters," characters)"]}),(0,a.jsxs)("p",{className:"m-0 text-sm",children:[(0,a.jsx)("strong",{children:"Parameters: "})," ",c.Ay.map(t.params,(function(t,e){return e+" "+t})).join(", ")]}),(0,a.jsxs)("p",{className:"m-0 text-sm",children:["Please cite:"," ",(0,a.jsx)("a",{href:"https://doi.org/10.1093/molbev/msz185",className:"text-seqblue hover:text-seqorange",children:"https://doi.org/10.1093/molbev/msz185"})]})]})}})};var X=r(4606),G=r.n(X);function V(t,e){var r=m.scaleLog().domain([m.min([1e-5,m.min(e.map((function(t){if(0!==parseFloat(t.evalue))return t.evalue})))]),m.max(e.map((function(t){return t.evalue})))]).range([0,.8])(t);return m.hsl(20,.82,r)}function W(t){var e=t%26,r=t/26|0,n=e?String.fromCharCode(96+e):(--r,"z");return r?W(r)+n:n}function $(t,e){var r=m.format("~s"),n={amino_acid:"aa",nucleic_acid:"bp"};return function(t){var i=r(t);return"".concat(Y(i)).concat(n[e])}}function Y(t){var e=t.replace(/[0-9.]/g,""),r=parseFloat(t).toFixed(2),n=Math.round(10*r)/10;return"".concat(n%1==0?n.toFixed(0):n," ").concat(e)}function K(t){return{blastn:{query_seq_type:"nucleic_acid",subject_seq_type:"nucleic_acid"},blastp:{query_seq_type:"amino_acid",subject_seq_type:"amino_acid"},blastx:{query_seq_type:"nucleic_acid",subject_seq_type:"amino_acid"},tblastx:{query_seq_type:"nucleic_acid",subject_seq_type:"nucleic_acid"},tblastn:{query_seq_type:"amino_acid",subject_seq_type:"nucleic_acid"}}[t]}function Z(t){var e=t.toString().split("e"),r=e[0],n=e[1];return n?"<span>"+parseFloat(r).toFixed(2)+" &times; 10<sup>"+n+"</sup></span>":r%1!=0?parseFloat(r).toFixed(2):r}const tt={format_2_tuple:function(t){return t[0]+" ("+t[t.length-1]+")"},inPercentage:function(t,e){var r=(100*t/e).toFixed(1);return r%1==0?(r=parseInt(r,10),"".concat(r,"%")):"".concat(r,"%")},inFraction:function(t,e){return t+"/"+e},inTwoDecimal:function(t){return t.toFixed(2)},inExponential:function(t){if(0===t)return 0;if(t>=1&&t<10)return this.inTwoDecimal(t);var e=t.toExponential(2).split("e"),r=e[0],n=e[1];return(0,a.jsxs)("span",{children:[r,"×10",(0,a.jsx)("sup",{children:n})]})}};var et=r(4692);function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,it(n.key),n)}}function it(t){var e=function(t){if("object"!=rt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rt(e)?e:e+""}const at=N(function(){return t=function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.queries=[],r.queries.forEach((function(t){t.hits.length>0&&n.queries.push(t)})),this.svgContainer=e,this.seq_type=K(r.program),this.algorithm=r.program,this.width=this.svgContainer.width(),this.height=600,this.innerRadius=200,this.outerRadius=230,this.query_arr=[],this.hit_arr=[],this.layout_arr=[],this.chords_arr=[],this.hsp_count=50,this.denominator=1,this.spacing=20,this.labelSpacing=10,this.initiate()},r=[{key:"canCollapse",value:function(){return!0}},{key:"name",value:function(){return"Chord diagram of queries and their top hits"}},{key:"className",value:function(){return"circos"}},{key:"graphId",value:function(t){return"circos-collapse"}},{key:"dataName",value:function(t){return"Circos-visualisation"}}],(e=[{key:"initiate",value:function(){this.construct_layout(),this.iterator_for_edits(),this.hit_arr=c.Ay.uniq(this.hit_arr),this.handle_spacing(),m.select(this.svgContainer[0]).insert("div",":first-child").attr("class","circosContainer"),this.create_instance(this.svgContainer,this.width,this.height),this.chords_arr.length&&this.layout_arr.length?this.instance_render():this.render_error(),this.setupTooltip()}},{key:"iterator_for_edits",value:function(){this.max_length=this.calculate_max_length(),this.hit_arr.length>10&&this.complex_layout_edits()}},{key:"construct_layout",value:function(){var t=this.queries.length,e=Math.min(16,t),r=(32-e)/e;this.new_layout=[],this.data=c.Ay.map(this.queries,c.Ay.bind(this.processQuery,this,e,r))}},{key:"processQuery",value:function(t,e,r){if(this.query_arr.length<t){var n=r.id,i={len:r.length,color:"#8dd3c7",label:n,id:"Query_"+this.clean_id(r.id),ori_id:n};this.layout_arr.push(i),c.Ay.map(r.hits,c.Ay.bind(this.processHit,this,e,r))}return this.query_arr.push(r.id),r}},{key:"processHit",value:function(t,e,r){if(r.number<t){if(-1==c.Ay.indexOf(this.hit_arr,r.id)){var n=r.id,i=r.length;this.hit_arr.push(r.id);var a={len:i,color:"#80b1d3",label:n,id:"Hit_"+this.clean_id(r.id),ori_id:n};this.layout_arr.push(a)}c.Ay.map(r.hsps,c.Ay.bind(this.processHSP,this,e,r))}return r}},{key:"processHSP",value:function(t,e,r){return this.chords_arr.push(["Query_"+this.clean_id(t.id),r.qstart,r.qend,"Hit_"+this.clean_id(e.id),r.sstart,r.send,e.number,r]),r}},{key:"rearrange_new_layout",value:function(){c.Ay.each(this.new_layout,c.Ay.bind((function(t){"Que"==t.id.slice(0,3)&&this.layout_arr.push(t)}),this)),c.Ay.each(this.new_layout,c.Ay.bind((function(t){"Hit"==t.id.slice(0,3)&&this.layout_arr.push(t)}),this))}},{key:"complex_layout_edits",value:function(){this.delete_from_layout=[],this.delete_from_chords=[],c.Ay.each(this.layout_arr,c.Ay.bind((function(t,e){var r=(t.len/this.max_length).toFixed(3);t.label,r<.1&&"Que"!=t.id.slice(0,3)&&(this.delete_from_layout.push(t),this.hit_arr.slice(c.Ay.indexOf(this.hit_arr,t.label),1))}),this))}},{key:"check_in_chords_arr",value:function(t,e,r){var n=0;c.Ay.each(this.chords_arr,c.Ay.bind((function(r){"Que"==e&&r[0]!=t&&n++}),this)),n==this.chords_arr.length&&(console.log("no record found "+t),this.delete_arr.push(r))}},{key:"find_index_of_hit",value:function(t){var e;return c.Ay.each(this.queries,c.Ay.bind((function(r){c.Ay.each(r.hits,c.Ay.bind((function(r){var n="Hit_"+this.clean_id(r.id);t==n&&(e=r.id)}),this))}),this)),c.Ay.indexOf(this.layout_arr,e)}},{key:"edit_labels",value:function(){console.log("label edits"),c.Ay.each(this.layout_arr,c.Ay.bind((function(t){var e=(t.len/this.max_length).toFixed(3),r=t.label;e<.41?t.label="..":r.length>10?t.label=r.slice(0,2)+"...":t.label=t.ori_id}),this))}},{key:"calculate_multipliers",value:function(){var t=0,e=0;c.Ay.each(this.query_arr,c.Ay.bind((function(e){c.Ay.each(this.data,c.Ay.bind((function(r){e==r.id&&(t+=r.length)}),this))}),this)),c.Ay.each(this.data,c.Ay.bind((function(t){c.Ay.each(t.hits,c.Ay.bind((function(t){c.Ay.indexOf(this.hit_arr,t.id)>=0&&(e+=t.length)}),this))}),this));var r=(t+e)/2;console.log("mid sum "+r+" hit_sum "+e+" query_sum "+t),this.query_multiplier=(r/t).toFixed(3),this.hit_multiplier=(r/e).toFixed(3),console.log("query "+this.query_multiplier+" hit "+this.hit_multiplier)}},{key:"handle_spacing",value:function(){this.max_length>16e3?this.spacing=200:this.max_length>12e3?this.spacing=150:this.max_length>8e3?this.spacing=100:this.max_length>4e3?this.spacing=75:this.max_length>1800&&(this.spacing=50)}},{key:"calculate_max_length",value:function(){var t=0;return c.Ay.each(this.layout_arr,(function(e){t<e.len&&(t=e.len)})),t}},{key:"clean_id",value:function(t){return t.replace(/[^a-zA-Z0-9]/g,"")}},{key:"create_instance",value:function(t,e,r){this.instance=new(G())({container:".circosContainer",width:e,height:r}),this.chord_layout(),this.instance_layout()}},{key:"chord_layout",value:function(){return this.chords_arr.length>32?this.paletteSize=32:this.paletteSize=this.chords_arr.length,{colorPaletteSize:this.paletteSize,colorPalette:"RdYlBu",opacity:.85}}},{key:"instance_layout",value:function(){return{innerRadius:this.innerRadius,outerRadius:this.outerRadius,cornerRadius:1,labels:{display:!0,size:"10px",radialOffset:10},ticks:{display:!0,spacing:this.spacing,labelSpacing:this.labelSpacing,labelDenominator:this.denominator,labelSuffix:"",labelSize:"10px",majorSpacing:this.labelSpacing,size:{minor:0,major:4}}}}},{key:"instance_render",value:function(){this.instance.layout(this.instance_layout(),this.layout_arr),this.instance.chord("chord1",this.chord_layout(),this.chords_arr),this.instance.render()}},{key:"render_error",value:function(){this.svgContainer.find("svg").remove(),this.svg=m.select(this.svgContainer[0]).insert("svg",":first-child").attr("width",this.svgContainer.width()).attr("height",this.svgContainer.height()).append("g").attr("class","circos-error").attr("transform","translate("+this.svgContainer.width()/2+","+this.svgContainer.height()/2+")").append("text").attr("text-anchor","start").attr("dy","-0.25em").attr("x",-175).style("font-size","14px").text("Chord diagram looks great with fewer than 16 queries")}},{key:"layoutReset",value:function(){this.layoutHide=[],c.Ay.each(this.layout_arr,(function(t){et("."+t.id).css("opacity",1)}))}},{key:"chordsReset",value:function(){this.chordsHide=[],c.Ay.each(this.chords_arr,(function(t){var e=t[1]+t[2],r=t[4]+t[5];et("#"+t[0]+"_"+e+"_"+t[3]+"_"+r).show()}))}},{key:"chordsCheck",value:function(t,e){c.Ay.each(this.chords_arr,c.Ay.bind((function(r,n){"Que"==e&&r[0]==t&&(this.chordsHide.push(n),this.layoutHide.push(r[3])),"Hit"==e&&r[3]==t&&(this.chordsHide.push(n),this.layoutHide.push(r[0]))}),this))}},{key:"chordsClean",value:function(){c.Ay.each(this.chords_arr,c.Ay.bind((function(t,e){if(-1==c.Ay.indexOf(this.chordsHide,e)){var r=t[1]+t[2],n=t[4]+t[5];et("#"+t[0]+"_"+r+"_"+t[3]+"_"+n).hide()}}),this))}},{key:"layoutClean",value:function(){c.Ay.each(this.layout_arr,c.Ay.bind((function(t,e){-1==c.Ay.indexOf(this.layoutHide,t.id)&&et("."+t.id).css("opacity",.1)}),this))}},{key:"setupTooltip",value:function(){var t={};et(".circos-distribution").on("click",c.Ay.bind((function(e){e.stopPropagation(),this.layoutReset(),this.chordsReset(),t={}}),this)),c.Ay.each(this.query_arr,c.Ay.bind((function(e,r){this.chordsHide=[],this.layoutHide=[],e&&et(".circos .Query_"+this.clean_id(e)).attr("title",e).on("click",c.Ay.bind((function(n){if(n.stopPropagation(),t[r]!=e){t[r]=e;var i="Query_"+this.clean_id(e);this.layoutHide.push(i),this.chordsCheck(i,"Que"),this.chordsClean(),this.layoutClean()}else t[r]=0,this.layoutReset(),this.chordsReset()}),this))}),this)),c.Ay.each(this.hit_arr,c.Ay.bind((function(e,r){this.chordsHide=[],this.layoutHide=[],e&&et(".circos .Hit_"+this.clean_id(e)).attr("title",e).on("click",c.Ay.bind((function(n){if(n.stopPropagation(),t[r]!=e){t[r]=e;var i="Hit_"+this.clean_id(e);this.layoutHide.push(i),this.chordsCheck(i,"Hit"),this.chordsClean(),this.layoutClean()}else t[r]=0,this.layoutReset(),this.chordsReset()}),this))}),this));var e=this.algorithm;c.Ay.each(this.chords_arr,(function(t){et("#"+t[0]+"_"+t[3]).attr("title",(function(){var r="E value: "+Z(t[7].evalue)+", Identities: ".concat(tt.inPercentage(t[7].identity,t[7].length));return"blastn"!=e&&(r+="<br>Positives: ".concat(tt.inPercentage(t[7].positives,t[7].length))),r+", Gaps: ".concat(tt.inPercentage(t[7].gaps,t[7].length))}))})),et(".circos").tooltip({position:{my:"left+3 bottom-3",at:"right bottom",using:function(t,e){et(this).css(t),et("<div>").addClass("arrow").addClass(e.vertical).addClass(e.horizontal).appendTo(this)}},items:".chord1 path, .cs-layout g",show:!1,hide:!1,content:function(){var t=et(this).attr("title");return!!t&&et.parseHTML(t)}})}},{key:"ratioCalculate",value:function(t,e,r,n,i,a){var o,s,l;return s=a?2.3:1,e===r||t===e&&!i||t===r&&i?0:t===r||t===e&&i?n-1:(o=(t-e)/(r-e),l=Math.exp(1/s*Math.log(o)),i&&(l=1-l),Math.floor(n*l))}},{key:"drawLegend",value:function(){this.ratioHSP=[],c.Ay.each(this.chords_arr,c.Ay.bind((function(t){var e={number:t[6],evalue:t[7].evalue};this.ratioHSP.push(e)}),this));var t=m.min(this.ratioHSP,(function(t){return t.number})),e=m.max(this.ratioHSP,(function(t){return t.number}));console.log("chords_arr "+this.chords_arr.length),console.log("ratioHSP test "+this.ratioHSP.length),console.log("paletteSize "+this.paletteSize),console.log("min "+t+" max "+e),this.legend=m.select(this.svgContainer[0]).insert("svg",":first-child").attr("height",20).attr("width",30*this.ratioHSP.length).attr("transform","translate(10, 10)").append("g").attr("class","RdYlBu").attr("transform","translate(10, 0)"),this.legend.selectAll(".bar").data(this.ratioHSP).enter().append("g").attr("class","g").attr("transform",(function(t,e){return"translate("+30*e+",0)"})).append("rect").attr("class",c.Ay.bind((function(r,n){var i=this.ratioCalculate(r.number,t,e,this.paletteSize,!1,!1);return console.log("calc ratio "+i),"q"+i+"-"+this.paletteSize}),this)).attr("title",(function(t){return t.evalue})).attr("x",1).attr("width",30).attr("height",20),m.scaleLinear().domain([0,250]).range([0,100])}}])&&nt(t.prototype,e),r&&nt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()),ot=function(t){var e=t.queries,r=t.program,n=t.plugins,i=function(){var t=0;return e.some((function(e){return(t+=e.hits.length)>1}))};return(0,a.jsx)(U,{name:"Graphical Overview",renderContent:function(){return i()?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(at,{queries:e,program:r}),n.generateStats(e)]}):null},renderable:i(),defaultCollapsed:!0})};var st=r(4692);function lt(t){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(t)}function ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ut(n.key),n)}}function ut(t){var e=function(t){if("object"!=lt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==lt(e)?e:e+""}var ht=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.svg_container=e;var n=e.parents(".resultn"),i=this.extractData(r.query.hits,r.query.number);this.graphIt(n,e,0,20,null,i)},e=[{key:"extractData",value:function(t,e){var r=[];return t.map((function(t){var n=[],i=t.hsps;c.Ay.each(i,(function(r){var i={};i.hspEvalue=r.evalue,i.hspStart=r.qstart,i.hspEnd=r.qend,i.hspFrame=r.sframe,i.hspId="Query_"+e+"_hit_"+t.number+"_hsp_"+r.number,i.hspIdentity=r.identity,i.hspGaps=r.gaps,i.hspPositives=r.positives,i.hspLength=r.length,n.push(i)})),n.hitId=t.id,n.hitDef="Query_"+e+"_hit_"+t.number,n.hitEvalue=t.hsps[0].evalue,r.push(n)})),r}},{key:"setupClick",value:function(t){st("a",t).click((function(t){t.preventDefault(),t.stopPropagation(),window.location.hash=st(this).attr("href")}))}},{key:"graphControls",value:function(t,e,r,n,i){var a,o,s,l,u=20,h=function(){a=i.length,o=t.find(".ghit > g").length},d=function(){h(),a===u||o<u?(s.hide(),l.hide()):o===a?(l.hide(),s.show()):o===u?(s.hide(),l.show()):(s.show(),l.show())};!0===r&&(function(t,e){e.append(st("<button/>").addClass("btn btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer more").attr("type","button").attr("data-parent-query",t.attr("id")).html("View More&nbsp;").append(st("<i/>").html("&nbsp;&nbsp;").addClass("fa fa-angle-double-down")),st("<button/>").addClass("btn btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer less").attr("type","button").attr("data-parent-query",t.attr("id")).html("View Less&nbsp;").append(st("<i/>").html("&nbsp;&nbsp;").addClass("fa fa-angle-double-up"))),s=st(".less",e),l=st(".more",e)}(t,e),d()),l.on("click",c.Ay.bind((function(r){h(),this.graphIt(t,e,o,u,n,i),d(),r.stopPropagation()}),this)),s.on("click",c.Ay.bind((function(r){h();var a=o-u;a>=u?(this.graphIt(t,e,o,-20,n,i),d()):0!==a&&(this.graphIt(t,e,o,u-o,n,i),d()),r.stopPropagation()}),this))}},{key:"drawLegend",value:function(t,e,r,n,i){var a=t.append("g").attr("transform","translate(0,"+(n-1.75*e.margin)+")");a.append("rect").attr("x",7.5*(r-2*e.margin)/10).attr("width",2*(r-4*e.margin)/10).attr("height",e.legend).attr("fill","url(#legend-grad)"),a.append("text").attr("class"," legend-text").attr("transform","translate(0, "+e.legend+")").attr("x",9.5*(r-2*e.margin)/10+e.margin/2).text("Weaker hits"),a.append("text").attr("class"," legend-text").attr("transform","translate(0, "+e.legend+")").attr("x",6.7*(r-2*e.margin)/10-e.margin/2).text("Stronger hits"),t.append("linearGradient").attr("id","legend-grad").selectAll("stop").data([{offset:"0%",color:"#000"},{offset:"45%",color:"#c74f14"},{offset:"100%",color:"#f6bea2"}]).enter().append("stop").attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color}))}},{key:"graphIt",value:function(t,e,r,n,i,a){var o={barHeight:4,legend:a.length>1?3:0,margin:20},s=st.extend(o,i),l=a.slice(0,r+n);if(l.length<1)return!1;0!==r&&e.find("svg").remove();var c=t.data().queryLen,u=t.attr("id"),h=e.width(),d=l.length*s.barHeight+2*s.legend+4*s.margin,p=m.select(e[0]).selectAll("svg").data([l]).enter().insert("svg",":first-child").attr("width",h).attr("height",d).append("g").attr("transform","translate("+s.margin/2+", "+1.5*s.margin+")"),f=m.scaleLinear().range([0,h-s.margin]);f.domain([1,c]);var y=t.data().algorithm,b=$(0,{blastn:"nucleic_acid",blastp:"amino_acid",blastx:"nucleic_acid",tblastx:"nucleic_acid",tblastn:"amino_acid"}[y]),v=f.ticks(11);v.pop();var g=m.axisBottom(f).tickValues(v.concat([1,c])).tickFormat(b);p.append("g").attr("transform","translate(0, "+s.margin+")").append("g").attr("class","x axis").call(g).selectAll("text").attr("x","25px").attr("y","2px").attr("transform","rotate(-90)");var x=m.scaleBand().range([0,d-3*s.margin-2*s.legend],.3);x.domain(l.map((function(t){return t.hitId})));var _=m.scaleLog().domain([m.min([1e-5,m.min(l.map((function(t){if(0!==parseFloat(t.hitEvalue))return t.hitEvalue})))]),m.max(l.map((function(t){return t.hitEvalue})))]).range([0,.8]);p.append("g").attr("class","ghit").attr("transform","translate(0, "+1.65*(s.margin-s.legend)+")").selectAll(".hits").data(l).enter().append("g").each((function(t,e){m.select(this).selectAll(".hsp").data(t).enter().append("a").each((function(r,n){var i=x(t.hitId)+s.barHeight/2,a=m.hsl(20,.82,_(r.hspEvalue));n+1<t.length&&(t[n].hspEnd<=t[n+1].hspStart?m.select(this.parentNode).append("line").attr("x1",f(t[n].hspEnd)).attr("y1",i).attr("x2",f(t[n+1].hspStart)).attr("y2",i).attr("stroke",a):t[n].hspStart>t[n+1].hspEnd&&m.select(this.parentNode).append("line").attr("x1",f(t[n+1].hspEnd)).attr("y1",i).attr("x2",f(t[n].hspStart)).attr("y2",i).attr("stroke",a));var o=t.hitId+"<br>E value: "+Z(r.hspEvalue)+"<br>Identities: ".concat(tt.inPercentage(r.hspIdentity,r.hspLength));"blastn"!=y&&(o+="<br>Positives: ".concat(tt.inPercentage(r.hspPositives,r.hspLength))),o+=", Gaps: ".concat(tt.inPercentage(r.hspGaps,r.hspLength)),m.select(this).attr("xlink:href","#"+u+"_hit_"+(e+1)).append("rect").attr("title",o).attr("class","bar").attr("x",(function(t){return f(t.hspStart)})).attr("y",x(t.hitId)).attr("width",(function(t){return f(t.hspEnd-t.hspStart+1)})).attr("height",s.barHeight).attr("fill",m.rgb(a))}))})),l.length>1&&this.drawLegend(p,s,h,d,a),0===r&&this.graphControls(t,e,!0,i,a),this.setupClick(e)}}],r=[{key:"canCollapse",value:function(){return!0}},{key:"name",value:function(){return"Graphical overview of aligning hit sequences to the query"}},{key:"className",value:function(){return"alignment-overview"}},{key:"graphId",value:function(t){return"alignment_"+t.query.number}},{key:"dataName",value:function(t){return"Alignment-Overview-"+t.query.id}}],e&&ct(t.prototype,e),r&&ct(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();const dt=N(ht);var pt=r(4692);function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yt(n.key),n)}}function yt(t){var e=function(t){if("object"!=ft(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ft(e)?e:e+""}const bt=N(function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.query=r.query,this._seq_type=K(r.algorithm),this.svg_container=e,"blastx"==r.algorithm?this.query_length=this.query.length/3:"tblastn"==r.algorithm?this.query_length=3*this.query.length:this.query_length=this.query.length,this._margin={top:30,right:25,bottom:55,left:12.5},this.initiate(e.width(),e.height())},e=[{key:"initiate",value:function(t,e){this._width=t-this._margin.left-this._margin.right,this._height=e-this._margin.top-this._margin.bottom,this.svg=m.select(this.svg_container[0]).insert("svg",":first-child").attr("width",this._width+this._margin.right+this._margin.left).attr("height",this._height+this._margin.top+this._margin.bottom).append("g").attr("transform","translate("+this._margin.left+","+this._margin.top+")"),this.hit_lengths(),this.define_scale_and_bins(),this.update_data(),this.draw()}},{key:"draw",value:function(){this.draw_rectangles(),this.draw_query_line(),this.draw_axes()}},{key:"define_scale_and_bins",value:function(){this._scale_x=m.scaleLinear().domain([0,1.01*m.max([this.query_length,m.max(this._data)])]).nice().range([0,this._width]),this._bins=m.bin().domain(this._scale_x.domain()).thresholds(this._scale_x.ticks(50))(this._data),this._scale_y=m.scaleLinear().domain([0,m.max(this._bins,(function(t){return t.length}))]).range([this._height,0]).nice()}},{key:"hit_lengths",value:function(){this._data=c.Ay.map(this.query.hits,c.Ay.iteratee("length"))}},{key:"setupResponsiveness",value:function(){var t=pt(window).width();console.log("cureent "+t);var e=c.Ay.debounce(c.Ay.bind((function(){t!=pt(window).width()&&(console.log("redraw initiated "+this._height),this.draw(),t=pt(window).width())}),this),125);pt(window).resize(e)}},{key:"tick_formatter",value:function(t){var e=this._scale_x.ticks(),r=m.format("~s"),n={amino_acid:"aa",nucleic_acid:"bp"};return function(i){if(0!==i&&e.includes(i)){if("aa"===n[t])return"".concat(i," ").concat(n[t]);var a=r(i);return"".concat(Y(a)).concat(n[t])}}}},{key:"update_data",value:function(){var t=this,e=[];this._bins.map((function(r){var n=[];r.reverse();var i=r.length;r.map((function(e,a){var o=r.length-(a+1),s=c.Ay.findIndex(t.query.hits,{length:e}),l=t.query.hits[s].hsps[0].evalue,u={value:e,id:t.query.hits[s].id,evalue:l,url:"#Query_"+t.query.number+"_hit_"+t.query.hits[s].number,y0:i,y1:i+=o-i,color:V(l,t.query.hits)};n.push(u)}));var a={data:n,x:r.x0,dx:r.x1,length:r.length};e.push(a)})),this._update_data=e}},{key:"draw_rectangles",value:function(){var t=this;this.svg.selectAll(".bar").data(this._update_data).enter().append("g").attr("class","g").attr("transform",(function(e){return"translate("+(t._scale_x(e.x)+t._margin.left)+",0)"})).selectAll("rect").data((function(t){return t.data})).enter().append("a").attr("xlink:href",(function(t){return t.url})).append("rect").attr("class","bar").attr("title",(function(t){return t.id+" <br>E value: "+Z(t.evalue)+"<br>Length: "+t.value})).attr("x",1).attr("y",(function(e){return t._scale_y(e.y0)})).attr("width",t._scale_x(this._bins[1].x0)-t._scale_x(this._bins[0].x0)-1).attr("height",(function(e){return t._scale_y(e.y1)-t._scale_y(e.y0)})).attr("fill",(function(t){return t.color}))}},{key:"draw_query_line",value:function(){var t=this.svg.append("g").attr("class","query_line").attr("transform","translate("+(this._margin.left+this._scale_x(this.query_length))+",0)");t.append("rect").attr("x",1).attr("class","bar").attr("width",4).attr("height",this._height).style("fill","#c74f14"),t.append("text").attr("dy","0.75em").attr("y",-10).attr("x",2).attr("text-anchor","start").text("Query").style("fill","#000").attr("transform","rotate(-45)")}},{key:"draw_axes",value:function(){var t,e;t=(e=this._scale_y.ticks().length)>=5?5:e;var r=this.tick_formatter(this._seq_type.subject_seq_type),n=m.axisTop(this._scale_x).ticks(50).tickFormat(r),i=m.axisLeft(this._scale_y).tickValues(this._scale_y.ticks(t)).tickSizeOuter(0).tickFormat((function(t){if(Math.floor(t)==t)return t})),a=this._scale_y.ticks();for(var o in a)if(a[o]%1!=0){i.tickValues(m.range(0,m.max(this._bins,(function(t){return t.length}))+1));break}var s=this,l=this.svg.append("g").attr("class","axis axis--x").attr("transform","translate("+this._margin.left+","+this._height+")").call(n);l.selectAll("line").attr("y2",(function(t){var e=s._scale_x.ticks();return c.Ay.indexOf(e,t)>=0?7:4})),l.selectAll("text").style("text-anchor","end").attr("x","-8px").attr("y","3px").attr("dy","0").attr("transform","rotate(-90)"),this.svg.append("g").attr("class","axis axis--y").attr("transform","translate("+this._margin.left+",0)").call(i)}}],r=[{key:"canCollapse",value:function(){return!0}},{key:"name",value:function(){return"Length distribution of matching hit sequences"}},{key:"className",value:function(){return"length-distribution"}},{key:"graphId",value:function(t){return"length_"+t.query.number}},{key:"dataName",value:function(t){return"length-distribution-"+t.query.id}}],e&&mt(t.prototype,e),r&&mt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}());function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function gt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wt(n.key),n)}}function _t(t,e,r){return e&&xt(t.prototype,e),r&&xt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wt(t){var e=function(t){if("object"!=vt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=vt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==vt(e)?e:e+""}function jt(t,e,r){return e=kt(e),function(t,e){if(e&&("object"==vt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,St()?Reflect.construct(e,r||[],kt(t).constructor):e.apply(t,r))}function St(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(St=function(){return!!t})()}function kt(t){return kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},kt(t)}function qt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ot(t,e)}function Ot(t,e){return Ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ot(t,e)}r(7917),r(4692);var Pt=function(t){function e(){return gt(this,e),jt(this,e,arguments)}return qt(e,t),_t(e,[{key:"shouldComponentUpdate",value:function(){return!this.props.query}},{key:"domID",value:function(){return"Query_"+this.props.query.number}},{key:"queryLength",value:function(){return this.props.query.length}},{key:"numhits",value:function(){return this.props.query.hits.length}},{key:"headerJSX",value:function(){var t="Length: ".concat(this.queryLength().toLocaleString());return this.props.showQueryCrumbs&&(t="query ".concat(this.props.query.number,". ").concat(t)),(0,a.jsxs)("div",{className:"section-header border-b border-seqorange justify-between w-full flex flex-col sm:flex-row gap-4",children:[(0,a.jsxs)("h3",{className:"text-base cursor-pointer flex flex-col sm:flex-row items-start",children:[(0,a.jsxs)("strong",{children:["Query=",(0,a.jsx)("span",{className:"ml-1",children:this.props.query.id})]}),(0,a.jsx)("span",{className:"ml-1",children:this.props.query.title})]}),(0,a.jsx)("span",{className:"label first-letter:capitalize text-sm text-right font-normal text-inherit pt-0 px-0",children:t})]})}},{key:"hitsListJSX",value:function(){return(0,a.jsxs)("div",{className:"pt-0 px-0 pb-px",children:[(0,a.jsx)(dt,{query:this.props.query,program:this.props.program,collapsed:this.props.veryBig},"GO_"+this.props.query.number),(0,a.jsx)(bt,{query:this.props.query,algorithm:this.props.program},"LD_"+this.props.query.id),(0,a.jsx)(Nt,{query:this.props.query,imported_xml:this.props.imported_xml},"HT_"+this.props.query.number)]})}},{key:"noHitsJSX",value:function(){return(0,a.jsx)("div",{className:"pt-0 px-0 pb-px",children:(0,a.jsx)("strong",{children:" ****** No BLAST hits found ****** "})})}},{key:"render",value:function(){return(0,a.jsxs)("div",{className:"resultn mt-1.5",id:this.domID(),"data-query-len":this.props.query.length,"data-algorithm":this.props.program,children:[this.headerJSX(),this.numhits()&&this.hitsListJSX()||this.noHitsJSX()]})}}])}(n.Component),Nt=function(t){function e(t){var r;return gt(this,e),(r=jt(this,e,[t])).name="Hit sequences producing significant alignments",r.collapsePreferences=new S(r),r.state={collapsed:r.collapsePreferences.preferenceStoredAsCollapsed()},r}return qt(e,t),_t(e,[{key:"tableJSX",value:function(){var t=c.Ay.every(this.props.query.hits,(function(t){return""!==t.sciname})),e=55;return t&&(e-=15),this.props.imported_xml&&(e+=15),(0,a.jsxs)("table",{className:"table table-hover table-condensed tabular-view text-sm min-w-full mb-0",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"text-neutral-500",children:[(0,a.jsx)("th",{className:"text-left font-normal",children:"#"}),(0,a.jsx)("th",{style:{width:"".concat(e,"%")},className:"text-left font-normal",children:"Similar sequences"}),t&&(0,a.jsx)("th",{className:"text-left font-normal w-2/12",children:"Species"}),!this.props.imported_xml&&(0,a.jsx)("th",{className:"text-right font-normal w-2/12",children:"Query coverage (%)"}),(0,a.jsx)("th",{className:"text-right font-normal w-1/12",children:"Total score"}),(0,a.jsx)("th",{className:"text-right font-normal w-1/12",children:"E value"}),(0,a.jsx)("th",{className:"text-right font-normal w-1/12",children:"Identity (%)"})]})}),(0,a.jsx)("tbody",{children:c.Ay.map(this.props.query.hits,c.Ay.bind((function(e){return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"text-left",children:e.number+"."}),(0,a.jsx)("td",{children:(0,a.jsxs)("a",{href:"#Query_"+this.props.query.number+"_hit_"+e.number,className:"text-sm text-seqblue hover:text-seqorange cursor-pointer pe-1 line-clamp-1 tooltip-item",title:"".concat(e.id," ").concat(e.title),children:[e.id," ",e.title]})}),t&&(0,a.jsx)("td",{className:"pe-1 line-clamp-1 tooltip-item",title:e.sciname,children:e.sciname}),!this.props.imported_xml&&(0,a.jsx)("td",{className:"text-right",children:e.qcovs}),(0,a.jsx)("td",{className:"pe-1 text-right",children:e.total_score}),(0,a.jsx)("td",{className:"pe-1 text-right",children:tt.inExponential(e.hsps[0].evalue)}),(0,a.jsx)("td",{className:"pe-1 text-right",children:tt.inPercentage(e.hsps[0].identity,e.hsps[0].length)})]},e.number)}),this))})]})}},{key:"render",value:function(){var t=this;return(0,a.jsxs)("div",{className:"table-hit-overview ".concat(this.state.collapsed?"print:hidden":""),children:[(0,a.jsx)("div",{className:"grapher-header pr-px",children:(0,a.jsxs)("h4",{className:"inline-block pl-px m-0 caption cursor-pointer text-sm caption",onClick:function(){return t.collapsePreferences.toggleCollapse()},children:[this.collapsePreferences.renderCollapseIcon(),(0,a.jsxs)("span",{children:[" ",this.name]})]})}),(0,a.jsx)("div",{id:"Query_"+this.props.query.number+"HT_"+this.props.query.number,className:"overflow-auto md:overflow-hidden",children:!this.state.collapsed&&this.tableJSX()})]})}}])}(n.Component),Ct=r(4692);function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function Et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,It(n.key),n)}}function It(t){var e=function(t){if("object"!=At(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=At(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==At(e)?e:e+""}const Rt=N(function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._zoom_scale_by=1.4,this._padding_x=12,this._padding_y=55,this._canvas_height=e.height(),this._canvas_width=e.width(),this._results=K(r.algorithm),this._query_id=r.query.id,this._subject_id=r.hit.id,this._query_length=r.query.length,this._subject_length=r.hit.length,this._show_numbers=r.showHSPCrumbs,this._hsps=r.hit.hsps,this._maxBitScore=r.query.hits[0].hsps[0].bit_score,this.svgContainer_d3=m.select(e[0]),this._svg={},this._svg.jq=Ct(this._svg.raw),this._scales=this._create_scales(),this.use_complement_coords=!1,this._axis_ticks=10,this._initiate(),this.bindHoverHandler(e)},r=[{key:"canCollapse",value:function(){return!0}},{key:"name",value:function(){return"Graphical overview of aligning region(s)"}},{key:"className",value:function(){return"kablammo"}},{key:"graphId",value:function(t){return"kablammo_"+t.query.number+"_"+t.hit.number}},{key:"dataName",value:function(t){return"Kablammo_query-".concat(t.query.number,"_").concat(t.query.id,"_").concat(t.hit.id)}}],(e=[{key:"bindHoverHandler",value:function(t){t.find("polygon").hover((function(){var t=Ct(this).parent();t.parent().append(t)}))}},{key:"_initiate",value:function(){this._svg.d3=this.svgContainer_d3.insert("svg",":first-child").attr("height",this._canvas_height).attr("width",this._canvas_width),this._svg.raw=this._svg.d3._groups[0][0],this._render_graph()}},{key:"_rotate_axis_labels",value:function(t,e,r,n){t.style("text-anchor",e).attr("x",r).attr("y",n).attr("dx",0).attr("dy",0).attr("transform","rotate(-90)")}},{key:"_create_axis",value:function(t,e,r,n,i,a,o){var s,l=$(0,o),c=t.ticks();c.pop(),(s="top"===e?m.axisTop(t):m.axisBottom(t)).ticks(this._axis_ticks).tickValues(c.concat(t.domain())).tickFormat(l);var u=this._svg.d3.append("g").attr("class","axis").attr("transform","translate(0,"+r+")").call(s);return this._rotate_axis_labels(u.selectAll("text"),n,i,a),u}},{key:"_is_domain_within_orig",value:function(t,e){return t[0]<=e[0]&&t[1]>=e[1]}},{key:"_zoom_scale",value:function(t,e,r,n){var i=t.domain()[0],a=t.domain()[1];if(i=r-(r-i)/n,a=r+(a-r)/n,i=Math.round(i),!((a=Math.round(a))-i<this._axis_ticks)){var o=[i,a];this._is_domain_within_orig(e,o)?t.domain(o):t.domain(e)}}},{key:"_pan_scale",value:function(t,e,r){var n=-r*((t.domain()[1]-t.domain()[0])/(t.range()[1]-t.range()[0])),i=t.domain(),a=[i[0]+n,i[1]+n];this._is_domain_within_orig(e,a)&&t.domain(a)}},{key:"_render_polygons",value:function(){var t=this;this._svg.d3.selectAll("*").remove(),this._polygons=this._svg.d3.selectAll("polygon").data(this._hsps.slice().reverse()).enter().append("g").attr("class","polygon"),this._polygons.append("polygon").attr("class","hit").attr("fill",(function(e){return t.determine_colour(e.bit_score/t._maxBitScore)})).attr("points",(function(e){var r=[t._scales.query.scale(e.qstart),t._scales.query.scale(e.qend)],n=[t._scales.subject.scale(e.sstart),t._scales.subject.scale(e.send)];return t.use_complement_coords||(e.qframe<0&&r.reverse(),e.sframe<0&&n.reverse()),[[r[0],t._scales.query.height+1],[n[0],t._scales.subject.height-1],[n[1],t._scales.subject.height-1],[r[1],t._scales.query.height+1]].map((function(t){return t[0]+","+t[1]})).join(" ")})),t._show_numbers&&this._polygons.append("text").attr("x",(function(e){var r=[t._scales.query.scale(e.qstart),t._scales.query.scale(e.qend)],n=[t._scales.subject.scale(e.sstart),t._scales.subject.scale(e.send)];return.5*(.5*(r[1]+n[1])+.5*(r[0]+n[0]))})).attr("y",(function(e){var r=t._scales.query.height;return r+(t._scales.subject.height-r)/2+2})).text((function(t){return W(t.number)}))}},{key:"_overlaps",value:function(t,e,r,n){return Math.min(e,n)>Math.max(t,r)}},{key:"_rects_overlap",value:function(t,e,r){return r=r||0,this._overlaps(t.left-r,t.right+r,e.left,e.right)&&this._overlaps(t.top-r,t.bottom+r,e.top,e.bottom)}},{key:"_render_axes",value:function(){this._create_axis(this._scales.query.scale,"top",this._scales.query.height,"start","9px","2px",this._results.query_seq_type),this._create_axis(this._scales.subject.scale,"bottom",this._scales.subject.height,"end","-11px","3px",this._results.subject_seq_type)}},{key:"_render_graph",value:function(){this._render_polygons(),this._render_axes()}},{key:"_find_nearest_scale",value:function(t){var e=null,r=Number.MAX_VALUE,n=this;return Object.keys(this._scales).forEach((function(i){var a=n._scales[i].scale,o=n._scales[i].height,s=Math.abs(o-t[1]);s<r&&(e=a,r=s)})),e}},{key:"_create_scales",value:function(){var t=[this._padding_x,this._canvas_width-this._padding_x],e=[this._padding_x,this._canvas_width-this._padding_x];this.use_complement_coords||(this._hsps[0].qframe<0&&t.reverse(),this._hsps[0].sframe<0&&e.reverse());var r=m.scaleLinear().domain([1,this._query_length]).range(t),n=m.scaleLinear().domain([1,this._subject_length]).range(e);r.original_domain=r.domain(),n.original_domain=n.domain();var i=this._padding_y;return{subject:{height:this._canvas_height-this._padding_y,scale:n},query:{height:i,scale:r}}}},{key:"_rgba_to_rgb",value:function(t,e){var r=function(t){return t.map((function(t){return t/255}))},n=r(t.slice(0,3));e=r(e);var i=t[3]/255;return[i*n[0]+(1-i)*e[0],i*n[1]+(1-i)*e[1],i*n[2]+(1-i)*e[2]].map((function(t){return Math.round(Math.min(255,255*t))}))}},{key:"determine_colour",value:function(t){var e=.7*t+.3;return"rgb("+this._rgba_to_rgb([199,79,20,255*e],[255,255,255]).join(",")+")"}}])&&Et(t.prototype,e),r&&Et(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}());var Tt=r(4692);function Ht(t,e){var r=Tt("<form/>").attr("method","post").attr("action","get_sequence");function n(t,e){r.append(Tt("<input>").attr("type","hidden").attr("name",t).val(e))}n("sequence_ids",t),n("database_ids",e),n("_csrf",document.querySelector('meta[name="_csrf"]').content),r.appendTo("body").submit().remove()}function Lt(t){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lt(t)}function Dt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ft(n.key),n)}}function Ft(t){var e=function(t){if("object"!=Lt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Lt(e)?e:e+""}var Mt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.prepare_alignments_for_export=this.prepare_alignments_for_export.bind(this),this.export_alignments=this.export_alignments.bind(this)},(e=[{key:"wrap_string",value:function(t,e){return t.match(new RegExp(".{1,".concat(e,"}"),"g")).join("\n")}},{key:"generate_fasta",value:function(t){var e="";return t.map((function(t){e+=">".concat(t.query_id,":").concat(t.qstart,"-").concat(t.qend,"\n"),e+="".concat(t.qseq,"\n"),e+=">".concat(t.query_id,":").concat(t.qstart,"-").concat(t.qend,"_alignment_").concat(t.hit_id,":").concat(t.sstart,"-").concat(t.send,"\n"),e+="".concat(t.midline,"\n"),e+=">".concat(t.hit_id,":").concat(t.sstart,"-").concat(t.send,"\n"),e+="".concat(t.sseq,"\n")})),e}},{key:"get_alignments_download_metadata",value:function(t,e){var r=this.generate_fasta(t),n=new Blob([r],{type:"text/fasta"});return{filename:f(e)+".txt",blob:n}}},{key:"prepare_alignments_for_export",value:function(t,e){var r=this.get_alignments_download_metadata(t,e);return r.filename,d(r.blob)}},{key:"export_alignments",value:function(t,e){var r=this.get_alignments_download_metadata(t,e),n=r.filename;p(r.blob,n)}}])&&Dt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Qt(t){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(t)}function zt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bt(n.key),n)}}function Bt(t){var e=function(t){if("object"!=Qt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Qt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Qt(e)?e:e+""}const Ut=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hit=e},(e=[{key:"buttons",value:function(){return[]}}])&&zt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function Xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Gt(n.key),n)}}function Gt(t){var e=function(t){if("object"!=Jt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Jt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jt(e)?e:e+""}function Vt(t,e,r){return e=$t(e),function(t,e){if(e&&("object"==Jt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Wt()?Reflect.construct(e,r||[],$t(t).constructor):e.apply(t,r))}function Wt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Wt=function(){return!!t})()}function $t(t){return $t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$t(t)}function Yt(t,e){return Yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yt(t,e)}var Kt=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Vt(this,e,[t])).accession=r.accession.bind(r),r.sequenceID=r.sequenceID.bind(r),r.hitLength=r.hitLength.bind(r),r.numHSPs=r.numHSPs.bind(r),r.domID=r.domID.bind(r),r.databaseIDs=r.databaseIDs.bind(r),r.showSequenceViewer=r.showSequenceViewer.bind(r),r.viewSequenceLink=r.viewSequenceLink.bind(r),r.downloadFASTA=r.downloadFASTA.bind(r),r.downloadAlignment=r.downloadAlignment.bind(r),r.headerJSX=r.headerJSX.bind(r),r.contentJSX=r.contentJSX.bind(r),r.hitLinks=r.hitLinks.bind(r),r.viewSequenceButton=r.viewSequenceButton.bind(r),r.downloadFASTAButton=r.downloadFASTAButton.bind(r),r.hit_buttons=new Ut(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yt(t,e)}(e,t),r=e,(n=[{key:"shouldComponentUpdate",value:function(){return!this.props.hit}},{key:"accession",value:function(){return this.props.hit.accession}},{key:"sequenceID",value:function(){return this.props.hit.id}},{key:"hitLength",value:function(){return this.props.hit.length}},{key:"numHSPs",value:function(){return this.props.hit.hsps.length}},{key:"domID",value:function(){return"Query_"+this.props.query.number+"_hit_"+this.props.hit.number}},{key:"databaseIDs",value:function(){return c.Ay.map(this.props.querydb,c.Ay.iteratee("id"))}},{key:"showSequenceViewer",value:function(){this.props.showSequenceModal(this.viewSequenceLink())}},{key:"viewSequenceLink",value:function(){var t=encodeURIComponent(this.sequenceID()),e=encodeURIComponent(this.databaseIDs());return"get_sequence/?sequence_ids=".concat(t,"&database_ids=").concat(e)}},{key:"downloadFASTA",value:function(t){Ht([this.sequenceID()],this.databaseIDs())}},{key:"downloadAlignment",value:function(t){var e=c.Ay.map(this.props.hit.hsps,c.Ay.bind((function(t){return t.query_id=this.props.query.id,t.hit_id=this.props.hit.id,t}),this));(new Mt).export_alignments(e,this.props.query.id+"_"+this.props.hit.id)}},{key:"headerJSX",value:function(){var t="Length: ".concat(this.hitLength().toLocaleString());return this.props.showQueryCrumbs&&this.props.showHitCrumbs?t="hit ".concat(this.props.hit.number," of query ").concat(this.props.query.number,". ").concat(t):this.props.showQueryCrumbs&&!this.props.showHitCrumbs?t="the only hit of query ".concat(this.props.query.number,". ").concat(t):!this.props.showQueryCrumbs&&this.props.showHitCrumbs&&(t="hit ".concat(this.props.hit.number,". ").concat(t)),(0,a.jsxs)("div",{className:"section-header border-b border-seqorange flex flex-col sm:flex-row sm:justify-between w-full",children:[(0,a.jsxs)("h4",{className:"text-sm cursor-pointer flex flex-col sm:flex-row items-start sm:items-start","data-parent-id":"#".concat(this.domID()),children:[(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("i",{className:"fa-regular fa-square-minus print:!hidden"}),(0,a.jsxs)("strong",{className:"cursor-text ml-1 print:ml-0",children:[" ",this.props.hit.id]})]}),(0,a.jsx)("span",{className:"ml-1",children:this.props.hit.title})]}),(0,a.jsx)("span",{className:"label first-letter:capitalize text-sm font-normal text-inherit cursor-text",children:t})]})}},{key:"contentJSX",value:function(){return(0,a.jsxs)("div",{className:"pt-0 px-0 pb-px","data-parent-hit":this.domID(),children:[this.hitLinks(),(0,a.jsx)(Rt,{query:this.props.query,hit:this.props.hit,algorithm:this.props.algorithm,showHSPCrumbs:this.numHSPs()>1&&this.numHSPs()<27,collapsed:this.props.veryBig},"kablammo"+this.props.query.id)]})}},{key:"hitLinks",value:function(){var t=this,e=[];return this.props.imported_xml||this.props.non_parse_seqids||(e=e.concat([this.viewSequenceButton(),this.downloadFASTAButton()])),e.push(this.downloadAlignmentButton()),this.hit_buttons.buttons().forEach((function(t){e.push(t)})),(0,a.jsxs)("div",{className:"hit-links h-4 print:hidden",children:[(0,a.jsxs)("label",{className:"text-sm text-seqblue hover:seqorange cursor-pointer mb-0",children:[(0,a.jsx)("input",{type:"checkbox",id:this.domID()+"_checkbox",value:this.sequenceID(),onChange:function(){this.props.selectHit(this.domID()+"_checkbox"),this.props.onChange()}.bind(this),"data-target":"#"+this.domID()})," Select"]}),e.map((function(e,r){return[(0,a.jsx)("span",{className:"text-seqorange mt-0 mr-1 ml-0 mb-1 px-1",children:"|"},"btn-".concat(r)),t.button(Object.assign(e,{key:r}))]})),this.props.hit.links.map((function(e,r){return[(0,a.jsx)("span",{className:"text-seqorange mt-0 mr-1 ml-0 mb-1 px-1",children:"|"},"link-".concat(r)),t.a(e,r)]}))]})}},{key:"viewSequenceButton",value:function(){var t=this;return this.hitLength()>1e4?{text:"Sequence",icon:"fa-eye",className:"view-sequence",title:"Sequence too long"}:{text:"Sequence",icon:"fa-eye",className:"view-sequence",onClick:function(){return t.showSequenceViewer()}}}},{key:"downloadFASTAButton",value:function(){var t=this;return{text:"FASTA",icon:"fa-download",className:"download-fa",onClick:function(){return t.downloadFASTA()}}}},{key:"downloadAlignmentButton",value:function(){var t=this;return{text:"Alignment",icon:"fa-download",className:"download-aln",onClick:function(){return t.downloadAlignment()}}}},{key:"button",value:function(t){var e=t.text,r=t.icon,n=t.title,i=t.className,o=t.onClick,s=t.key;return o?(0,a.jsxs)("button",{className:"btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer ".concat(i),title:n,onClick:o,children:[(0,a.jsx)("i",{className:"fa ".concat(r)})," ",e]},s):(0,a.jsxs)("button",{className:"text-sm view-sequence disabled",title:n,disabled:!0,children:[(0,a.jsx)("i",{className:"fa ".concat(r)})," ",e]},s)}},{key:"a",value:function(t,e){if(t.title&&t.url){var r="btn-link text-sm text-seqblue hover:text-seqorange cursor-pointer";return t.class&&(r="".concat(r," ").concat(t.class)),(0,a.jsxs)("a",{href:t.url,className:r,target:"_blank",children:[t.icon&&(0,a.jsx)("i",{className:"fa "+t.icon})," "+t.title+" "]},"".concat(t.url,"-").concat(e))}}},{key:"render",value:function(){return(0,a.jsxs)("div",{className:"hit mt-1 border-l-2 border-transparent pl-1 -ml-1",id:this.domID(),"data-hit-def":this.props.hit.id,"data-hit-len":this.props.hit.length,"data-hit-evalue":this.props.hit.evalue,children:[this.headerJSX()," ",this.contentJSX()]})}}])&&Xt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(n.Component),Zt=r(4692);function te(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ee(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ee(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function re(t){var e=t.hsp,r=(0,n.createRef)(),i=(0,k.A)(),o=te((0,n.useState)(0),2),s=o[0],l=o[1],u=te((0,n.useState)(window.innerWidth),2),h=u[0],d=u[1];(0,n.useEffect)((function(){var t=c.Ay.debounce((function(){return d(window.innerWidth)}),125);window.addEventListener("resize",t),p()}),[]),(0,n.useEffect)((function(){p(i)}),[i,h]);var p=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t.getCharacterWidth(),i=e?900:Zt(r.current).width();l(Math.floor((i-4)/n))},f=function(){switch(t.algorithm){case"blastp":case"blastn":case"tblastn":return 1;case"blastx":case"tblastx":return 3}},m=function(){switch(t.algorithm){case"blastp":case"blastx":case"blastn":return 1;case"tblastn":case"tblastx":return 3}},y=function(){return e.qframe>=0?1:-1},b=function(){return e.sframe>=0?1:-1},v=function(t,e){if(e){var r=e-t.toString().length;return Array(r+1).join(" ").concat([t])}};return(0,a.jsxs)("div",{className:"hsp pt-px pb-5 border-l-2 border-transparent pl-1 -ml-1",id:function(){var e=t.query,r=t.hit,n=t.hsp;return"Query_".concat(e.number,"_hit_").concat(r.number,"_").concat(n.number)}(),ref:r,"data-parent-hit":"Query_"+t.query.number+"_hit_"+t.hit.number,children:[(0,a.jsxs)("p",{className:"m-0 p-0 rounded-none border-0 bg-inherit whitespace-pre-wrap break-keep text-sm text-neutral-500 font-semibold tracking-wide",children:[t.showHSPNumbers&&"".concat(W(e.number),". "),function(){var r=[];switch(r.push("Score: ".concat(tt.inTwoDecimal(e.bit_score)," (").concat(e.score,"), ")),r.push("E value: "),r.push(tt.inExponential(e.evalue)),r.push(", "),r.push(["Identity: ".concat(tt.inFraction(e.identity,e.length)," (").concat(tt.inPercentage(e.identity,e.length),"), ")]),"blastp"!==t.algorithm&&"blastx"!==t.algorithm&&"tblastn"!==t.algorithm&&"tblastx"!==t.algorithm||r.push("Positives: ".concat(tt.inFraction(e.positives,e.length)," (").concat(tt.inPercentage(e.positives,e.length),"), ")),r.push("Gaps: ".concat(tt.inFraction(e.gaps,e.length)," (").concat(tt.inPercentage(e.gaps,e.length),")")),t.algorithm){case"tblastx":r.push(", Frame: ".concat(tt.inFraction(e.qframe,e.sframe)));break;case"blastn":r.push(", Strand: ".concat(e.qframe>0?"+":"-"," / ").concat(e.sframe>0?"+":"-"));break;case"blastx":r.push(", Query Frame: ".concat(e.qframe));break;case"tblastn":r.push(", Hit Frame: ".concat(e.sframe))}return r}().map((function(t,e){return(0,a.jsx)("span",{children:t},e)}))]}),function(){for(var r=c.Ay.max(c.Ay.map([e.qstart,e.qend,e.sstart,e.send],(function(t){return t.toString().length}))),n=s-2*r-10,i=Math.ceil(e.length/n),o=[],l=function(){switch(t.algorithm){case"blastp":case"blastx":case"tblastn":case"tblastx":return e.qframe>=0?e.qstart:e.qend;case"blastn":return e.qstart}}(),u=function(){switch(t.algorithm){case"blastp":case"blastx":case"tblastn":case"tblastx":return e.sframe>=0?e.sstart:e.send;case"blastn":return e.sstart}}(),h=1;h<=i;h++){var d=n*(h-1),p=d+n,g=l,x=e.qseq.slice(d,p),_=l+(x.length-x.split("-").length)*f()*y();l=_+f()*y();var w=e.midline.slice(d,p),j=u,S=e.sseq.slice(d,p),k=u+(S.length-S.split("-").length)*m()*b();u=k+m()*b(),o.push((0,a.jsxs)("pre",{className:"pre-item m-0 p-0 rounded-none border-0 bg-inherit whitespace-pre-wrap break-keep mt-1 tracking-wider",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Query   ".concat(v(g,r)," ")}),(0,a.jsx)("span",{children:x}),(0,a.jsx)("span",{className:"text-gray-500",children:" ".concat(_)}),(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"text-gray-500",children:"".concat(v("",r+8)," ")}),(0,a.jsx)("span",{children:w}),(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"text-gray-500",children:"Subject ".concat(v(j,r)," ")}),(0,a.jsx)("span",{children:S}),(0,a.jsx)("span",{className:"text-gray-500",children:" ".concat(k)}),(0,a.jsx)("br",{})]},e.number+","+h))}return o}()]})}var ne=r(4692);function ie(t){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie(t)}function ae(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function oe(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ae(Object(r),!0).forEach((function(e){se(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function se(t,e,r){return(e=ce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function le(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ce(n.key),n)}}function ce(t){var e=function(t){if("object"!=ie(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ie(e)?e:e+""}function ue(t,e,r){return e=de(e),function(t,e){if(e&&("object"==ie(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,he()?Reflect.construct(e,r||[],de(t).constructor):e.apply(t,r))}function he(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(he=function(){return!!t})()}function de(t){return de=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},de(t)}function pe(t,e){return pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pe(t,e)}const fe=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=ue(this,e,[t])).numUpdates=0,r.nextQuery=0,r.nextHit=0,r.nextHSP=0,r.maxHSPs=10,r.state=t.state,r.state.pluginResults=[],r.prepareAlignmentOfSelectedHits=r.prepareAlignmentOfSelectedHits.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pe(t,e)}(e,t),r=e,(n=[{key:"componentDidMount",value:function(){this.props.plugins.init(this.onPluginResultsFetched.bind(this)),this.componentDidUpdate(this.props,this.state)}},{key:"onPluginResultsFetched",value:function(t){this.setState({pluginResults:t})}},{key:"replacePluginResults",value:function(t){if(t){var e=this.props.plugins.replacePluginResults(this.state.results,t);this.setState({results:e,pluginResults:t})}}},{key:"componentDidUpdate",value:function(t,e){var r=this;this.nextQuery<this.state.queries.length?setTimeout((function(){return r.updateState()}),25):this.props.componentFinishedUpdating(),this.state.pluginResults.length>0&&0==e.pluginResults.length&&this.replacePluginResults(this.state.pluginResults)}},{key:"isFirstUpdate",value:function(){return 0==this.nextQuery&&0==this.nextHit&&0==this.nextHSP}},{key:"updateState",value:function(){var t={items:[],numHSPsProcessed:0};this.processQueries(t),this.numUpdates++,this.lastTimeStamp=Date.now(),this.setState({results:this.state.results.concat(t.items),veryBig:this.numUpdates>=250})}},{key:"processQueries",value:function(t){for(;this.nextQuery<this.state.queries.length;){var e=this.state.queries[this.nextQuery];if(0==this.nextHit&&0==this.nextHSP&&(t.items.push(this.renderReportQuery(e)),t.items.push(this.props.plugins.queryResult(e,this.state.pluginResults))),this.processHits(t,e),this.iterateLoops(["nextQuery","nextHit"],e.hits.length),t.numHSPsProcessed==this.maxHSPs)break}}},{key:"processHits",value:function(t,e){for(;this.nextHit<e.hits.length;){var r=e.hits[this.nextHit];if(0==this.nextHSP&&t.items.push(this.renderHit(e,r)),this.processHSPS(t,e,r),this.iterateLoops(["nextHit","nextHSP"],r.hsps.length),t.numHSPsProcessed==this.maxHSPs)break}}},{key:"processHSPS",value:function(t,e,r){for(;this.nextHSP<r.hsps.length;){var n=r.hsps[this.nextHSP++];if(t.items.push(this.renderHsp(e,r,n)),t.numHSPsProcessed++,t.numHSPsProcessed==this.maxHSPs)break}}},{key:"iterateLoops",value:function(t,e){this[t[1]]==e&&(this[t[0]]++,this[t[1]]=0)}},{key:"renderHsp",value:function(t,e,r){return(0,a.jsx)(re,oe({query:t,hit:e,hsp:r,algorithm:this.state.program,showHSPNumbers:e.hsps.length>1},this.props),"Query_"+t.number+"_Hit_"+e.number+"_HSP_"+r.number)}},{key:"renderHit",value:function(t,e){return(0,a.jsx)(Kt,oe({query:t,hit:e,algorithm:this.state.program,querydb:this.state.querydb,selectHit:this.selectHit,imported_xml:this.state.imported_xml,non_parse_seqids:this.state.non_parse_seqids,showQueryCrumbs:this.state.queries.length>1,showHitCrumbs:t.hits.length>1,veryBig:this.state.veryBig,onChange:this.prepareAlignmentOfSelectedHits},this.props),"Query_"+t.number+"_Hit_"+e.number)}},{key:"renderReportQuery",value:function(t){return(0,a.jsx)(Pt,{query:t,program:this.state.program,querydb:this.state.querydb,showQueryCrumbs:this.state.queries.length>1,non_parse_seqids:this.state.non_parse_seqids,imported_xml:this.state.imported_xml,veryBig:this.state.veryBig},"Query_"+t.id)}},{key:"selectHit",value:function(t){var e=ne("#"+t),r=ne(".hit-links :checkbox:checked").length;if(e&&e.val()){var n=ne(e.data("target"));e.is(":checked")?(n.addClass("border-seqorange"),n.next(".hsp").addClass("border-seqorange"),n.removeClass("border-transparent"),n.next(".hsp").removeClass("border-transparent"),ne(".download-fasta-of-selected").enable(),ne(".download-alignment-of-selected").enable()):(n.removeClass("border-seqorange"),n.next(".hsp").removeClass("border-seqorange"),n.addClass("border-transparent"),n.next(".hsp").addClass("border-transparent"),ne(".download-fasta-of-selected").attr("href","#").removeAttr("download"));var i=ne(".download-fasta-of-selected"),a=ne(".download-alignment-of-selected");r>=1&&(i.find(".font-bold").html(r),a.find(".font-bold").html(r),i.find(".font-bold").addClass("px-1").removeClass("px-0.5"),a.find(".font-bold").addClass("px-1").removeClass("px-0.5")),0==r&&(i.addClass("disabled").find(".font-bold").html(""),a.addClass("disabled").find(".font-bold").html(""),i.find(".font-bold").removeClass("px-1").addClass("px-0.5"),a.find(".font-bold").removeClass("px-1").addClass("px-0.5"))}}},{key:"prepareAlignmentOfSelectedHits",value:function(){var t=ne(".hit-links :checkbox:checked").map((function(){return this.value})).get();if(t.length){this.state.alignment_blob_url&&window.URL.revokeObjectURL(this.state.alignment_blob_url);var e=[],r=new Mt,n=this;c.Ay.each(this.state.queries,c.Ay.bind((function(r){c.Ay.each(r.hits,(function(i){-1!=c.Ay.indexOf(t,i.id)&&(e=e.concat(n.props.populate_hsp_array(i,r.id)))}))}),this));var i="alignment-"+t.length+"_hits.txt",a=r.prepare_alignments_for_export(e,i);ne(".download-alignment-of-selected").attr("href",a).attr("download",i),this.setState({alignment_blob_url:a})}else ne(".download-alignment-of-selected").attr("href","#").removeAttr("download")}},{key:"render",value:function(){return this.state.results}}])&&le(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(n.Component);function me(t){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},me(t)}function ye(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function be(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ye(Object(r),!0).forEach((function(e){ve(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ve(t,e,r){return(e=function(t){var e=function(t){if("object"!=me(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=me(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==me(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const ge=function(t){return(0,a.jsx)(U,{name:"Alignment Results",renderContent:function(){return(0,a.jsxs)("div",{children:[t.state.results,(0,a.jsx)(fe,be(be({},t),{},{componentFinishedUpdating:function(e){return t.componentFinishedUpdating(e)}}))]})}})};function xe(t,e,r,n,i){var a=function(t){return t?t.slice(0,15).map((function(t){return" "+t.title})):""}(t),o=function(t,e,r,n,i){var a=e.toUpperCase(),o=i?"":"The link will work if you have access to that particular SequenceServer instance.";return"mailto:?subject=SequenceServer ".concat(a," analysis results &body=Hello,\n\n        Here is a link to my recent ").concat(a," analysis of ").concat(r," sequences.\n            ").concat(n,"\n\n        The following databases were used (up to 15 are shown):\n            ").concat(t,"\n\n        ").concat(o,"\n\n        Thank you for using SequenceServer, and please remember to cite our paper.\n\n        Best regards,\n\n        https://sequenceserver.com")}(a,e,r,n,i);return function(t){return encodeURI(t).replace(/(%20){2,}/g,"")}(o)}function _e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}const we=function(t){var e,r,i=t.querydb,o=t.program,s=t.queryLength,l=t.url,c=(e=(0,n.useState)(!1),r=2,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,c=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}(e,r)||function(t,e){if(t){if("string"==typeof t)return _e(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_e(t,e):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],h=c[1];return(0,a.jsxs)("div",{className:"px-6 share-url-component",children:[(0,a.jsx)("input",{className:"w-full mb-3 pt-3",name:"shareableUrl",type:"text",value:l,readOnly:!0}),(0,a.jsxs)("div",{className:"py-4 flex justify-between items-center",children:[(0,a.jsx)("button",{className:"py-2 px-3 border border-transparent rounded-md shadow-sm text-white bg-seqblue hover:bg-seqorange focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-seqorange",onClick:function(){navigator.clipboard.writeText(l),h(!0)},children:u?"Copied!":"Copy to Clipboard"}),(0,a.jsx)("a",{href:xe(i,o,s,l,!0),children:"Share via email"})]})]})};function je(t){return je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},je(t)}function Se(){var t=Ce(),e=t.m(Se),r=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function n(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===r||"GeneratorFunction"===(e.displayName||e.name))}var i={throw:1,return:2,break:3,continue:3};function a(t){var e,r;return function(n){e||(e={stop:function(){return r(n.a,2)},catch:function(){return n.v},abrupt:function(t,e){return r(n.a,i[t],e)},delegateYield:function(t,i,a){return e.resultName=i,r(n.d,ke(t),a)},finish:function(t){return r(n.f,t)}},r=function(t,r,i){n.p=e.prev,n.n=e.next;try{return t(r,i)}finally{e.next=n.n}}),e.resultName&&(e[e.resultName]=n.v,e.resultName=void 0),e.sent=n.v,e.next=n.n;try{return t.call(this,e)}finally{n.p=e.prev,n.n=e.next}}}return(Se=function(){return{wrap:function(e,r,n,i){return t.w(a(e),r,n,i&&i.reverse())},isGeneratorFunction:n,mark:t.m,awrap:function(t,e){return new Ee(t,e)},AsyncIterator:Ne,async:function(t,e,r,i,o){return(n(e)?Pe:Oe)(a(t),e,r,i,o)},keys:qe,values:ke}})()}function ke(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(je(t)+" is not iterable")}function qe(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}}function Oe(t,e,r,n,i){var a=Pe(t,e,r,n,i);return a.next().then((function(t){return t.done?t.value:a.next()}))}function Pe(t,e,r,n,i){return new Ne(Ce().w(t,e,r,n),i||Promise)}function Ne(t,e){function r(n,i,a,o){try{var s=t[n](i),l=s.value;return l instanceof Ee?e.resolve(l.v).then((function(t){r("next",t,a,o)}),(function(t){r("throw",t,a,o)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,o)}))}catch(t){o(t)}}var n;this.next||(Ae(Ne.prototype),Ae(Ne.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Ae(this,"_invoke",(function(t,i,a){function o(){return new e((function(e,n){r(t,a,e,n)}))}return n=n?n.then(o,o):o()}),!0)}function Ce(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function a(r,n,i,a){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return Ae(c,"_invoke",function(r,n,i){var a,s,l,c=0,u=i||[],h=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,r){return a=e,s=0,l=t,d.n=r,o}};function p(r,n){for(s=r,l=n,e=0;!h&&c&&!i&&e<u.length;e++){var i,a=u[e],p=d.p,f=a[2];r>3?(i=f===n)&&(l=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=p&&((i=r<2&&p<a[1])?(s=0,d.v=n,d.n=a[1]):p<f&&(i=r<3||a[0]>n||n>f)&&(a[4]=r,a[5]=n,d.n=f,s=0))}if(i||r>1)return o;throw h=!0,n}return function(i,u,f){if(c>1)throw TypeError("Generator is already running");for(h&&1===u&&p(u,f),s=u,l=f;(e=s<2?t:l)||!h;){a||(s?s<3?(s>1&&(d.n=-1),p(s,l)):d.n=l:d.v=l);try{if(c=2,a){if(s||(i="next"),e=a[i]){if(!(e=e.call(a,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),s=1);a=t}else if((e=(h=d.n<0)?l:r.call(n,d))!==o)break}catch(e){a=t,s=1,l=e}finally{c=1}}return{value:e,done:h}}}(r,i,a),!0),c}var o={};function s(){}function l(){}function c(){}e=Object.getPrototypeOf;var u=[][n]?e(e([][n]())):(Ae(e={},n,(function(){return this})),e),h=c.prototype=s.prototype=Object.create(u);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,Ae(t,i,"GeneratorFunction")),t.prototype=Object.create(h),t}return l.prototype=c,Ae(h,"constructor",c),Ae(c,"constructor",l),l.displayName="GeneratorFunction",Ae(c,i,"GeneratorFunction"),Ae(h),Ae(h,i,"Generator"),Ae(h,n,(function(){return this})),Ae(h,"toString",(function(){return"[object Generator]"})),(Ce=function(){return{w:a,m:d}})()}function Ae(t,e,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}Ae=function(t,e,r,n){if(e)i?i(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{var a=function(e,r){Ae(t,e,(function(t){return this._invoke(e,r,t)}))};a("next",0),a("throw",1),a("return",2)}},Ae(t,e,r,n)}function Ee(t,e){this.v=t,this.k=e}function Ie(t,e,r,n,i,a,o){try{var s=t[a](o),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,i)}function Re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Me(n.key),n)}}function Te(t,e,r){return e=Le(e),function(t,e){if(e&&("object"==je(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,He()?Reflect.construct(e,r||[],Le(t).constructor):e.apply(t,r))}function He(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(He=function(){return!!t})()}function Le(t){return Le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Le(t)}function De(t,e){return De=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},De(t,e)}function Fe(t,e,r){return(e=Me(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Me(t){var e=function(t){if("object"!=je(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=je(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==je(e)?e:e+""}var Qe=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Fe(r=Te(this,e,[t]),"handleChange",(function(t){var e=t.target,n=e.name,i=e.value,a=e.type,o=e.checked,s="checkbox"===a?o:i;r.setState(Fe({},n,s))})),Fe(r,"handleSubmit",function(){var t,e=(t=Se().mark((function t(e){var n,i,a,o,s;return Se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),n=r.state.email,i=r.getJobIdFromPath(),r.setState({formState:"loading"}),a={job_id:i,sender_email:n},t.prev=5,t.next=8,fetch("/cloud_share",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 8:if((o=t.sent).ok){t.next=11;break}throw new Error("Network response was not ok");case 11:return t.next=13,o.json();case 13:if(!(s=t.sent).shareable_url){t.next=18;break}r.setState({formState:"results",shareableurl:s.shareable_url}),t.next=23;break;case 18:if(!s.errors){t.next=22;break}r.setState({formState:"error",errorMessages:s.errors}),t.next=23;break;case 22:throw new Error("Unknown error submitting form");case 23:t.next=28;break;case 25:t.prev=25,t.t0=t.catch(5),r.setState({formState:"error",errorMessages:[t.t0.message]});case 28:case"end":return t.stop()}}),t,null,[[5,25]])})),function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function o(t){Ie(a,n,i,o,s,"next",t)}function s(t){Ie(a,n,i,o,s,"throw",t)}o(void 0)}))});return function(t){return e.apply(this,arguments)}}()),Fe(r,"getJobIdFromPath",(function(){var t=window.location.pathname.match(/\/([^/]+)(?:\/|#|\?|$)/);return t?t[1]:t})),Fe(r,"show",(function(){var t;null===(t=r.modalRef.current)||void 0===t||t.showModal()})),Fe(r,"hide",(function(){var t;null===(t=r.modalRef.current)||void 0===t||t.close()})),r.state={formState:"input",errorMessages:[],email:"",agreeToTos:!1,shareableurl:"",isModalVisible:!1},r.modalRef=(0,n.createRef)(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&De(t,e)}(e,t),r=e,(i=[{key:"renderLoading",value:function(){return(0,a.jsxs)("div",{className:"text-center pt-3",children:[(0,a.jsx)("i",{className:"fa fa-spinner fa-3x fa-spin"}),(0,a.jsx)("p",{className:"my-3",children:"Uploading the job to SequenceServer Cloud, please wait..."})]})}},{key:"renderResults",value:function(){var t=this.state.shareableurl;return(0,a.jsx)(we,{url:t,querydb:this.props.querydb,program:this.props.program,queryLength:this.props.queryLength})}},{key:"renderError",value:function(){var t=this.state.errorMessages;return(0,a.jsxs)(a.Fragment,{children:[t.map((function(t,e){return(0,a.jsx)("div",{className:"fastan",children:(0,a.jsx)("div",{className:"pt-0 px-0 pb-px",children:(0,a.jsx)("div",{className:"text-danger text-lg border border-danger p-2 my-2",children:t})})},"fastan-".concat(e))})),this.renderForm()]})}},{key:"renderForm",value:function(){var t=this.state,e=t.email,r=t.agreeToTos,n=!r;return(0,a.jsxs)("form",{onSubmit:this.handleSubmit,children:[(0,a.jsxs)("div",{className:"px-6 py-4 text-sm",children:[(0,a.jsx)("label",{htmlFor:"emailInput",className:"text-seqblue hover:text-orange cursor-pointer mb-0",children:"Your Email Address"}),(0,a.jsx)("input",{type:"email",id:"emailInput",className:"block w-full rounded-md border-0 py-1.5 px-3 mb-3 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-seqblue sm:text-sm sm:leading-6",placeholder:"person@example.com",name:"email",value:e,required:"required",onChange:this.handleChange}),(0,a.jsxs)("p",{className:"mb-3",children:["By submitting this form you agree to upload this SequenceServer result set to ",(0,a.jsx)("a",{href:"https://sequenceserver.com/cloud/",target:"_bank",className:"text-seqblue hover:text-seqorange",children:"SenquenceServer Cloud"}),", where it will become available on the internet to everyone with the link. You also agree that your email address will be stored on SequenceServer databases as proof of authentication for support and similar purposes."]}),(0,a.jsxs)("div",{className:"form-check",children:[(0,a.jsx)("input",{type:"checkbox",id:"tosCheckbox",className:"form-check-input",name:"agreeToTos",checked:r,onChange:this.handleChange}),(0,a.jsxs)("label",{htmlFor:"tosCheckbox",className:"pl-2",children:[" I agree to the ",(0,a.jsx)("b",{children:(0,a.jsx)("a",{href:"https://sequenceserver.com/cloud/terms_and_conditions",target:"_blank",className:"text-seqblue hover:text-seqorange",children:"Terms and Conditions of Service"})})]})]})]}),(0,a.jsx)("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:(0,a.jsx)("button",{type:"submit",style:{backgroundColor:n?"#C74F13":"#1B557A"},className:"border-seqblue py-2 px-3 rounded-md text-white",disabled:n,children:"Submit"})})]})}},{key:"render",value:function(){var t,e=this.state,r=e.formState;switch(e.isModalVisible,r){case"loading":t=this.renderLoading();break;case"results":t=this.renderResults();break;case"error":t=this.renderError();break;default:t=this.renderForm()}return(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("dialog",{ref:this.modalRef,className:"fixed p-4 w-full max-w-2xl bg-transparent focus:outline-none",children:(0,a.jsxs)("div",{className:"relative flex flex-col rounded-lg bg-white shadow",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between rounded-t border-b p-5",children:[(0,a.jsx)("h3",{className:"text-xl font-medium text-gray-900",children:"Share to SequenceServer Cloud"}),(0,a.jsx)("button",{className:"ml-auto inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200",onClick:this.hide,children:(0,a.jsx)("i",{className:"fa-solid fa-xmark hover:text-black"})})]}),(0,a.jsx)("div",{className:"dialog-content",children:t})]})})})}}])&&Re(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}(i().Component);function ze(t){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ze(t)}function Be(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ue(n.key),n)}}function Ue(t){var e=function(t){if("object"!=ze(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ze(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ze(e)?e:e+""}function Je(t,e,r){return e=Ge(e),function(t,e){if(e&&("object"==ze(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Xe()?Reflect.construct(e,r||[],Ge(t).constructor):e.apply(t,r))}function Xe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Xe=function(){return!!t})()}function Ge(t){return Ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ge(t)}function Ve(t,e){return Ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ve(t,e)}const We=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Je(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ve(t,e)}(e,t),r=e,(n=[{key:"render",value:function(){}}])&&Be(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(i().Component);var $e=r(4692);function Ye(t){return Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ye(t)}function Ke(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ze(n.key),n)}}function Ze(t){var e=function(t){if("object"!=Ye(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ye(e)?e:e+""}function tr(t,e,r){return e=rr(e),function(t,e){if(e&&("object"==Ye(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,er()?Reflect.construct(e,r||[],rr(t).constructor):e.apply(t,r))}function er(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(er=function(){return!!t})()}function rr(t){return rr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rr(t)}function nr(t,e){return nr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},nr(t,e)}var ir=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=tr(this,e,[t])).downloadFastaOfAll=r.downloadFastaOfAll.bind(r),r.downloadFastaOfSelected=r.downloadFastaOfSelected.bind(r),r.topPanelJSX=r.topPanelJSX.bind(r),r.summaryString=r.summaryString.bind(r),r.indexJSX=r.indexJSX.bind(r),r.downloadsPanelJSX=r.downloadsPanelJSX.bind(r),r.handleQueryIndexChange=r.handleQueryIndexChange.bind(r),r.isElementInViewPort=r.isElementInViewPort.bind(r),r.setVisibleQueryIndex=r.setVisibleQueryIndex.bind(r),r.debounceScrolling=r.debounceScrolling.bind(r),r.scrollListener=r.scrollListener.bind(r),r.copyURL=r.copyURL.bind(r),r.shareCloudInit=r.shareCloudInit.bind(r),r.sharingPanelJSX=r.sharingPanelJSX.bind(r),r.cloudShareModal=i().createRef(),r.timeout=null,r.queryElems=[],r.state={queryIndex:1},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nr(t,e)}(e,t),r=e,n=[{key:"componentDidMount",value:function(){var t=window.location.href.match(/#Query_(\d+)/);if(t&&t.length>1){var e=+t[1],r=this.props.data.queries.findIndex((function(t){return t.number===e}));this.setState({queryIndex:r+1})}window.addEventListener("scroll",this.scrollListener),$e('a[href^="#Query_"]').on("click",this.animateAnchorElements)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.scrollListener)}},{key:"componentDidUpdate",value:function(t){this.props.allQueriesLoaded&&!t.allQueriesLoaded&&(this.queryElems=Array.from(document.querySelectorAll(".resultn")))}},{key:"scrollListener",value:function(){this.debounceScrolling(this.setVisibleQueryIndex,500)}},{key:"debounceScrolling",value:function(t,e){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(t,e)}},{key:"setVisibleQueryIndex",value:function(){var t=this.queryElems.length?this.queryElems:Array.from(document.querySelectorAll(".resultn")),e=Array.from(document.querySelectorAll(".hit[id^=Query_]")),r=t.find(this.isElementInViewPort)||e.find(this.isElementInViewPort);if(r){var n=Number(r.id.match(/Query_(\d+)/)[1]),i="#Query_".concat(n);window.history.pushState&&window.history.pushState(null,null,i),this.setState({queryIndex:n})}}},{key:"animateAnchorElements",value:function(t){void 0==={}.JEST_WORKER_ID&&(t.preventDefault(),$e("html, body").animate({scrollTop:$e(this.hash).offset().top},300),window.history.pushState?window.history.pushState(null,null,this.hash):window.location.hash=this.hash)}},{key:"isElementInViewPort",value:function(t){var e=t.getBoundingClientRect(),r=e.top,n=e.left,i=e.right,a=e.bottom;return r>=0&&n>=0&&a<=(window.innerHeight||document.documentElement.clientHeight)&&i<=(window.innerWidth||document.documentElement.clientWidth)}},{key:"clearSession",value:function(){sessionStorage.clear()}},{key:"handleQueryIndexChange",value:function(t){if(!(t<1||t>this.props.data.queries.length)){var e=document.createElement("a");e.setAttribute("href","#Query_"+this.props.data.queries[t-1].number),e.setAttribute("hidden",!0),document.body.appendChild(e),$e(e).on("click",this.animateAnchorElements),e.click(),document.body.removeChild(e),this.setState({queryIndex:t})}}},{key:"downloadFastaOfAll",value:function(){var t=[];this.props.data.queries.forEach((function(e){return e.hits.forEach((function(e){return t.push(e.id)}))}));var e=this.props.data.querydb.map((function(t){return t.id}));return Ht(t,e),!1}},{key:"downloadFastaOfSelected",value:function(){var t=$e(".hit-links :checkbox:checked").map((function(){return this.value})).get();return 0===t.length||Ht(t,c.Ay.map(this.props.data.querydb,c.Ay.iteratee("id"))),!1}},{key:"copyURL",value:function(){var t=document.createElement("input"),e=window.location.href;document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t);var r=document.getElementById("tooltip");r.classList.remove("hidden"),setTimeout((function(){r.classList.add("hidden")}),3e3)}},{key:"shareCloudInit",value:function(){this.cloudShareModal.current.show()}},{key:"topPanelJSX",value:function(){var t=location.pathname.split("/"),e=t.pop(),r=t.join("/");return(0,a.jsxs)("div",{className:"sidebar-top-panel",children:[(0,a.jsx)("div",{className:"pl-px table mb-0 w-full",children:(0,a.jsx)("h4",{className:"text-sm font-bold mb-0 mt-0.5",children:this.summaryString()})}),this.props.data.queries.length>12&&this.queryIndexButtons(),(0,a.jsxs)("div",{children:[(0,a.jsxs)("a",{href:"".concat(r,"/?job_id=").concat(e),className:"text-sm text-seqblue hover:text-seqorange cursor-pointer",children:[(0,a.jsx)("i",{className:"fa fa-pencil"})," Edit search"]}),(0,a.jsx)("span",{className:"text-seqorange px-1",children:"|"}),(0,a.jsxs)("a",{href:"".concat(r,"/"),onClick:this.clearSession,className:"text-sm text-seqblue hover:text-seqorange cursor-pointer",children:[(0,a.jsx)("i",{className:"fa-regular fa-file"})," New search"]})]}),this.props.shouldShowIndex&&this.indexJSX()]})}},{key:"summaryString",value:function(){var t=this.props.data.program,e=this.props.data.queries.length,r=this.props.data.querydb.length;return t.toUpperCase()+": "+e+" "+(e>1?"queries":"query")+", "+r+" "+(r>1?"databases":"database")}},{key:"queryIndexButtons",value:function(){var t=this,e={outline:"none",border:"none",background:"none"},r=function(t){var r=t.text,n=t.onClick;return(0,a.jsx)("button",{className:"text-sm text-seqblue hover:text-seqorange hover:bg-gray-200",onClick:n,style:e,children:r})};return(0,a.jsxs)("div",{style:{display:"flex",width:"100%",margin:"7px 0"},children:[this.state.queryIndex>1&&(0,a.jsx)(r,{text:"Previous Query",onClick:function(){return t.handleQueryIndexChange(t.state.queryIndex-1)}}),this.state.queryIndex>1&&this.state.queryIndex<this.props.data.queries.length&&(0,a.jsx)("span",{className:"text-seqorange px-1",children:"|"}),this.state.queryIndex<this.props.data.queries.length&&(0,a.jsx)(r,{onClick:function(){return t.handleQueryIndexChange(t.state.queryIndex+1)},text:"Next Query"})]})}},{key:"indexJSX",value:function(){return(0,a.jsxs)("ul",{className:"w-full",children:[" ",c.Ay.map(this.props.data.queries,(function(t){return(0,a.jsx)("li",{children:(0,a.jsx)("a",{className:"side-nav text-sm text-seqblue hover:text-seqorange focus:text-seqorange active:text-seqorange cursor-pointer hover-bold line-clamp-1 mb-1.5",title:"Query= "+t.id+" "+t.title,href:"#Query_"+t.number,children:"Query= "+t.id})},"Side_bar_"+t.id)}))]})}},{key:"downloadsPanelJSX",value:function(){return(0,a.jsxs)("div",{className:"downloads",children:[(0,a.jsx)("div",{className:"pl-px table mb-0 w-full",children:(0,a.jsx)("h4",{className:"text-sm font-bold mb-0 mt-2.5",children:"Download FASTA, XML, TSV"})}),(0,a.jsxs)("ul",{children:[!(this.props.data.imported_xml||this.props.data.non_parse_seqids)&&(0,a.jsx)("li",{className:"hover:bg-gray-200 mb-1",children:(0,a.jsx)("a",{href:"#",className:"text-sm text-seqblue download-fasta-of-all hover:text-seqorange cursor-pointer py-0.5 px-0.5 ".concat(!this.props.atLeastOneHit&&"disabled"),onClick:this.props.atLeastOneHit?this.downloadFastaOfAll:function(t){return t.preventDefault()},children:"FASTA of all hits"})}),!(this.props.data.imported_xml||this.props.data.non_parse_seqids)&&(0,a.jsx)("li",{className:"mb-1",children:(0,a.jsxs)("a",{href:"#",className:"flex text-sm download-fasta-of-selected text-seqblue disabled py-0.5 px-0.5",onClick:this.downloadFastaOfSelected,children:["FASTA of ",(0,a.jsx)("span",{className:"font-bold px-0.5"})," selected hit(s)"]})}),(0,a.jsx)("li",{className:"hover:bg-gray-200 mb-1",children:(0,a.jsx)("a",{href:"#",className:"text-sm text-seqblue download-alignment-of-all hover:text-seqorange cursor-pointer py-0.5 px-0.5 ".concat(!this.props.atLeastOneHit&&"disabled"),children:"Alignment of all hits"})}),(0,a.jsx)("li",{className:"mb-1",children:(0,a.jsxs)("a",{href:"#",className:"flex text-sm download-alignment-of-selected text-seqblue disabled py-0.5 px-0.5",children:["Alignment of ",(0,a.jsx)("span",{className:"font-bold px-0.5"})," selected hit(s)"]})}),!this.props.data.imported_xml&&(0,a.jsx)("li",{className:"hover:bg-gray-200 mb-1",children:(0,a.jsx)("a",{href:"download/"+this.props.data.search_id+".std_tsv",children:(0,a.jsx)("div",{className:"relative flex flex-col items-center group",children:(0,a.jsxs)("div",{className:"flex items-center w-full",children:[(0,a.jsx)("span",{className:"w-full text-sm text-seqblue hover:text-seqorange download cursor-pointer py-0.5 px-0.5",children:"Standard tabular report"}),(0,a.jsxs)("div",{className:"absolute hidden left-full ml-2 items-center group-hover:flex tooltip-wrap",children:[(0,a.jsx)("div",{className:"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px"}),(0,a.jsx)("span",{className:"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md",children:"15 columns: query and subject ID; scientific name, alignment length, mismatches, gaps, identity, start and end coordinates, e value, bitscore, query coverage per subject and per HSP."})]})]})})})}),!this.props.data.imported_xml&&(0,a.jsx)("li",{className:"hover:bg-gray-200 mb-1",children:(0,a.jsx)("a",{href:"download/"+this.props.data.search_id+".full_tsv",children:(0,a.jsx)("div",{className:"relative flex flex-col items-center group",children:(0,a.jsxs)("div",{className:"flex items-center w-full",children:[(0,a.jsx)("span",{className:"w-full text-sm text-seqblue hover:text-seqorange download cursor-pointer py-0.5 px-0.5",children:"Full tabular report"}),(0,a.jsxs)("div",{className:"absolute hidden left-full ml-2 items-center group-hover:flex tooltip-wrap",children:[(0,a.jsx)("div",{className:"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px"}),(0,a.jsx)("span",{className:"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md",children:"44 columns: query and subject ID, GI, accessions, and length; alignment details; taxonomy details of subject sequence(s) and query coverage per subject and per HSP."})]})]})})})}),!this.props.data.imported_xml&&(0,a.jsx)("li",{className:"hover:bg-gray-200 mb-1",children:(0,a.jsx)("a",{href:"download/"+this.props.data.search_id+".xml",children:(0,a.jsx)("div",{className:"relative flex flex-col items-center group",children:(0,a.jsxs)("div",{className:"flex items-center w-full",children:[(0,a.jsx)("span",{className:"w-full text-sm text-seqblue hover:text-seqorange download cursor-pointer py-0.5 px-0.5",children:"Full XML report"}),(0,a.jsxs)("div",{className:"absolute hidden left-full ml-2 items-center group-hover:flex tooltip-wrap",children:[(0,a.jsx)("div",{className:"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px"}),(0,a.jsx)("span",{className:"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md",children:"Results in XML format."})]})]})})})}),!this.props.data.imported_xml&&(0,a.jsx)("li",{className:"hover:bg-gray-200 mb-1",children:(0,a.jsx)("a",{href:"download/"+this.props.data.search_id+".pairwise",children:(0,a.jsx)("div",{className:"relative flex flex-col items-center group",children:(0,a.jsxs)("div",{className:"flex items-center w-full",children:[(0,a.jsx)("span",{className:"w-full text-sm text-seqblue hover:text-seqorange download cursor-pointer py-0.5 px-0.5",children:"Full Text report"}),(0,a.jsxs)("div",{className:"absolute hidden left-full ml-2 items-center group-hover:flex tooltip-wrap",children:[(0,a.jsx)("div",{className:"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px"}),(0,a.jsx)("span",{className:"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md",children:"Results in text format."})]})]})})})}),(0,a.jsx)(We,{imported_xml:this.props.data.imported_xml,search_id:this.props.data.search_id})]})]})}},{key:"sharingPanelJSX",value:function(){return(0,a.jsxs)("div",{className:"sharing-panel",children:[(0,a.jsx)("div",{className:"pl-px table mb-0 w-full",children:(0,a.jsx)("h4",{className:"text-sm font-bold mb-0 mt-2.5",children:"Share results"})}),(0,a.jsxs)("ul",{children:[!this.props.cloudSharingEnabled&&(0,a.jsx)("li",{className:"hover:text-seqorange hover:bg-gray-200",children:(0,a.jsx)("a",{id:"copyURL",className:"flex text-sm text-seqblue hover:text-seqorange copy-URL cursor-pointer py-0.5 px-0.5 w-full",onClick:this.copyURL,children:(0,a.jsxs)("div",{className:"relative flex gap-2 items-center group w-full",children:[(0,a.jsx)("i",{className:"fa fa-copy"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"w-full",children:"Copy URL to clipboard"}),(0,a.jsx)("div",{id:"tooltip",className:"absolute hidden left-full ml-2 items-center",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px"}),(0,a.jsx)("span",{className:"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md",children:"Copied!"})]})})]})]})})}),!this.props.cloudSharingEnabled&&(0,a.jsx)("li",{className:"hover:text-seqorange hover:bg-gray-200",children:(0,a.jsx)("a",{id:"sendEmail",className:"flex text-sm text-seqblue hover:text-seqorange email-URL cursor-pointer py-0.5 px-0.5 w-full",href:xe(this.props.data.querydb,this.props.data.program,this.props.data.queries.length,window.location.href),target:"_blank",rel:"noopener noreferrer",children:(0,a.jsxs)("div",{className:"relative flex gap-2 items-center group w-full",children:[(0,a.jsx)("i",{className:"fa fa-envelope"}),(0,a.jsxs)("div",{className:"flex items-center w-full",children:[(0,a.jsx)("span",{className:"w-full",children:"Send by email"}),(0,a.jsxs)("div",{className:"absolute hidden left-full ml-2 items-center group-hover:flex tooltip-wrap",children:[(0,a.jsx)("div",{className:"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px"}),(0,a.jsx)("span",{className:"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md",children:"Send by email"})]})]})]})})}),this.props.cloudSharingEnabled&&(0,a.jsx)("li",{className:"hover:text-seqorange hover:bg-gray-200",children:(0,a.jsx)("button",{className:"flex text-sm text-seqblue hover:text-seqorange cloud-Post cursor-pointer py-0.5 px-0.5 w-full",onClick:this.shareCloudInit,children:(0,a.jsxs)("div",{className:"relative flex gap-2 items-center group w-full",children:[(0,a.jsx)("i",{className:"fa fa-cloud"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"w-full",children:"Share to cloud"}),(0,a.jsxs)("div",{className:"absolute hidden left-full ml-2 items-center group-hover:flex tooltip-wrap",children:[(0,a.jsx)("div",{className:"w-0 h-0 border-y-8 border-r-8 border-t-transparent border-b-transparent border-r-black -mr-px"}),(0,a.jsx)("span",{className:"relative z-10 p-2 side-tooltip-text leading-4 text-center text-white whitespace-no-wrap bg-black shadow-lg rounded-md",children:"Results in pairwise format Upload results to SequenceServer Cloud where it will become accessable to everyone who has a link."})]})]})]})})})]}),(0,a.jsx)(Qe,{ref:this.cloudShareModal,querydb:this.props.data.querydb,program:this.props.data.program,queryLength:this.props.data.queries.length})]})}},{key:"render",value:function(){return(0,a.jsxs)("div",{className:"sidebar sticky top-0 print:hidden",children:[this.topPanelJSX(),this.downloadsPanelJSX(),this.sharingPanelJSX(),(0,a.jsx)("div",{className:"referral-panel",children:(0,a.jsxs)("div",{className:"pl-px table mb-0 w-full text-sm",children:[(0,a.jsx)("h4",{className:"font-bold mb-0 mt-2.5",children:"Recommend SequenceServer"}),(0,a.jsx)("p",{children:(0,a.jsx)("a",{href:"https://sequenceserver.com/referral-program",target:"_blank",className:"text-seqblue hover:text-seqorange",children:"Earn up to $400 per signup"})})]})})]})}}],n&&Ke(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(n.Component),ar=r(4692),or=function(t,e){return t.hsps.map((function(r){return Object.assign(r,{hit_id:t.id,query_id:e})}))},sr=function(t){console.log("prepareAlignmentOfAllHits",t);var e=0,r=[];if(t.length){t.forEach((function(t){return t.hits.forEach((function(n){e++,r=r.concat(or(n,t.id))}))}));var n=new Mt,i="alignment-".concat(e,"_hits.txt"),a=n.prepare_alignments_for_export(r,i);return ar(".download-alignment-of-all").attr("href",a).attr("download",i),!1}};function lr(t){return lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lr(t)}function cr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ur(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?cr(Object(r),!0).forEach((function(e){hr(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function hr(t,e,r){return(e=pr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pr(n.key),n)}}function pr(t){var e=function(t){if("object"!=lr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=lr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==lr(e)?e:e+""}function fr(t,e,r){return e=yr(e),function(t,e){if(e&&("object"==lr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,mr()?Reflect.construct(e,r||[],yr(t).constructor):e.apply(t,r))}function mr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(mr=function(){return!!t})()}function yr(t){return yr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yr(t)}function br(t,e){return br=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},br(t,e)}var vr={user_warning:null,eownload_links:[],search_id:"",seqserv_version:"",program:"",program_version:"",submitted_at:"",results:[],queries:[],querydb:[],params:[],stats:[],alignment_blob_url:"",allQueriesLoaded:!1,cloud_sharing_enabled:!1};const gr=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=fr(this,e,[t])).state=vr,r.setStateFromJSON=r.setStateFromJSON.bind(r),r.plugins=new L(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&br(t,e)}(e,t),r=e,(n=[{key:"componentDidMount",value:function(){l(this.setStateFromJSON,this.props.showErrorModal),ar("body").on("mousedown",".hit > .section-header > h4",(function(t){var e=ar(this);e.on("mouseup mousemove",(function t(r){if("mouseup"===r.type){var n=e.parents(".hit").attr("id");ar("div[data-parent-hit=".concat(n,"]")).toggle(),e.find("i").toggleClass("fa-square-minus fa-square-plus"),ar(e.data("parent-id")).toggleClass("print:hidden")}else e.attr("data-toggle","");e.off("mouseup mousemove",t)}))}))}},{key:"componentFinishedUpdating",value:function(){this.state.allQueriesLoaded||(this.shouldShowIndex()&&this.setupScrollSpy(),this.setState({allQueriesLoaded:!0}))}},{key:"shouldShowIndex",value:function(){var t=this.state.queries.length;return t>=2&&t<=12}},{key:"atLeastOneHit",value:function(){return this.state.queries.some((function(t){return t.hits.length>0}))}},{key:"setStateFromJSON",value:function(t){var e=this;this.lastTimeStamp=Date.now(),"LARGE_RESULT"==t.user_warning?this.setState({user_warning:t.user_warning,download_links:t.download_links}):(console.log("prepareAlignmentOfAllHits",sr),this.setState(t,(function(){return sr(e.state.queries)})))}},{key:"render",value:function(){var t=this;return this.state.user_warning?(0,a.jsx)(s,{downloadLinks:this.state.download_links}):this.state.queries.length>=1?(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 print:grid-cols-1",id:"results",children:[(0,a.jsx)("div",{className:"hidden md:col-span-1 md:block print:hidden",children:(0,a.jsx)(ir,{data:this.state,atLeastOneHit:this.atLeastOneHit(),shouldShowIndex:this.shouldShowIndex(),allQueriesLoaded:this.state.allQueriesLoaded,cloudSharingEnabled:this.state.cloud_sharing_enabled})}),(0,a.jsxs)("div",{className:"col-span-1 md:col-span-3 print:col-span-1",children:[(0,a.jsx)(J,{seqserv_version:this.state.seqserv_version,program_version:this.state.program_version,submitted_at:this.state.submitted_at,querydb:this.state.querydb,stats:this.state.stats,params:this.state.params}),(0,a.jsx)(ot,{queries:this.state.queries,prorgam:this.state.program,plugins:this.plugins}),(0,a.jsx)(ge,ur({state:this.state,populate_hsp_array:or,componentFinishedUpdating:function(e){return t.componentFinishedUpdating(e)},plugins:this.plugins},this.props))]})]}):(0,a.jsx)(o,{})}}])&&dr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(n.Component)},7917:(t,e,r)=>{"use strict";r.r(e);var n,i=r(4692),a=r.n(i),o=(r(9660),r(4692));r.g.$=a(),(n=o).fn.disable=function(){return this.prop("disabled",!0).addClass("disabled")},n.fn.enable=function(){return this.prop("disabled",!1).removeClass("disabled")},n.fn.check=function(){return this.prop("checked",!0)},n.fn.uncheck=function(){return this.prop("checked",!1)},n(document).tooltip({position:{my:"center bottom-20",at:"center top",using:function(t,e){n(this).css(t),n("<div>").addClass("arrow").addClass(e.vertical).addClass(e.horizontal).appendTo(this)}},items:"rect, .tooltip-item",show:!1,hide:!1,content:function(){var t=n(this).attr("title");return!!t&&n.parseHTML(t)}}),n.modalActive=function(){var t=!1;return n(".modal").each((function(){var e=n(this).data("bs.modal");if(e)return!(t=e.isShown)})),t},n.fn.wiggle=function(){this.finish().effect("bounce",{direction:"left",distance:24,times:4},250)}}}]);
//# sourceMappingURL=report_page.js.map